<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 13.1.0"/>
    <title>stanify.builders.vensim_ast_walker API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent }nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .pdoc-alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:1rem center;margin-bottom:1rem;}.pdoc .pdoc-alert > *:last-child{margin-bottom:0;}.pdoc .pdoc-alert-note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .pdoc-alert-danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--code);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style><script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script>
    /* Re-invoke MathJax when DOM content changes, for example during search. */
    document.addEventListener("DOMContentLoaded", () => {
        new MutationObserver(() => MathJax.typeset()).observe(
            document.querySelector("main.pdoc").parentNode,
            {childList: true}
        );
    })
</script>
<style>
    mjx-container {
        overflow-x: auto;
    }
</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../builders.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;stanify.builders</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#get_subscripts_ReferenceStructure">get_subscripts_ReferenceStructure</a>
            </li>
            <li>
                    <a class="class" href="#BaseVensimWalker">BaseVensimWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#BaseVensimWalker.walk">walk</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FindStaticDataVariablesWalker">FindStaticDataVariablesWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FindStaticDataVariablesWalker.walk">walk</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FindODERHSVariablesVensimWalker">FindODERHSVariablesVensimWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FindODERHSVariablesVensimWalker.walk">walk</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#FindODEInitialRHSVariablesVensimWalker">FindODEInitialRHSVariablesVensimWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#FindODEInitialRHSVariablesVensimWalker.walk">walk</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#GenericVensimStructureCallbackWalker">GenericVensimStructureCallbackWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#GenericVensimStructureCallbackWalker.__init__">GenericVensimStructureCallbackWalker</a>
                        </li>
                        <li>
                                <a class="function" href="#GenericVensimStructureCallbackWalker.walk">walk</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VensimArithmeticStructureCallbackWalker">VensimArithmeticStructureCallbackWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure">walk_ArithmeticStructure</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VensimReferenceStructureCallbackWalker">VensimReferenceStructureCallbackWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure">walk_ReferenceStructure</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VensimCallStructureCallbackWalker">VensimCallStructureCallbackWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VensimCallStructureCallbackWalker.walk_CallStructure">walk_CallStructure</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#VensimNumericLiteralCallbackWalker">VensimNumericLiteralCallbackWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral">walk_NumericLiteral</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#InitialValueCodegenVensimWalker">InitialValueCodegenVensimWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#InitialValueCodegenVensimWalker.__init__">InitialValueCodegenVensimWalker</a>
                        </li>
                        <li>
                                <a class="function" href="#InitialValueCodegenVensimWalker.walk">walk</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#ODEFunctionStatementCodegenVensimWalker">ODEFunctionStatementCodegenVensimWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#ODEFunctionStatementCodegenVensimWalker.__init__">ODEFunctionStatementCodegenVensimWalker</a>
                        </li>
                        <li>
                                <a class="function" href="#ODEFunctionStatementCodegenVensimWalker.walk">walk</a>
                        </li>
                </ul>

            </li>
            <li>
                    <a class="class" href="#LookupFunctionCodegenVensimWalker">LookupFunctionCodegenVensimWalker</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#LookupFunctionCodegenVensimWalker.__init__">LookupFunctionCodegenVensimWalker</a>
                        </li>
                        <li>
                                <a class="function" href="#LookupFunctionCodegenVensimWalker.walk">walk</a>
                        </li>
                        <li>
                                <a class="function" href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody">codgen_comparison_functionbody</a>
                        </li>
                        <li>
                                <a class="function" href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody">codegen_binarysearch_functionbody</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../../stanify.html">stanify</a><wbr>.<a href="./../builders.html">builders</a><wbr>.vensim_ast_walker    </h1>

                
                        <input id="mod-vensim_ast_walker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-vensim_ast_walker-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">annotations</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">from</span> <span class="nn">dataclasses</span> <span class="kn">import</span> <span class="n">dataclass</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span> <span class="nn">pysd.translators.structures.abstract_expressions</span> <span class="k">as</span> <span class="nn">pysd_ast</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">TYPE_CHECKING</span><span class="p">,</span> <span class="n">Callable</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a>    <span class="kn">from</span> <span class="nn">.v2s_model</span> <span class="kn">import</span> <span class="n">Vensim2StanCodeHandler</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a>    <span class="kn">from</span> <span class="nn">.vensim_model</span> <span class="kn">import</span> <span class="n">VensimModelContext</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>    <span class="kn">from</span> <span class="nn">.stan_model_context</span> <span class="kn">import</span> <span class="n">StanModelContext</span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="kn">from</span> <span class="nn">.utilities</span> <span class="kn">import</span> <span class="n">IndentedString</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">chain</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="kn">from</span> <span class="nn">numbers</span> <span class="kn">import</span> <span class="n">Number</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a><span class="kn">from</span> <span class="nn">abc</span> <span class="kn">import</span> <span class="n">ABC</span><span class="p">,</span> <span class="n">abstractmethod</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="kn">import</span> <span class="nn">xarray</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="k">def</span> <span class="nf">get_subscripts_ReferenceStructure</span><span class="p">(</span><span class="n">reference_structure</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">    This function gets the subscript tuple from a `ReferenceStructure`. `ReferenceStructure` means it&#39;s referencing a</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">    value of a variable, and its subscript attribute is a `SubscriptReferenceStructure` object. This function picks</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">    out the tuple values from the `SubscriptReferenceStructure`.</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="sd">    Parameters</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="sd">    ----------</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a><span class="sd">    reference_structure : pysd_ast.ReferenceStructure</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="sd">        The `ReferenceStructure` AST object</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="sd">    Returns</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a><span class="sd">    -------</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="sd">    A tuple of strings indicating the subscripts</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>    <span class="k">if</span> <span class="n">reference_structure</span><span class="o">.</span><span class="n">subscripts</span><span class="p">:</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="k">return</span> <span class="n">reference_structure</span><span class="o">.</span><span class="n">subscripts</span><span class="o">.</span><span class="n">subscripts</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>    <span class="k">return</span> <span class="p">()</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="nd">@dataclass</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="k">class</span> <span class="nc">BaseVensimWalker</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    Base abstract class for Vensim AST walker classes.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">    Attributes</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">    ----------</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    v2s_code_handler : Vensim2StanCodeHandler</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">        `Vensim2StanCodeHandler`</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    vensim_model_context : VensimModelContext</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">        `VensimModelContext`</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>    <span class="n">v2s_code_handler</span><span class="p">:</span> <span class="n">Vensim2StanCodeHandler</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>    <span class="n">vensim_model_context</span><span class="p">:</span> <span class="n">VensimModelContext</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>    <span class="n">stan_model_context</span><span class="p">:</span> <span class="n">StanModelContext</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="sd">        This is the base format of the Vensim AST walkers. Although they&#39;re normally recursively called,</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        values shouldn&#39;t be returned directly, but instead use a class attribute to pass back values.</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a><span class="sd">        - pysd_element</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">            - name : str. This should be passed into `node_name`</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">            - components : list</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">                - component : AbstractComponent</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">                    - ast : Structure, AST Node. This should be passed into `ast_component`</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">                    - subscripts : tuple(list[Any], list[Any]). The **first element of the tuple** should be passed into `subscripts`</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        Parameters</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        ----------</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        component_ast : AbstractSyntax</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a><span class="sd">            The AST Node of the current AST. Its exact type should be</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a><span class="sd">            `pysd.translators.structures.abstract_expressions.AbstractSyntax` and any of its children. By the above</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a><span class="sd">            element hierarchy, should be `component.ast`.</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a><span class="sd">        node_name : str</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a><span class="sd">            String indicating the AST Node name. By the above element hierarchy, should be `element.name`</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a><span class="sd">            Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a><span class="sd">            `component.subscripts`.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a><span class="sd">            However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a><span class="sd">            in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a><span class="sd">        current_precedence : int</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="sd">            Integer indicating the current operator precedence level. Only relevant when parsing `ArithmeticStructure`.</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        Returns</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        -------</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        If using any of the `walk_X` methods, must return a string of the generated code.</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="k">class</span> <span class="nc">FindStaticDataVariablesWalker</span><span class="p">(</span><span class="n">BaseVensimWalker</span><span class="p">):</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">    This walker finds any static data variables defined within the Vensim program. It&#39;s intended to be used to fill</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">    `stanify.builders.stan_model_context.StanModelContext` during preliminary passes.</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">()</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">():</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>                <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="o">.</span><span class="n">declared_variables</span><span class="p">:</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">transformed_data_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>                <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a>                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Values for variable </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2"> exists in the Vensim model, but other values already exist. Ignoring values defines within the Vensim model...&quot;</span><span class="p">)</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>                    <span class="c1"># Variables with subscripts needs to be transformed into a xarray.DataArray with subscript info.</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="n">subscript</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">get_subscript_values</span><span class="p">(</span><span class="n">subscript</span><span class="p">))</span> <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">subscripts</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>                    <span class="k">if</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>                        <span class="c1"># If there are subscripts, it needs to be expanded into a xarray</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>                        <span class="c1"># tile the scalar value into an array</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>                        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">get_variable_shape</span><span class="p">(</span><span class="n">node_name</span><span class="p">))</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>                        <span class="c1"># Create the dataarray with the subscript information</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="n">subscript</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">get_subscript_values</span><span class="p">(</span><span class="n">subscript</span><span class="p">))</span> <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">subscripts</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>                        <span class="c1"># just a scalar :)</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component_ast</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">DataStructure</span><span class="p">():</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>                <span class="c1"># DataStructures are time-variant variables</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">timestep_variant_datafunc_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">LookupsStructure</span><span class="p">():</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">lookupfunc_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="k">class</span> <span class="nc">FindODERHSVariablesVensimWalker</span><span class="p">:</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a><span class="sd">    Finds all the variables that are present on the RHS of a statement. This is useful for creating a dependency graph,</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a><span class="sd">    since you know the LHS variable name through `element.name`, and this walker provides a list of the dependant</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a><span class="sd">    variables.</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a><span class="sd">        Find and return the RHS variable names of a given statement AST.</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a><span class="sd">        Parameters</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a><span class="sd">        ----------</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a><span class="sd">        component_ast : AbstractSyntax</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a><span class="sd">            AST entry point node</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a><span class="sd">        Returns</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a><span class="sd">        -------</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a><span class="sd">        a list of strings of the variables</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>                <span class="k">return</span> <span class="p">[]</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>                <span class="k">return</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span><span class="p">]</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">flow</span><span class="p">)</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">InlineLookupsStructure</span><span class="p">():</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">lookups</span><span class="p">)</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="k">class</span> <span class="nc">FindODEInitialRHSVariablesVensimWalker</span><span class="p">:</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">    Finds all the variables that are present on the RHS of a statement. This is useful for creating a dependency graph,</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">    since you know the LHS variable name through `element.name`, and this walker provides a list of the dependant</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">    variables. This looks through the initial values instead of the actual ODE equations.</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">        Find and return the RHS variable names of a given statement AST.</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">        Parameters</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a><span class="sd">        ----------</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">        component_ast : AbstractSyntax</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">            AST entry point node</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a><span class="sd">        Returns</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">        -------</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">        a list of strings of the variables</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                <span class="k">return</span> <span class="p">[]</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>                <span class="k">return</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span><span class="p">]</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">initial</span><span class="p">)</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">InlineLookupsStructure</span><span class="p">():</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">lookups</span><span class="p">)</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a><span class="nd">@dataclass</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a><span class="k">class</span> <span class="nc">GenericVensimStructureCallbackWalker</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a><span class="sd">    This Vensim walker is a bit different from `BaseVensimWalker`. This family of callable classes implement the</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a><span class="sd">    base behavior for walking and generating code for various components. Each subclass implements a single walk</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a><span class="sd">    method for a single type of Vensim AST node. Instead of writing all the logic for handling different types of AST</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a><span class="sd">    nodes in a single function/class which would then pose problems when you subclass walkers, you can you these</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a><span class="sd">    modularized classes to reduce duplicate code.</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a><span class="sd">    If the walker runs into one of the different AST node types, it will insteall call the `walk_callback` callable,</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a><span class="sd">    which can implement or call another walker that can process it.</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>    <span class="n">v2s_code_handler</span><span class="p">:</span> <span class="n">Vensim2StanCodeHandler</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>    <span class="n">vensim_model_context</span><span class="p">:</span> <span class="n">VensimModelContext</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>    <span class="n">stan_model_context</span><span class="p">:</span> <span class="n">StanModelContext</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">        The family of `walk_X` functions, where `X` is a Vensim AST class, is intended to be used in Vensim AST walkers. Instead of</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        writing all the logic for handling different types of AST nodes in a single function which would then pose</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a><span class="sd">        problems when you subclass walkers, you can you these functions to reduce duplicate code.</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a><span class="sd">        Parameters</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a><span class="sd">        ----------</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a><span class="sd">            resume running its own code.</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a><span class="sd">        component_ast : ArithmeticStructure</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a><span class="sd">            An `ArithmeticStructure` object. The arguments are exactly the same as `BaseVensimWalker.walk()`</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a><span class="sd">        node_name : str</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        current_precedence : int</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        Returns</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a><span class="sd">        -------</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a><span class="sd">        A string of the generated code</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a><span class="k">class</span> <span class="nc">VensimArithmeticStructureCallbackWalker</span><span class="p">(</span><span class="n">GenericVensimStructureCallbackWalker</span><span class="p">):</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>    <span class="k">def</span> <span class="nf">walk_ArithmeticStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">,</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>                                 <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a><span class="sd">        The family of `walk_X` functions, where `X` is a Vensim AST class, is intended to be used in Vensim AST walkers. Instead of</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a><span class="sd">        writing all the logic for handling different types of AST nodes in a single function which would then pose</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a><span class="sd">        problems when you subclass walkers, you can you these functions to reduce duplicate code.</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a><span class="sd">        Parameters</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a><span class="sd">        ----------</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a><span class="sd">            resume running its own code.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a><span class="sd">        component_ast : ArithmeticStructure</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a><span class="sd">            An `ArithmeticStructure` object. The arguments are exactly the same as `BaseVensimWalker.walk()`</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a><span class="sd">        node_name : str</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="sd">        current_precedence : int</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a><span class="sd">        Returns</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a><span class="sd">        -------</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a><span class="sd">        A string of the generated code</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>        <span class="n">operator_precedence</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># lower comes first</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>            <span class="s2">&quot;+&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>            <span class="s2">&quot;-&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>            <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>            <span class="s2">&quot;/&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>            <span class="s2">&quot;^&quot;</span><span class="p">:</span> <span class="mi">1</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>        <span class="p">}</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>        <span class="c1"># ArithmeticStructure consists of chained arithmetic expressions.</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>        <span class="c1"># We parse them one by one into a single expression</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>        <span class="c1"># Assume ArithmeticStructure.operators are in order of precedence(lower comes first)</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">        Suppose we have:</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        A = 1 + 1; B = A * 2</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">        Naively substituting in A will result in:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a><span class="sd">        1 + 1 * 2</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a><span class="sd">        which is not correct, and instead should be:</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a><span class="sd">        (1 + 1) * 2</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a><span class="sd">        Assume we have the following AST:</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a><span class="sd">              *  # precedence level 2</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a><span class="sd">              /\</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="sd">             /  2</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">            +  # precedence level 3</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a><span class="sd">            /\</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">           1  1</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">        We check if the operators of the subtrees of &#39;*&#39; have a precedence level higher than its parent, and</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        enclose them in parentheses if so.</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a><span class="sd">               *  # precedence level 2</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">              /\</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">             /  2</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="sd">            +  # precedence level 3</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="sd">            /\</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">           1  b (b is treated as reference structure)</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">    </span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>        <span class="n">last_argument_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>        <span class="c1"># Find the maximum precedence value of the operators</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="n">max_precedence</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">operator_precedence</span><span class="p">[</span><span class="n">op</span><span class="p">]</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">])</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>        <span class="k">if</span> <span class="n">max_precedence</span> <span class="o">&gt;=</span> <span class="n">current_precedence</span><span class="p">:</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot;(&quot;</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">argument</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">):</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>            <span class="c1"># Find the operators which set the precedence level of its children</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>                <span class="n">operators_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="n">last_argument_index</span><span class="p">:</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>                <span class="n">operators_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>                <span class="n">operators_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>            <span class="c1"># Pass the minimum precedence level</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">):</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscripts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>                    <span class="n">arg_subscripts</span> <span class="o">=</span> <span class="n">get_subscripts_ReferenceStructure</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>                    <span class="n">subscripts</span> <span class="o">=</span> <span class="p">{</span><span class="n">subscript</span><span class="p">:</span> <span class="n">subscripts</span><span class="p">[</span><span class="n">subscript</span><span class="p">]</span> <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">arg_subscripts</span><span class="p">}</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>                    <span class="n">subscripts</span> <span class="o">=</span> <span class="n">get_subscripts_ReferenceStructure</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>            <span class="n">operand_text</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="nb">min</span><span class="p">([</span><span class="n">operator_precedence</span><span class="p">[</span><span class="n">op</span><span class="p">]</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">operators_to_check</span><span class="p">]))</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>            <span class="c1"># If one of the operators is division, and the operand is an integer, convert the integer to a float string representation</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>            <span class="k">if</span> <span class="n">operand_text</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">operators_to_check</span><span class="p">:</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                    <span class="n">operand_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">operand_text</span><span class="p">))</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="n">operand_text</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">last_argument_index</span><span class="p">:</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>                <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>                <span class="n">output_string</span> <span class="o">+=</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>                <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>        <span class="k">if</span> <span class="n">max_precedence</span> <span class="o">&gt;=</span> <span class="n">current_precedence</span><span class="p">:</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>        <span class="k">return</span> <span class="n">output_string</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a><span class="k">class</span> <span class="nc">VensimReferenceStructureCallbackWalker</span><span class="p">(</span><span class="n">GenericVensimStructureCallbackWalker</span><span class="p">):</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>    <span class="k">def</span> <span class="nf">walk_ReferenceStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">,</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>                                <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>                                <span class="n">time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">initial</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a><span class="sd">        Parameters</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a><span class="sd">        ----------</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a><span class="sd">            resume running its own code.</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a><span class="sd">        component_ast : ReferenceStructure</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a><span class="sd">            A `ReferenceStructure` object. The arguments for this function onwards are exactly the same as</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a><span class="sd">            `BaseVensimWalker.walk()`</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a><span class="sd">        node_name : str</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a><span class="sd">        current_precedence : int</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a><span class="sd">        time : str</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a><span class="sd">            String to use for the `time` argument for data functions. should be left to default when within the ODE,</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="sd">            else set to `initial_time` for anytime else.</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="sd">        initial : bool</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="sd">            Boolean on whether the code generation is generating initial values. If true, suffixes all stock variable</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a><span class="sd">            usage with &quot;_initial&quot;</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a><span class="sd">        Returns</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a><span class="sd">        -------</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a><span class="sd">        A string of the generated code</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscripts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>            <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>            <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>        <span class="n">variable_name</span> <span class="o">=</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="c1"># Sometimes PySD passes function names into ReferenceStructure.</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>        <span class="k">if</span> <span class="n">variable_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>            <span class="k">return</span> <span class="n">variable_name</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">variable_name</span><span class="p">]</span><span class="o">.</span><span class="n">is_vensim_datastructure</span><span class="p">:</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>            <span class="c1"># datastructure are a function</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>            <span class="k">if</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">subscript_args</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="k">if</span> <span class="n">initial</span> <span class="ow">and</span> <span class="n">variable_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">integ_outcome_variables</span><span class="p">:</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>            <span class="n">variable_name</span> <span class="o">=</span> <span class="n">variable_name</span> <span class="o">+</span> <span class="s2">&quot;_initial&quot;</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="k">return</span> <span class="n">variable_name</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">subscript_args</span><span class="si">}</span><span class="s2">]&quot;</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a><span class="k">class</span> <span class="nc">VensimCallStructureCallbackWalker</span><span class="p">(</span><span class="n">GenericVensimStructureCallbackWalker</span><span class="p">):</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>    <span class="k">def</span> <span class="nf">walk_CallStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>                           <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a><span class="sd">        Parameters</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a><span class="sd">        ----------</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a><span class="sd">            resume running its own code.</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        component_ast : CallStructure</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">            A `CallStructure` object. The arguments for this function onwards are exactly the same as</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">            `BaseVensimWalker.walk()`</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">        node_name : str</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        current_precedence : int</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        Returns</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a><span class="sd">        -------</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a><span class="sd">        A string of the generated code</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>        <span class="n">function_name</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>        <span class="c1"># Some special vensim functions correspond to special stan functions or syntax.</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        <span class="k">if</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="s2">&quot;fmin&quot;</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="s2">&quot;fmax&quot;</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;xidz&quot;</span><span class="p">:</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;number of arguments for xidz must be 3&quot;</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>            <span class="n">arg1</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>            <span class="n">arg2</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>            <span class="n">arg3</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (abs(</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">) &lt;= 1e-6) ? </span><span class="si">{</span><span class="n">arg3</span><span class="si">}</span><span class="s2"> : (</span><span class="si">{</span><span class="n">arg1</span><span class="si">}</span><span class="s2">) / (</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>            <span class="k">return</span> <span class="n">output_string</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;zidz&quot;</span><span class="p">:</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;number of arguments for zidz must be 2&quot;</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>            <span class="n">arg1</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>            <span class="n">arg2</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (abs(</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">) &lt;= 1e-6) ? 0 : (</span><span class="si">{</span><span class="n">arg1</span><span class="si">}</span><span class="s2">) / (</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>            <span class="k">return</span> <span class="n">output_string</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;ln&quot;</span><span class="p">:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>            <span class="c1"># natural log in stan is just log</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="s2">&quot;log&quot;</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>        <span class="n">output_string</span> <span class="o">+=</span> <span class="n">function_name</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>        <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">walk_callback</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>        <span class="k">return</span> <span class="n">output_string</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="k">class</span> <span class="nc">VensimNumericLiteralCallbackWalker</span><span class="p">(</span><span class="n">GenericVensimStructureCallbackWalker</span><span class="p">):</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>    <span class="k">def</span> <span class="nf">walk_NumericLiteral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">Number</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>                            <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a><span class="sd">        Base handler for numeric constants.</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a><span class="sd">        Parameters</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a><span class="sd">        ----------</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a><span class="sd">            resume running its own code.</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a><span class="sd">        component_ast : Number</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a><span class="sd">            A Python number. The arguments for this function onwards are exactly the same as</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a><span class="sd">            `BaseVensimWalker.walk()`</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a><span class="sd">        node_name : str</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a><span class="sd">        current_precedence : int</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a><span class="sd">        Returns</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a><span class="sd">        -------</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a><span class="sd">        A string of the generated code</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>        <span class="n">code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">component_ast</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>        <span class="k">if</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscripts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>                <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>                <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rep_array(</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">subscript_args</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>        <span class="k">return</span> <span class="n">code</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="nd">@dataclass</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="k">class</span> <span class="nc">InitialValueCodegenVensimWalker</span><span class="p">(</span><span class="n">BaseVensimWalker</span><span class="p">):</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">    Generates code for initial state variables. The resulting code goes into the &quot;transformed parameters&quot; block.</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">initial</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">SmoothStructure</span><span class="p">():</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">initial</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimReferenceStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>                                                                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ReferenceStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>                                                      <span class="n">time</span><span class="o">=</span><span class="s2">&quot;initial_time&quot;</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimArithmeticStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ArithmeticStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimCallStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>                                                           <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_CallStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimNumericLiteralCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>                                                            <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_NumericLiteral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>                <span class="k">return</span> <span class="n">component_ast</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;InitialValueCodegenWalker - got unknown node type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">component_ast</span><span class="p">)</span><span class="si">}</span><span class="s2"> for node </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="nd">@dataclass</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a><span class="k">class</span> <span class="nc">ODEFunctionStatementCodegenVensimWalker</span><span class="p">(</span><span class="n">BaseVensimWalker</span><span class="p">):</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a><span class="sd">    Generates code for **assignment** statements which belong to the ODE stan function.</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimReferenceStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>                                                                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ReferenceStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimArithmeticStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ArithmeticStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">flow</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimCallStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>                                                           <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_CallStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimNumericLiteralCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_NumericLiteral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">component_ast</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ODEFunctionStatementCodegenWalker - got unknown node type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">component_ast</span><span class="p">)</span><span class="si">}</span><span class="s2"> for node </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a><span class="nd">@dataclass</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a><span class="k">class</span> <span class="nc">LookupFunctionCodegenVensimWalker</span><span class="p">(</span><span class="n">BaseVensimWalker</span><span class="p">):</span>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a><span class="sd">    Walks the Vensim AST for lookup structures, and generates a stan function for them.</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>
</span><span id="L-625"><a href="#L-625"><span class="linenos">625</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos">626</span></a>             <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos">627</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos">628</span></a><span class="sd">        Given a PySD Vensim component ast, generate and return code that corresponds to a single lookup variable.</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos">629</span></a><span class="sd">        The code returned is a full stan function declaration.</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos">630</span></a>
</span><span id="L-631"><a href="#L-631"><span class="linenos">631</span></a><span class="sd">        Parameters</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos">632</span></a><span class="sd">        ----------</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos">633</span></a><span class="sd">        component_ast : LookupsStructure</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos">634</span></a><span class="sd">            A `LookupsStructure` object. The arguments are exactly the same as `BaseVensimWalker.walk()`</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos">635</span></a><span class="sd">        node_name : str</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos">636</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos">637</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos">638</span></a><span class="sd">            Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos">639</span></a><span class="sd">            be `component.subscripts`.</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos">640</span></a><span class="sd">            However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos">641</span></a><span class="sd">            in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos">642</span></a><span class="sd">        current_precedence : int</span>
</span><span id="L-643"><a href="#L-643"><span class="linenos">643</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure, and hence not used within</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos">644</span></a><span class="sd">            this walker.</span>
</span><span id="L-645"><a href="#L-645"><span class="linenos">645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos">646</span></a><span class="sd">        Returns</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos">647</span></a><span class="sd">        -------</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos">648</span></a>
</span><span id="L-649"><a href="#L-649"><span class="linenos">649</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos">650</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">LookupsStructure</span><span class="p">):</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos">651</span></a>            <span class="c1"># Two strategies for implementing the lookup efficiently: If there are 4 or less x values, then we</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos">652</span></a>            <span class="c1"># just write 4(or less) comparison statements to calculate the correct slope and intercept.</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos">653</span></a>            <span class="c1"># But if there are more than 4 values, we use a binary search.</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos">654</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="n">node_name</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos">655</span></a>            <span class="n">n_domains</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="L-656"><a href="#L-656"><span class="linenos">656</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">IndentedString</span><span class="p">()</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos">657</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;real </span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s2">(real x)</span><span class="se">{{\n</span><span class="s2">&quot;</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos">658</span></a>
</span><span id="L-659"><a href="#L-659"><span class="linenos">659</span></a>            <span class="c1"># Enter function body</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos">660</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos">661</span></a>            <span class="k">if</span> <span class="n">n_domains</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos">662</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">codgen_comparison_functionbody</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos">663</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos">664</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">codegen_binarysearch_functionbody</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos">665</span></a>
</span><span id="L-666"><a href="#L-666"><span class="linenos">666</span></a>            <span class="c1"># exit function body</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos">667</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos">668</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos">669</span></a>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos">670</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos">671</span></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="L-672"><a href="#L-672"><span class="linenos">672</span></a>
</span><span id="L-673"><a href="#L-673"><span class="linenos">673</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos">674</span></a>    <span class="k">def</span> <span class="nf">codgen_comparison_functionbody</span><span class="p">(</span><span class="n">x_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">y_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos">675</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos">676</span></a><span class="sd">        Generate function body for a lookup stepwise linear function with chained if statements.</span>
</span><span id="L-677"><a href="#L-677"><span class="linenos">677</span></a>
</span><span id="L-678"><a href="#L-678"><span class="linenos">678</span></a><span class="sd">        Parameters</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos">679</span></a><span class="sd">        ----------</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos">680</span></a><span class="sd">        x_values : tuple[float]</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos">681</span></a><span class="sd">            Values of the steps for the domain of the function.</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos">682</span></a><span class="sd">        y_values : tuple[float]</span>
</span><span id="L-683"><a href="#L-683"><span class="linenos">683</span></a><span class="sd">            Values of the steps for the range of the function</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos">684</span></a>
</span><span id="L-685"><a href="#L-685"><span class="linenos">685</span></a><span class="sd">        Returns</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos">686</span></a><span class="sd">        -------</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos">687</span></a><span class="sd">        String of the generated code</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos">688</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos">689</span></a>        <span class="n">code</span> <span class="o">=</span> <span class="n">IndentedString</span><span class="p">()</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos">690</span></a>        <span class="n">n_domains</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos">691</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real slope;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos">692</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real intercept;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos">693</span></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_domains</span><span class="p">):</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos">694</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos">695</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;if(x &lt;= </span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}</span><span class="s2">) </span><span class="se">{{\n</span><span class="s2">&quot;</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos">696</span></a>                <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-697"><a href="#L-697"><span class="linenos">697</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;return </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos">698</span></a>                <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos">699</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos">700</span></a>                <span class="k">continue</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos">701</span></a>
</span><span id="L-702"><a href="#L-702"><span class="linenos">702</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;else if(x &lt;= </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">) </span><span class="se">{{\n</span><span class="s2">&quot;</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos">703</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos">704</span></a>            <span class="c1"># enter conditional body</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos">705</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;intercept = </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos">706</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;slope = (</span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)/(</span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-707"><a href="#L-707"><span class="linenos">707</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;return intercept + slope * (x - </span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos">708</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos">709</span></a>            <span class="c1"># exit conditional body</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos">710</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos">711</span></a>
</span><span id="L-712"><a href="#L-712"><span class="linenos">712</span></a>        <span class="c1"># Handle out-of-bounds input</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos">713</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;return </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos">714</span></a>
</span><span id="L-715"><a href="#L-715"><span class="linenos">715</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos">716</span></a>
</span><span id="L-717"><a href="#L-717"><span class="linenos">717</span></a>    <span class="nd">@staticmethod</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos">718</span></a>    <span class="k">def</span> <span class="nf">codegen_binarysearch_functionbody</span><span class="p">(</span><span class="n">x_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">y_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos">719</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos">720</span></a><span class="sd">        Generate function body for a lookup stepwise linear function employing a binary search.</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos">721</span></a>
</span><span id="L-722"><a href="#L-722"><span class="linenos">722</span></a><span class="sd">        Parameters</span>
</span><span id="L-723"><a href="#L-723"><span class="linenos">723</span></a><span class="sd">        ----------</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos">724</span></a><span class="sd">        x_values : tuple[float]</span>
</span><span id="L-725"><a href="#L-725"><span class="linenos">725</span></a><span class="sd">            Values of the steps for the domain of the function.</span>
</span><span id="L-726"><a href="#L-726"><span class="linenos">726</span></a><span class="sd">        y_values : tuple[float]</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos">727</span></a><span class="sd">            Values of the steps for the range of the function</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos">728</span></a>
</span><span id="L-729"><a href="#L-729"><span class="linenos">729</span></a><span class="sd">        Returns</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos">730</span></a><span class="sd">        -------</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos">731</span></a><span class="sd">        String of the generated code</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos">732</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos">733</span></a>        <span class="n">code</span> <span class="o">=</span> <span class="n">IndentedString</span><span class="p">()</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos">734</span></a>        <span class="n">n_domains</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span>
</span><span id="L-735"><a href="#L-735"><span class="linenos">735</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;array[</span><span class="si">{</span><span class="n">n_domains</span><span class="si">}</span><span class="s2">] real x_values = </span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">x_values</span><span class="p">])</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos">736</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;array[</span><span class="si">{</span><span class="n">n_domains</span><span class="si">}</span><span class="s2">] real y_values = </span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">y_values</span><span class="p">])</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos">737</span></a>
</span><span id="L-738"><a href="#L-738"><span class="linenos">738</span></a>        <span class="c1"># define the search bound values. Stan integer division floors to the integer result</span>
</span><span id="L-739"><a href="#L-739"><span class="linenos">739</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;int lower_index = 1, upper_index = </span><span class="si">{</span><span class="n">n_domains</span><span class="si">}</span><span class="s2">, middle = (lower_index + upper_index) %/% 2;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos">740</span></a>
</span><span id="L-741"><a href="#L-741"><span class="linenos">741</span></a>        <span class="c1"># Check that we&#39;re within bounds first</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos">742</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;if (x &gt;= x_values[upper_index]) { return y_values[upper_index]; }</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos">743</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;if (x &lt;= x_values[lower_index]) { return y_values[lower_index]; }</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos">744</span></a>
</span><span id="L-745"><a href="#L-745"><span class="linenos">745</span></a>        <span class="c1"># create the while loop</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos">746</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;while(upper_index - lower_index &gt; 1){</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos">747</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos">748</span></a>
</span><span id="L-749"><a href="#L-749"><span class="linenos">749</span></a>        <span class="c1"># calculate midpoint (stan integer division floors the result to integer)</span>
</span><span id="L-750"><a href="#L-750"><span class="linenos">750</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;middle = (lower_index + upper_index) %/% 2;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos">751</span></a>
</span><span id="L-752"><a href="#L-752"><span class="linenos">752</span></a>        <span class="c1"># check if upper needs to be lowered</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos">753</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;if (x &lt;= x_values[middle]){</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos">754</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-755"><a href="#L-755"><span class="linenos">755</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;upper_index = middle;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos">756</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos">757</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos">758</span></a>
</span><span id="L-759"><a href="#L-759"><span class="linenos">759</span></a>        <span class="c1"># check if lower needs to be raised</span>
</span><span id="L-760"><a href="#L-760"><span class="linenos">760</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;else if(x &gt; x_values[middle]){</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos">761</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos">762</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;lower_index = middle;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos">763</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos">764</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos">765</span></a>
</span><span id="L-766"><a href="#L-766"><span class="linenos">766</span></a>        <span class="c1"># exit while loop</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos">767</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos">768</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos">769</span></a>
</span><span id="L-770"><a href="#L-770"><span class="linenos">770</span></a>        <span class="c1"># Now, lower is the index of the beginning of the step, and upper is the index of the end of it</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos">771</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real intercept = y_values[lower_index];</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos">772</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real slope = (y_values[upper_index] - y_values[lower_index]) / (x_values[upper_index] - x_values[lower_index]);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos">773</span></a>
</span><span id="L-774"><a href="#L-774"><span class="linenos">774</span></a>        <span class="c1"># calculate the function value</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos">775</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;return intercept + slope * (x - y_values[lower_index]);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos">776</span></a>
</span><span id="L-777"><a href="#L-777"><span class="linenos">777</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="get_subscripts_ReferenceStructure">
                            <input id="get_subscripts_ReferenceStructure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">get_subscripts_ReferenceStructure</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">reference_structure</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">ReferenceStructure</span></span><span class="return-annotation">) -> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="get_subscripts_ReferenceStructure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#get_subscripts_ReferenceStructure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="get_subscripts_ReferenceStructure-20"><a href="#get_subscripts_ReferenceStructure-20"><span class="linenos">20</span></a><span class="k">def</span> <span class="nf">get_subscripts_ReferenceStructure</span><span class="p">(</span><span class="n">reference_structure</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="get_subscripts_ReferenceStructure-21"><a href="#get_subscripts_ReferenceStructure-21"><span class="linenos">21</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="get_subscripts_ReferenceStructure-22"><a href="#get_subscripts_ReferenceStructure-22"><span class="linenos">22</span></a><span class="sd">    This function gets the subscript tuple from a `ReferenceStructure`. `ReferenceStructure` means it&#39;s referencing a</span>
</span><span id="get_subscripts_ReferenceStructure-23"><a href="#get_subscripts_ReferenceStructure-23"><span class="linenos">23</span></a><span class="sd">    value of a variable, and its subscript attribute is a `SubscriptReferenceStructure` object. This function picks</span>
</span><span id="get_subscripts_ReferenceStructure-24"><a href="#get_subscripts_ReferenceStructure-24"><span class="linenos">24</span></a><span class="sd">    out the tuple values from the `SubscriptReferenceStructure`.</span>
</span><span id="get_subscripts_ReferenceStructure-25"><a href="#get_subscripts_ReferenceStructure-25"><span class="linenos">25</span></a>
</span><span id="get_subscripts_ReferenceStructure-26"><a href="#get_subscripts_ReferenceStructure-26"><span class="linenos">26</span></a><span class="sd">    Parameters</span>
</span><span id="get_subscripts_ReferenceStructure-27"><a href="#get_subscripts_ReferenceStructure-27"><span class="linenos">27</span></a><span class="sd">    ----------</span>
</span><span id="get_subscripts_ReferenceStructure-28"><a href="#get_subscripts_ReferenceStructure-28"><span class="linenos">28</span></a><span class="sd">    reference_structure : pysd_ast.ReferenceStructure</span>
</span><span id="get_subscripts_ReferenceStructure-29"><a href="#get_subscripts_ReferenceStructure-29"><span class="linenos">29</span></a><span class="sd">        The `ReferenceStructure` AST object</span>
</span><span id="get_subscripts_ReferenceStructure-30"><a href="#get_subscripts_ReferenceStructure-30"><span class="linenos">30</span></a>
</span><span id="get_subscripts_ReferenceStructure-31"><a href="#get_subscripts_ReferenceStructure-31"><span class="linenos">31</span></a><span class="sd">    Returns</span>
</span><span id="get_subscripts_ReferenceStructure-32"><a href="#get_subscripts_ReferenceStructure-32"><span class="linenos">32</span></a><span class="sd">    -------</span>
</span><span id="get_subscripts_ReferenceStructure-33"><a href="#get_subscripts_ReferenceStructure-33"><span class="linenos">33</span></a><span class="sd">    A tuple of strings indicating the subscripts</span>
</span><span id="get_subscripts_ReferenceStructure-34"><a href="#get_subscripts_ReferenceStructure-34"><span class="linenos">34</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="get_subscripts_ReferenceStructure-35"><a href="#get_subscripts_ReferenceStructure-35"><span class="linenos">35</span></a>    <span class="k">if</span> <span class="n">reference_structure</span><span class="o">.</span><span class="n">subscripts</span><span class="p">:</span>
</span><span id="get_subscripts_ReferenceStructure-36"><a href="#get_subscripts_ReferenceStructure-36"><span class="linenos">36</span></a>        <span class="k">return</span> <span class="n">reference_structure</span><span class="o">.</span><span class="n">subscripts</span><span class="o">.</span><span class="n">subscripts</span>
</span><span id="get_subscripts_ReferenceStructure-37"><a href="#get_subscripts_ReferenceStructure-37"><span class="linenos">37</span></a>
</span><span id="get_subscripts_ReferenceStructure-38"><a href="#get_subscripts_ReferenceStructure-38"><span class="linenos">38</span></a>    <span class="k">return</span> <span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>This function gets the subscript tuple from a <code>ReferenceStructure</code>. <code>ReferenceStructure</code> means it's referencing a
value of a variable, and its subscript attribute is a <code>SubscriptReferenceStructure</code> object. This function picks
out the tuple values from the <code>SubscriptReferenceStructure</code>.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>reference_structure</strong> (pysd_ast.ReferenceStructure):
The <code>ReferenceStructure</code> AST object</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>A tuple of strings indicating the subscripts</strong></li>
</ul>
</div>


                </section>
                <section id="BaseVensimWalker">
                            <input id="BaseVensimWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">BaseVensimWalker</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="BaseVensimWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseVensimWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseVensimWalker-41"><a href="#BaseVensimWalker-41"><span class="linenos">41</span></a><span class="nd">@dataclass</span>
</span><span id="BaseVensimWalker-42"><a href="#BaseVensimWalker-42"><span class="linenos">42</span></a><span class="k">class</span> <span class="nc">BaseVensimWalker</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="BaseVensimWalker-43"><a href="#BaseVensimWalker-43"><span class="linenos">43</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseVensimWalker-44"><a href="#BaseVensimWalker-44"><span class="linenos">44</span></a><span class="sd">    Base abstract class for Vensim AST walker classes.</span>
</span><span id="BaseVensimWalker-45"><a href="#BaseVensimWalker-45"><span class="linenos">45</span></a>
</span><span id="BaseVensimWalker-46"><a href="#BaseVensimWalker-46"><span class="linenos">46</span></a><span class="sd">    Attributes</span>
</span><span id="BaseVensimWalker-47"><a href="#BaseVensimWalker-47"><span class="linenos">47</span></a><span class="sd">    ----------</span>
</span><span id="BaseVensimWalker-48"><a href="#BaseVensimWalker-48"><span class="linenos">48</span></a><span class="sd">    v2s_code_handler : Vensim2StanCodeHandler</span>
</span><span id="BaseVensimWalker-49"><a href="#BaseVensimWalker-49"><span class="linenos">49</span></a><span class="sd">        `Vensim2StanCodeHandler`</span>
</span><span id="BaseVensimWalker-50"><a href="#BaseVensimWalker-50"><span class="linenos">50</span></a><span class="sd">    vensim_model_context : VensimModelContext</span>
</span><span id="BaseVensimWalker-51"><a href="#BaseVensimWalker-51"><span class="linenos">51</span></a><span class="sd">        `VensimModelContext`</span>
</span><span id="BaseVensimWalker-52"><a href="#BaseVensimWalker-52"><span class="linenos">52</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="BaseVensimWalker-53"><a href="#BaseVensimWalker-53"><span class="linenos">53</span></a>    <span class="n">v2s_code_handler</span><span class="p">:</span> <span class="n">Vensim2StanCodeHandler</span>
</span><span id="BaseVensimWalker-54"><a href="#BaseVensimWalker-54"><span class="linenos">54</span></a>    <span class="n">vensim_model_context</span><span class="p">:</span> <span class="n">VensimModelContext</span>
</span><span id="BaseVensimWalker-55"><a href="#BaseVensimWalker-55"><span class="linenos">55</span></a>    <span class="n">stan_model_context</span><span class="p">:</span> <span class="n">StanModelContext</span>
</span><span id="BaseVensimWalker-56"><a href="#BaseVensimWalker-56"><span class="linenos">56</span></a>
</span><span id="BaseVensimWalker-57"><a href="#BaseVensimWalker-57"><span class="linenos">57</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseVensimWalker-58"><a href="#BaseVensimWalker-58"><span class="linenos">58</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="BaseVensimWalker-59"><a href="#BaseVensimWalker-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseVensimWalker-60"><a href="#BaseVensimWalker-60"><span class="linenos">60</span></a><span class="sd">        This is the base format of the Vensim AST walkers. Although they&#39;re normally recursively called,</span>
</span><span id="BaseVensimWalker-61"><a href="#BaseVensimWalker-61"><span class="linenos">61</span></a><span class="sd">        values shouldn&#39;t be returned directly, but instead use a class attribute to pass back values.</span>
</span><span id="BaseVensimWalker-62"><a href="#BaseVensimWalker-62"><span class="linenos">62</span></a><span class="sd">        - pysd_element</span>
</span><span id="BaseVensimWalker-63"><a href="#BaseVensimWalker-63"><span class="linenos">63</span></a><span class="sd">            - name : str. This should be passed into `node_name`</span>
</span><span id="BaseVensimWalker-64"><a href="#BaseVensimWalker-64"><span class="linenos">64</span></a><span class="sd">            - components : list</span>
</span><span id="BaseVensimWalker-65"><a href="#BaseVensimWalker-65"><span class="linenos">65</span></a><span class="sd">                - component : AbstractComponent</span>
</span><span id="BaseVensimWalker-66"><a href="#BaseVensimWalker-66"><span class="linenos">66</span></a><span class="sd">                    - ast : Structure, AST Node. This should be passed into `ast_component`</span>
</span><span id="BaseVensimWalker-67"><a href="#BaseVensimWalker-67"><span class="linenos">67</span></a><span class="sd">                    - subscripts : tuple(list[Any], list[Any]). The **first element of the tuple** should be passed into `subscripts`</span>
</span><span id="BaseVensimWalker-68"><a href="#BaseVensimWalker-68"><span class="linenos">68</span></a>
</span><span id="BaseVensimWalker-69"><a href="#BaseVensimWalker-69"><span class="linenos">69</span></a><span class="sd">        Parameters</span>
</span><span id="BaseVensimWalker-70"><a href="#BaseVensimWalker-70"><span class="linenos">70</span></a><span class="sd">        ----------</span>
</span><span id="BaseVensimWalker-71"><a href="#BaseVensimWalker-71"><span class="linenos">71</span></a><span class="sd">        component_ast : AbstractSyntax</span>
</span><span id="BaseVensimWalker-72"><a href="#BaseVensimWalker-72"><span class="linenos">72</span></a><span class="sd">            The AST Node of the current AST. Its exact type should be</span>
</span><span id="BaseVensimWalker-73"><a href="#BaseVensimWalker-73"><span class="linenos">73</span></a><span class="sd">            `pysd.translators.structures.abstract_expressions.AbstractSyntax` and any of its children. By the above</span>
</span><span id="BaseVensimWalker-74"><a href="#BaseVensimWalker-74"><span class="linenos">74</span></a><span class="sd">            element hierarchy, should be `component.ast`.</span>
</span><span id="BaseVensimWalker-75"><a href="#BaseVensimWalker-75"><span class="linenos">75</span></a><span class="sd">        node_name : str</span>
</span><span id="BaseVensimWalker-76"><a href="#BaseVensimWalker-76"><span class="linenos">76</span></a><span class="sd">            String indicating the AST Node name. By the above element hierarchy, should be `element.name`</span>
</span><span id="BaseVensimWalker-77"><a href="#BaseVensimWalker-77"><span class="linenos">77</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="BaseVensimWalker-78"><a href="#BaseVensimWalker-78"><span class="linenos">78</span></a><span class="sd">            Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="BaseVensimWalker-79"><a href="#BaseVensimWalker-79"><span class="linenos">79</span></a><span class="sd">            `component.subscripts`.</span>
</span><span id="BaseVensimWalker-80"><a href="#BaseVensimWalker-80"><span class="linenos">80</span></a><span class="sd">            However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="BaseVensimWalker-81"><a href="#BaseVensimWalker-81"><span class="linenos">81</span></a><span class="sd">            in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="BaseVensimWalker-82"><a href="#BaseVensimWalker-82"><span class="linenos">82</span></a><span class="sd">        current_precedence : int</span>
</span><span id="BaseVensimWalker-83"><a href="#BaseVensimWalker-83"><span class="linenos">83</span></a><span class="sd">            Integer indicating the current operator precedence level. Only relevant when parsing `ArithmeticStructure`.</span>
</span><span id="BaseVensimWalker-84"><a href="#BaseVensimWalker-84"><span class="linenos">84</span></a>
</span><span id="BaseVensimWalker-85"><a href="#BaseVensimWalker-85"><span class="linenos">85</span></a><span class="sd">        Returns</span>
</span><span id="BaseVensimWalker-86"><a href="#BaseVensimWalker-86"><span class="linenos">86</span></a><span class="sd">        -------</span>
</span><span id="BaseVensimWalker-87"><a href="#BaseVensimWalker-87"><span class="linenos">87</span></a><span class="sd">        If using any of the `walk_X` methods, must return a string of the generated code.</span>
</span><span id="BaseVensimWalker-88"><a href="#BaseVensimWalker-88"><span class="linenos">88</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseVensimWalker-89"><a href="#BaseVensimWalker-89"><span class="linenos">89</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


            <div class="docstring"><p>Base abstract class for Vensim AST walker classes.</p>

<h6 id="attributes">Attributes</h6>

<ul>
<li><strong>v2s_code_handler</strong> (Vensim2StanCodeHandler):
<code>Vensim2StanCodeHandler</code></li>
<li><strong>vensim_model_context</strong> (VensimModelContext):
<code>VensimModelContext</code></li>
</ul>
</div>


                            <div id="BaseVensimWalker.walk" class="classattr">
                                        <input id="BaseVensimWalker.walk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@abstractmethod</div>

        <span class="def">def</span>
        <span class="name">walk</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">AbstractSyntax</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="BaseVensimWalker.walk-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#BaseVensimWalker.walk"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="BaseVensimWalker.walk-57"><a href="#BaseVensimWalker.walk-57"><span class="linenos">57</span></a>    <span class="nd">@abstractmethod</span>
</span><span id="BaseVensimWalker.walk-58"><a href="#BaseVensimWalker.walk-58"><span class="linenos">58</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="BaseVensimWalker.walk-59"><a href="#BaseVensimWalker.walk-59"><span class="linenos">59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="BaseVensimWalker.walk-60"><a href="#BaseVensimWalker.walk-60"><span class="linenos">60</span></a><span class="sd">        This is the base format of the Vensim AST walkers. Although they&#39;re normally recursively called,</span>
</span><span id="BaseVensimWalker.walk-61"><a href="#BaseVensimWalker.walk-61"><span class="linenos">61</span></a><span class="sd">        values shouldn&#39;t be returned directly, but instead use a class attribute to pass back values.</span>
</span><span id="BaseVensimWalker.walk-62"><a href="#BaseVensimWalker.walk-62"><span class="linenos">62</span></a><span class="sd">        - pysd_element</span>
</span><span id="BaseVensimWalker.walk-63"><a href="#BaseVensimWalker.walk-63"><span class="linenos">63</span></a><span class="sd">            - name : str. This should be passed into `node_name`</span>
</span><span id="BaseVensimWalker.walk-64"><a href="#BaseVensimWalker.walk-64"><span class="linenos">64</span></a><span class="sd">            - components : list</span>
</span><span id="BaseVensimWalker.walk-65"><a href="#BaseVensimWalker.walk-65"><span class="linenos">65</span></a><span class="sd">                - component : AbstractComponent</span>
</span><span id="BaseVensimWalker.walk-66"><a href="#BaseVensimWalker.walk-66"><span class="linenos">66</span></a><span class="sd">                    - ast : Structure, AST Node. This should be passed into `ast_component`</span>
</span><span id="BaseVensimWalker.walk-67"><a href="#BaseVensimWalker.walk-67"><span class="linenos">67</span></a><span class="sd">                    - subscripts : tuple(list[Any], list[Any]). The **first element of the tuple** should be passed into `subscripts`</span>
</span><span id="BaseVensimWalker.walk-68"><a href="#BaseVensimWalker.walk-68"><span class="linenos">68</span></a>
</span><span id="BaseVensimWalker.walk-69"><a href="#BaseVensimWalker.walk-69"><span class="linenos">69</span></a><span class="sd">        Parameters</span>
</span><span id="BaseVensimWalker.walk-70"><a href="#BaseVensimWalker.walk-70"><span class="linenos">70</span></a><span class="sd">        ----------</span>
</span><span id="BaseVensimWalker.walk-71"><a href="#BaseVensimWalker.walk-71"><span class="linenos">71</span></a><span class="sd">        component_ast : AbstractSyntax</span>
</span><span id="BaseVensimWalker.walk-72"><a href="#BaseVensimWalker.walk-72"><span class="linenos">72</span></a><span class="sd">            The AST Node of the current AST. Its exact type should be</span>
</span><span id="BaseVensimWalker.walk-73"><a href="#BaseVensimWalker.walk-73"><span class="linenos">73</span></a><span class="sd">            `pysd.translators.structures.abstract_expressions.AbstractSyntax` and any of its children. By the above</span>
</span><span id="BaseVensimWalker.walk-74"><a href="#BaseVensimWalker.walk-74"><span class="linenos">74</span></a><span class="sd">            element hierarchy, should be `component.ast`.</span>
</span><span id="BaseVensimWalker.walk-75"><a href="#BaseVensimWalker.walk-75"><span class="linenos">75</span></a><span class="sd">        node_name : str</span>
</span><span id="BaseVensimWalker.walk-76"><a href="#BaseVensimWalker.walk-76"><span class="linenos">76</span></a><span class="sd">            String indicating the AST Node name. By the above element hierarchy, should be `element.name`</span>
</span><span id="BaseVensimWalker.walk-77"><a href="#BaseVensimWalker.walk-77"><span class="linenos">77</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="BaseVensimWalker.walk-78"><a href="#BaseVensimWalker.walk-78"><span class="linenos">78</span></a><span class="sd">            Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="BaseVensimWalker.walk-79"><a href="#BaseVensimWalker.walk-79"><span class="linenos">79</span></a><span class="sd">            `component.subscripts`.</span>
</span><span id="BaseVensimWalker.walk-80"><a href="#BaseVensimWalker.walk-80"><span class="linenos">80</span></a><span class="sd">            However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="BaseVensimWalker.walk-81"><a href="#BaseVensimWalker.walk-81"><span class="linenos">81</span></a><span class="sd">            in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="BaseVensimWalker.walk-82"><a href="#BaseVensimWalker.walk-82"><span class="linenos">82</span></a><span class="sd">        current_precedence : int</span>
</span><span id="BaseVensimWalker.walk-83"><a href="#BaseVensimWalker.walk-83"><span class="linenos">83</span></a><span class="sd">            Integer indicating the current operator precedence level. Only relevant when parsing `ArithmeticStructure`.</span>
</span><span id="BaseVensimWalker.walk-84"><a href="#BaseVensimWalker.walk-84"><span class="linenos">84</span></a>
</span><span id="BaseVensimWalker.walk-85"><a href="#BaseVensimWalker.walk-85"><span class="linenos">85</span></a><span class="sd">        Returns</span>
</span><span id="BaseVensimWalker.walk-86"><a href="#BaseVensimWalker.walk-86"><span class="linenos">86</span></a><span class="sd">        -------</span>
</span><span id="BaseVensimWalker.walk-87"><a href="#BaseVensimWalker.walk-87"><span class="linenos">87</span></a><span class="sd">        If using any of the `walk_X` methods, must return a string of the generated code.</span>
</span><span id="BaseVensimWalker.walk-88"><a href="#BaseVensimWalker.walk-88"><span class="linenos">88</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="BaseVensimWalker.walk-89"><a href="#BaseVensimWalker.walk-89"><span class="linenos">89</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</span></pre></div>


            <div class="docstring"><p>This is the base format of the Vensim AST walkers. Although they're normally recursively called,
values shouldn't be returned directly, but instead use a class attribute to pass back values.</p>

<ul>
<li>pysd_element
<ul>
<li>name : str. This should be passed into <code>node_name</code></li>
<li>components : list
<ul>
<li>component : AbstractComponent
<ul>
<li>ast : Structure, AST Node. This should be passed into <code>ast_component</code></li>
<li>subscripts : tuple(list[Any], list[Any]). The <strong>first element of the tuple</strong> should be passed into <code>subscripts</code></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component_ast</strong> (AbstractSyntax):
The AST Node of the current AST. Its exact type should be
<code>pysd.translators.structures.abstract_expressions.AbstractSyntax</code> and any of its children. By the above
element hierarchy, should be <code>component.ast</code>.</li>
<li><strong>node_name</strong> (str):
String indicating the AST Node name. By the above element hierarchy, should be <code>element.name</code></li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be
<code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Integer indicating the current operator precedence level. Only relevant when parsing <code>ArithmeticStructure</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>If using any of the <code>walk_X</code> methods, must return a string of the generated code.</strong></li>
</ul>
</div>


                            </div>
                </section>
                <section id="FindStaticDataVariablesWalker">
                            <input id="FindStaticDataVariablesWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FindStaticDataVariablesWalker</span><wbr>(<span class="base"><a href="#BaseVensimWalker">BaseVensimWalker</a></span>):

                <label class="view-source-button" for="FindStaticDataVariablesWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FindStaticDataVariablesWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindStaticDataVariablesWalker-92"><a href="#FindStaticDataVariablesWalker-92"><span class="linenos"> 92</span></a><span class="k">class</span> <span class="nc">FindStaticDataVariablesWalker</span><span class="p">(</span><span class="n">BaseVensimWalker</span><span class="p">):</span>
</span><span id="FindStaticDataVariablesWalker-93"><a href="#FindStaticDataVariablesWalker-93"><span class="linenos"> 93</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FindStaticDataVariablesWalker-94"><a href="#FindStaticDataVariablesWalker-94"><span class="linenos"> 94</span></a><span class="sd">    This walker finds any static data variables defined within the Vensim program. It&#39;s intended to be used to fill</span>
</span><span id="FindStaticDataVariablesWalker-95"><a href="#FindStaticDataVariablesWalker-95"><span class="linenos"> 95</span></a><span class="sd">    `stanify.builders.stan_model_context.StanModelContext` during preliminary passes.</span>
</span><span id="FindStaticDataVariablesWalker-96"><a href="#FindStaticDataVariablesWalker-96"><span class="linenos"> 96</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FindStaticDataVariablesWalker-97"><a href="#FindStaticDataVariablesWalker-97"><span class="linenos"> 97</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker-98"><a href="#FindStaticDataVariablesWalker-98"><span class="linenos"> 98</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker-99"><a href="#FindStaticDataVariablesWalker-99"><span class="linenos"> 99</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">()</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">():</span>
</span><span id="FindStaticDataVariablesWalker-100"><a href="#FindStaticDataVariablesWalker-100"><span class="linenos">100</span></a>                <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="o">.</span><span class="n">declared_variables</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker-101"><a href="#FindStaticDataVariablesWalker-101"><span class="linenos">101</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">transformed_data_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker-102"><a href="#FindStaticDataVariablesWalker-102"><span class="linenos">102</span></a>
</span><span id="FindStaticDataVariablesWalker-103"><a href="#FindStaticDataVariablesWalker-103"><span class="linenos">103</span></a>                <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker-104"><a href="#FindStaticDataVariablesWalker-104"><span class="linenos">104</span></a>                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Values for variable </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2"> exists in the Vensim model, but other values already exist. Ignoring values defines within the Vensim model...&quot;</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker-105"><a href="#FindStaticDataVariablesWalker-105"><span class="linenos">105</span></a>
</span><span id="FindStaticDataVariablesWalker-106"><a href="#FindStaticDataVariablesWalker-106"><span class="linenos">106</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="FindStaticDataVariablesWalker-107"><a href="#FindStaticDataVariablesWalker-107"><span class="linenos">107</span></a>                    <span class="c1"># Variables with subscripts needs to be transformed into a xarray.DataArray with subscript info.</span>
</span><span id="FindStaticDataVariablesWalker-108"><a href="#FindStaticDataVariablesWalker-108"><span class="linenos">108</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="n">subscript</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">get_subscript_values</span><span class="p">(</span><span class="n">subscript</span><span class="p">))</span> <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">subscripts</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker-109"><a href="#FindStaticDataVariablesWalker-109"><span class="linenos">109</span></a>
</span><span id="FindStaticDataVariablesWalker-110"><a href="#FindStaticDataVariablesWalker-110"><span class="linenos">110</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker-111"><a href="#FindStaticDataVariablesWalker-111"><span class="linenos">111</span></a>                    <span class="k">if</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker-112"><a href="#FindStaticDataVariablesWalker-112"><span class="linenos">112</span></a>                        <span class="c1"># If there are subscripts, it needs to be expanded into a xarray</span>
</span><span id="FindStaticDataVariablesWalker-113"><a href="#FindStaticDataVariablesWalker-113"><span class="linenos">113</span></a>
</span><span id="FindStaticDataVariablesWalker-114"><a href="#FindStaticDataVariablesWalker-114"><span class="linenos">114</span></a>                        <span class="c1"># tile the scalar value into an array</span>
</span><span id="FindStaticDataVariablesWalker-115"><a href="#FindStaticDataVariablesWalker-115"><span class="linenos">115</span></a>                        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">get_variable_shape</span><span class="p">(</span><span class="n">node_name</span><span class="p">))</span>
</span><span id="FindStaticDataVariablesWalker-116"><a href="#FindStaticDataVariablesWalker-116"><span class="linenos">116</span></a>
</span><span id="FindStaticDataVariablesWalker-117"><a href="#FindStaticDataVariablesWalker-117"><span class="linenos">117</span></a>                        <span class="c1"># Create the dataarray with the subscript information</span>
</span><span id="FindStaticDataVariablesWalker-118"><a href="#FindStaticDataVariablesWalker-118"><span class="linenos">118</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="n">subscript</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">get_subscript_values</span><span class="p">(</span><span class="n">subscript</span><span class="p">))</span> <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">subscripts</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker-119"><a href="#FindStaticDataVariablesWalker-119"><span class="linenos">119</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker-120"><a href="#FindStaticDataVariablesWalker-120"><span class="linenos">120</span></a>                        <span class="c1"># just a scalar :)</span>
</span><span id="FindStaticDataVariablesWalker-121"><a href="#FindStaticDataVariablesWalker-121"><span class="linenos">121</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component_ast</span>
</span><span id="FindStaticDataVariablesWalker-122"><a href="#FindStaticDataVariablesWalker-122"><span class="linenos">122</span></a>
</span><span id="FindStaticDataVariablesWalker-123"><a href="#FindStaticDataVariablesWalker-123"><span class="linenos">123</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">DataStructure</span><span class="p">():</span>
</span><span id="FindStaticDataVariablesWalker-124"><a href="#FindStaticDataVariablesWalker-124"><span class="linenos">124</span></a>                <span class="c1"># DataStructures are time-variant variables</span>
</span><span id="FindStaticDataVariablesWalker-125"><a href="#FindStaticDataVariablesWalker-125"><span class="linenos">125</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">timestep_variant_datafunc_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker-126"><a href="#FindStaticDataVariablesWalker-126"><span class="linenos">126</span></a>
</span><span id="FindStaticDataVariablesWalker-127"><a href="#FindStaticDataVariablesWalker-127"><span class="linenos">127</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">LookupsStructure</span><span class="p">():</span>
</span><span id="FindStaticDataVariablesWalker-128"><a href="#FindStaticDataVariablesWalker-128"><span class="linenos">128</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">lookupfunc_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This walker finds any static data variables defined within the Vensim program. It's intended to be used to fill
<code><a href="stan_model_context.html#StanModelContext">stanify.builders.stan_model_context.StanModelContext</a></code> during preliminary passes.</p>
</div>


                            <div id="FindStaticDataVariablesWalker.walk" class="classattr">
                                        <input id="FindStaticDataVariablesWalker.walk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">AbstractSyntax</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="FindStaticDataVariablesWalker.walk-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FindStaticDataVariablesWalker.walk"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindStaticDataVariablesWalker.walk-97"><a href="#FindStaticDataVariablesWalker.walk-97"><span class="linenos"> 97</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker.walk-98"><a href="#FindStaticDataVariablesWalker.walk-98"><span class="linenos"> 98</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker.walk-99"><a href="#FindStaticDataVariablesWalker.walk-99"><span class="linenos"> 99</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">()</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">():</span>
</span><span id="FindStaticDataVariablesWalker.walk-100"><a href="#FindStaticDataVariablesWalker.walk-100"><span class="linenos">100</span></a>                <span class="k">if</span> <span class="n">node_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="o">.</span><span class="n">declared_variables</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker.walk-101"><a href="#FindStaticDataVariablesWalker.walk-101"><span class="linenos">101</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">transformed_data_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker.walk-102"><a href="#FindStaticDataVariablesWalker.walk-102"><span class="linenos">102</span></a>
</span><span id="FindStaticDataVariablesWalker.walk-103"><a href="#FindStaticDataVariablesWalker.walk-103"><span class="linenos">103</span></a>                <span class="k">if</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker.walk-104"><a href="#FindStaticDataVariablesWalker.walk-104"><span class="linenos">104</span></a>                    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Values for variable </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2"> exists in the Vensim model, but other values already exist. Ignoring values defines within the Vensim model...&quot;</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker.walk-105"><a href="#FindStaticDataVariablesWalker.walk-105"><span class="linenos">105</span></a>
</span><span id="FindStaticDataVariablesWalker.walk-106"><a href="#FindStaticDataVariablesWalker.walk-106"><span class="linenos">106</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
</span><span id="FindStaticDataVariablesWalker.walk-107"><a href="#FindStaticDataVariablesWalker.walk-107"><span class="linenos">107</span></a>                    <span class="c1"># Variables with subscripts needs to be transformed into a xarray.DataArray with subscript info.</span>
</span><span id="FindStaticDataVariablesWalker.walk-108"><a href="#FindStaticDataVariablesWalker.walk-108"><span class="linenos">108</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="n">subscript</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">get_subscript_values</span><span class="p">(</span><span class="n">subscript</span><span class="p">))</span> <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">subscripts</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker.walk-109"><a href="#FindStaticDataVariablesWalker.walk-109"><span class="linenos">109</span></a>
</span><span id="FindStaticDataVariablesWalker.walk-110"><a href="#FindStaticDataVariablesWalker.walk-110"><span class="linenos">110</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker.walk-111"><a href="#FindStaticDataVariablesWalker.walk-111"><span class="linenos">111</span></a>                    <span class="k">if</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker.walk-112"><a href="#FindStaticDataVariablesWalker.walk-112"><span class="linenos">112</span></a>                        <span class="c1"># If there are subscripts, it needs to be expanded into a xarray</span>
</span><span id="FindStaticDataVariablesWalker.walk-113"><a href="#FindStaticDataVariablesWalker.walk-113"><span class="linenos">113</span></a>
</span><span id="FindStaticDataVariablesWalker.walk-114"><a href="#FindStaticDataVariablesWalker.walk-114"><span class="linenos">114</span></a>                        <span class="c1"># tile the scalar value into an array</span>
</span><span id="FindStaticDataVariablesWalker.walk-115"><a href="#FindStaticDataVariablesWalker.walk-115"><span class="linenos">115</span></a>                        <span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">get_variable_shape</span><span class="p">(</span><span class="n">node_name</span><span class="p">))</span>
</span><span id="FindStaticDataVariablesWalker.walk-116"><a href="#FindStaticDataVariablesWalker.walk-116"><span class="linenos">116</span></a>
</span><span id="FindStaticDataVariablesWalker.walk-117"><a href="#FindStaticDataVariablesWalker.walk-117"><span class="linenos">117</span></a>                        <span class="c1"># Create the dataarray with the subscript information</span>
</span><span id="FindStaticDataVariablesWalker.walk-118"><a href="#FindStaticDataVariablesWalker.walk-118"><span class="linenos">118</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">xarray</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="n">subscript</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">get_subscript_values</span><span class="p">(</span><span class="n">subscript</span><span class="p">))</span> <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">subscripts</span><span class="p">},</span> <span class="n">dims</span><span class="o">=</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker.walk-119"><a href="#FindStaticDataVariablesWalker.walk-119"><span class="linenos">119</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="FindStaticDataVariablesWalker.walk-120"><a href="#FindStaticDataVariablesWalker.walk-120"><span class="linenos">120</span></a>                        <span class="c1"># just a scalar :)</span>
</span><span id="FindStaticDataVariablesWalker.walk-121"><a href="#FindStaticDataVariablesWalker.walk-121"><span class="linenos">121</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">static_data_variable_values</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">component_ast</span>
</span><span id="FindStaticDataVariablesWalker.walk-122"><a href="#FindStaticDataVariablesWalker.walk-122"><span class="linenos">122</span></a>
</span><span id="FindStaticDataVariablesWalker.walk-123"><a href="#FindStaticDataVariablesWalker.walk-123"><span class="linenos">123</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">DataStructure</span><span class="p">():</span>
</span><span id="FindStaticDataVariablesWalker.walk-124"><a href="#FindStaticDataVariablesWalker.walk-124"><span class="linenos">124</span></a>                <span class="c1"># DataStructures are time-variant variables</span>
</span><span id="FindStaticDataVariablesWalker.walk-125"><a href="#FindStaticDataVariablesWalker.walk-125"><span class="linenos">125</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">timestep_variant_datafunc_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span><span id="FindStaticDataVariablesWalker.walk-126"><a href="#FindStaticDataVariablesWalker.walk-126"><span class="linenos">126</span></a>
</span><span id="FindStaticDataVariablesWalker.walk-127"><a href="#FindStaticDataVariablesWalker.walk-127"><span class="linenos">127</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">LookupsStructure</span><span class="p">():</span>
</span><span id="FindStaticDataVariablesWalker.walk-128"><a href="#FindStaticDataVariablesWalker.walk-128"><span class="linenos">128</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="o">.</span><span class="n">lookupfunc_variables</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">node_name</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This is the base format of the Vensim AST walkers. Although they're normally recursively called,
values shouldn't be returned directly, but instead use a class attribute to pass back values.</p>

<ul>
<li>pysd_element
<ul>
<li>name : str. This should be passed into <code>node_name</code></li>
<li>components : list
<ul>
<li>component : AbstractComponent
<ul>
<li>ast : Structure, AST Node. This should be passed into <code>ast_component</code></li>
<li>subscripts : tuple(list[Any], list[Any]). The <strong>first element of the tuple</strong> should be passed into <code>subscripts</code></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component_ast</strong> (AbstractSyntax):
The AST Node of the current AST. Its exact type should be
<code>pysd.translators.structures.abstract_expressions.AbstractSyntax</code> and any of its children. By the above
element hierarchy, should be <code>component.ast</code>.</li>
<li><strong>node_name</strong> (str):
String indicating the AST Node name. By the above element hierarchy, should be <code>element.name</code></li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be
<code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Integer indicating the current operator precedence level. Only relevant when parsing <code>ArithmeticStructure</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>If using any of the <code>walk_X</code> methods, must return a string of the generated code.</strong></li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#BaseVensimWalker">BaseVensimWalker</a></dt>
                                <dd id="FindStaticDataVariablesWalker.__init__" class="function"><a href="#BaseVensimWalker.__init__">BaseVensimWalker</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="FindODERHSVariablesVensimWalker">
                            <input id="FindODERHSVariablesVensimWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FindODERHSVariablesVensimWalker</span>:

                <label class="view-source-button" for="FindODERHSVariablesVensimWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FindODERHSVariablesVensimWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindODERHSVariablesVensimWalker-131"><a href="#FindODERHSVariablesVensimWalker-131"><span class="linenos">131</span></a><span class="k">class</span> <span class="nc">FindODERHSVariablesVensimWalker</span><span class="p">:</span>
</span><span id="FindODERHSVariablesVensimWalker-132"><a href="#FindODERHSVariablesVensimWalker-132"><span class="linenos">132</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FindODERHSVariablesVensimWalker-133"><a href="#FindODERHSVariablesVensimWalker-133"><span class="linenos">133</span></a><span class="sd">    Finds all the variables that are present on the RHS of a statement. This is useful for creating a dependency graph,</span>
</span><span id="FindODERHSVariablesVensimWalker-134"><a href="#FindODERHSVariablesVensimWalker-134"><span class="linenos">134</span></a><span class="sd">    since you know the LHS variable name through `element.name`, and this walker provides a list of the dependant</span>
</span><span id="FindODERHSVariablesVensimWalker-135"><a href="#FindODERHSVariablesVensimWalker-135"><span class="linenos">135</span></a><span class="sd">    variables.</span>
</span><span id="FindODERHSVariablesVensimWalker-136"><a href="#FindODERHSVariablesVensimWalker-136"><span class="linenos">136</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FindODERHSVariablesVensimWalker-137"><a href="#FindODERHSVariablesVensimWalker-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="FindODERHSVariablesVensimWalker-138"><a href="#FindODERHSVariablesVensimWalker-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FindODERHSVariablesVensimWalker-139"><a href="#FindODERHSVariablesVensimWalker-139"><span class="linenos">139</span></a><span class="sd">        Find and return the RHS variable names of a given statement AST.</span>
</span><span id="FindODERHSVariablesVensimWalker-140"><a href="#FindODERHSVariablesVensimWalker-140"><span class="linenos">140</span></a>
</span><span id="FindODERHSVariablesVensimWalker-141"><a href="#FindODERHSVariablesVensimWalker-141"><span class="linenos">141</span></a><span class="sd">        Parameters</span>
</span><span id="FindODERHSVariablesVensimWalker-142"><a href="#FindODERHSVariablesVensimWalker-142"><span class="linenos">142</span></a><span class="sd">        ----------</span>
</span><span id="FindODERHSVariablesVensimWalker-143"><a href="#FindODERHSVariablesVensimWalker-143"><span class="linenos">143</span></a><span class="sd">        component_ast : AbstractSyntax</span>
</span><span id="FindODERHSVariablesVensimWalker-144"><a href="#FindODERHSVariablesVensimWalker-144"><span class="linenos">144</span></a><span class="sd">            AST entry point node</span>
</span><span id="FindODERHSVariablesVensimWalker-145"><a href="#FindODERHSVariablesVensimWalker-145"><span class="linenos">145</span></a>
</span><span id="FindODERHSVariablesVensimWalker-146"><a href="#FindODERHSVariablesVensimWalker-146"><span class="linenos">146</span></a><span class="sd">        Returns</span>
</span><span id="FindODERHSVariablesVensimWalker-147"><a href="#FindODERHSVariablesVensimWalker-147"><span class="linenos">147</span></a><span class="sd">        -------</span>
</span><span id="FindODERHSVariablesVensimWalker-148"><a href="#FindODERHSVariablesVensimWalker-148"><span class="linenos">148</span></a><span class="sd">        a list of strings of the variables</span>
</span><span id="FindODERHSVariablesVensimWalker-149"><a href="#FindODERHSVariablesVensimWalker-149"><span class="linenos">149</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FindODERHSVariablesVensimWalker-150"><a href="#FindODERHSVariablesVensimWalker-150"><span class="linenos">150</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="FindODERHSVariablesVensimWalker-151"><a href="#FindODERHSVariablesVensimWalker-151"><span class="linenos">151</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker-152"><a href="#FindODERHSVariablesVensimWalker-152"><span class="linenos">152</span></a>                <span class="k">return</span> <span class="p">[]</span>
</span><span id="FindODERHSVariablesVensimWalker-153"><a href="#FindODERHSVariablesVensimWalker-153"><span class="linenos">153</span></a>
</span><span id="FindODERHSVariablesVensimWalker-154"><a href="#FindODERHSVariablesVensimWalker-154"><span class="linenos">154</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker-155"><a href="#FindODERHSVariablesVensimWalker-155"><span class="linenos">155</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="FindODERHSVariablesVensimWalker-156"><a href="#FindODERHSVariablesVensimWalker-156"><span class="linenos">156</span></a>
</span><span id="FindODERHSVariablesVensimWalker-157"><a href="#FindODERHSVariablesVensimWalker-157"><span class="linenos">157</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker-158"><a href="#FindODERHSVariablesVensimWalker-158"><span class="linenos">158</span></a>                <span class="k">return</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span><span class="p">]</span>
</span><span id="FindODERHSVariablesVensimWalker-159"><a href="#FindODERHSVariablesVensimWalker-159"><span class="linenos">159</span></a>
</span><span id="FindODERHSVariablesVensimWalker-160"><a href="#FindODERHSVariablesVensimWalker-160"><span class="linenos">160</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker-161"><a href="#FindODERHSVariablesVensimWalker-161"><span class="linenos">161</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="FindODERHSVariablesVensimWalker-162"><a href="#FindODERHSVariablesVensimWalker-162"><span class="linenos">162</span></a>
</span><span id="FindODERHSVariablesVensimWalker-163"><a href="#FindODERHSVariablesVensimWalker-163"><span class="linenos">163</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker-164"><a href="#FindODERHSVariablesVensimWalker-164"><span class="linenos">164</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">flow</span><span class="p">)</span>
</span><span id="FindODERHSVariablesVensimWalker-165"><a href="#FindODERHSVariablesVensimWalker-165"><span class="linenos">165</span></a>
</span><span id="FindODERHSVariablesVensimWalker-166"><a href="#FindODERHSVariablesVensimWalker-166"><span class="linenos">166</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">InlineLookupsStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker-167"><a href="#FindODERHSVariablesVensimWalker-167"><span class="linenos">167</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">lookups</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Finds all the variables that are present on the RHS of a statement. This is useful for creating a dependency graph,
since you know the LHS variable name through <code>element.name</code>, and this walker provides a list of the dependant
variables.</p>
</div>


                            <div id="FindODERHSVariablesVensimWalker.walk" class="classattr">
                                        <input id="FindODERHSVariablesVensimWalker.walk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">AbstractSyntax</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FindODERHSVariablesVensimWalker.walk-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FindODERHSVariablesVensimWalker.walk"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindODERHSVariablesVensimWalker.walk-137"><a href="#FindODERHSVariablesVensimWalker.walk-137"><span class="linenos">137</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-138"><a href="#FindODERHSVariablesVensimWalker.walk-138"><span class="linenos">138</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-139"><a href="#FindODERHSVariablesVensimWalker.walk-139"><span class="linenos">139</span></a><span class="sd">        Find and return the RHS variable names of a given statement AST.</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-140"><a href="#FindODERHSVariablesVensimWalker.walk-140"><span class="linenos">140</span></a>
</span><span id="FindODERHSVariablesVensimWalker.walk-141"><a href="#FindODERHSVariablesVensimWalker.walk-141"><span class="linenos">141</span></a><span class="sd">        Parameters</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-142"><a href="#FindODERHSVariablesVensimWalker.walk-142"><span class="linenos">142</span></a><span class="sd">        ----------</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-143"><a href="#FindODERHSVariablesVensimWalker.walk-143"><span class="linenos">143</span></a><span class="sd">        component_ast : AbstractSyntax</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-144"><a href="#FindODERHSVariablesVensimWalker.walk-144"><span class="linenos">144</span></a><span class="sd">            AST entry point node</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-145"><a href="#FindODERHSVariablesVensimWalker.walk-145"><span class="linenos">145</span></a>
</span><span id="FindODERHSVariablesVensimWalker.walk-146"><a href="#FindODERHSVariablesVensimWalker.walk-146"><span class="linenos">146</span></a><span class="sd">        Returns</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-147"><a href="#FindODERHSVariablesVensimWalker.walk-147"><span class="linenos">147</span></a><span class="sd">        -------</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-148"><a href="#FindODERHSVariablesVensimWalker.walk-148"><span class="linenos">148</span></a><span class="sd">        a list of strings of the variables</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-149"><a href="#FindODERHSVariablesVensimWalker.walk-149"><span class="linenos">149</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-150"><a href="#FindODERHSVariablesVensimWalker.walk-150"><span class="linenos">150</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-151"><a href="#FindODERHSVariablesVensimWalker.walk-151"><span class="linenos">151</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-152"><a href="#FindODERHSVariablesVensimWalker.walk-152"><span class="linenos">152</span></a>                <span class="k">return</span> <span class="p">[]</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-153"><a href="#FindODERHSVariablesVensimWalker.walk-153"><span class="linenos">153</span></a>
</span><span id="FindODERHSVariablesVensimWalker.walk-154"><a href="#FindODERHSVariablesVensimWalker.walk-154"><span class="linenos">154</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-155"><a href="#FindODERHSVariablesVensimWalker.walk-155"><span class="linenos">155</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-156"><a href="#FindODERHSVariablesVensimWalker.walk-156"><span class="linenos">156</span></a>
</span><span id="FindODERHSVariablesVensimWalker.walk-157"><a href="#FindODERHSVariablesVensimWalker.walk-157"><span class="linenos">157</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-158"><a href="#FindODERHSVariablesVensimWalker.walk-158"><span class="linenos">158</span></a>                <span class="k">return</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span><span class="p">]</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-159"><a href="#FindODERHSVariablesVensimWalker.walk-159"><span class="linenos">159</span></a>
</span><span id="FindODERHSVariablesVensimWalker.walk-160"><a href="#FindODERHSVariablesVensimWalker.walk-160"><span class="linenos">160</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-161"><a href="#FindODERHSVariablesVensimWalker.walk-161"><span class="linenos">161</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-162"><a href="#FindODERHSVariablesVensimWalker.walk-162"><span class="linenos">162</span></a>
</span><span id="FindODERHSVariablesVensimWalker.walk-163"><a href="#FindODERHSVariablesVensimWalker.walk-163"><span class="linenos">163</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-164"><a href="#FindODERHSVariablesVensimWalker.walk-164"><span class="linenos">164</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">flow</span><span class="p">)</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-165"><a href="#FindODERHSVariablesVensimWalker.walk-165"><span class="linenos">165</span></a>
</span><span id="FindODERHSVariablesVensimWalker.walk-166"><a href="#FindODERHSVariablesVensimWalker.walk-166"><span class="linenos">166</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">InlineLookupsStructure</span><span class="p">():</span>
</span><span id="FindODERHSVariablesVensimWalker.walk-167"><a href="#FindODERHSVariablesVensimWalker.walk-167"><span class="linenos">167</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">lookups</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Find and return the RHS variable names of a given statement AST.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component_ast</strong> (AbstractSyntax):
AST entry point node</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>a list of strings of the variables</strong></li>
</ul>
</div>


                            </div>
                </section>
                <section id="FindODEInitialRHSVariablesVensimWalker">
                            <input id="FindODEInitialRHSVariablesVensimWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">FindODEInitialRHSVariablesVensimWalker</span>:

                <label class="view-source-button" for="FindODEInitialRHSVariablesVensimWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FindODEInitialRHSVariablesVensimWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindODEInitialRHSVariablesVensimWalker-170"><a href="#FindODEInitialRHSVariablesVensimWalker-170"><span class="linenos">170</span></a><span class="k">class</span> <span class="nc">FindODEInitialRHSVariablesVensimWalker</span><span class="p">:</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-171"><a href="#FindODEInitialRHSVariablesVensimWalker-171"><span class="linenos">171</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-172"><a href="#FindODEInitialRHSVariablesVensimWalker-172"><span class="linenos">172</span></a><span class="sd">    Finds all the variables that are present on the RHS of a statement. This is useful for creating a dependency graph,</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-173"><a href="#FindODEInitialRHSVariablesVensimWalker-173"><span class="linenos">173</span></a><span class="sd">    since you know the LHS variable name through `element.name`, and this walker provides a list of the dependant</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-174"><a href="#FindODEInitialRHSVariablesVensimWalker-174"><span class="linenos">174</span></a><span class="sd">    variables. This looks through the initial values instead of the actual ODE equations.</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-175"><a href="#FindODEInitialRHSVariablesVensimWalker-175"><span class="linenos">175</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-176"><a href="#FindODEInitialRHSVariablesVensimWalker-176"><span class="linenos">176</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-177"><a href="#FindODEInitialRHSVariablesVensimWalker-177"><span class="linenos">177</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-178"><a href="#FindODEInitialRHSVariablesVensimWalker-178"><span class="linenos">178</span></a><span class="sd">        Find and return the RHS variable names of a given statement AST.</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-179"><a href="#FindODEInitialRHSVariablesVensimWalker-179"><span class="linenos">179</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker-180"><a href="#FindODEInitialRHSVariablesVensimWalker-180"><span class="linenos">180</span></a><span class="sd">        Parameters</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-181"><a href="#FindODEInitialRHSVariablesVensimWalker-181"><span class="linenos">181</span></a><span class="sd">        ----------</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-182"><a href="#FindODEInitialRHSVariablesVensimWalker-182"><span class="linenos">182</span></a><span class="sd">        component_ast : AbstractSyntax</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-183"><a href="#FindODEInitialRHSVariablesVensimWalker-183"><span class="linenos">183</span></a><span class="sd">            AST entry point node</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-184"><a href="#FindODEInitialRHSVariablesVensimWalker-184"><span class="linenos">184</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker-185"><a href="#FindODEInitialRHSVariablesVensimWalker-185"><span class="linenos">185</span></a><span class="sd">        Returns</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-186"><a href="#FindODEInitialRHSVariablesVensimWalker-186"><span class="linenos">186</span></a><span class="sd">        -------</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-187"><a href="#FindODEInitialRHSVariablesVensimWalker-187"><span class="linenos">187</span></a><span class="sd">        a list of strings of the variables</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-188"><a href="#FindODEInitialRHSVariablesVensimWalker-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-189"><a href="#FindODEInitialRHSVariablesVensimWalker-189"><span class="linenos">189</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-190"><a href="#FindODEInitialRHSVariablesVensimWalker-190"><span class="linenos">190</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-191"><a href="#FindODEInitialRHSVariablesVensimWalker-191"><span class="linenos">191</span></a>                <span class="k">return</span> <span class="p">[]</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-192"><a href="#FindODEInitialRHSVariablesVensimWalker-192"><span class="linenos">192</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker-193"><a href="#FindODEInitialRHSVariablesVensimWalker-193"><span class="linenos">193</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-194"><a href="#FindODEInitialRHSVariablesVensimWalker-194"><span class="linenos">194</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-195"><a href="#FindODEInitialRHSVariablesVensimWalker-195"><span class="linenos">195</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker-196"><a href="#FindODEInitialRHSVariablesVensimWalker-196"><span class="linenos">196</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-197"><a href="#FindODEInitialRHSVariablesVensimWalker-197"><span class="linenos">197</span></a>                <span class="k">return</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span><span class="p">]</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-198"><a href="#FindODEInitialRHSVariablesVensimWalker-198"><span class="linenos">198</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker-199"><a href="#FindODEInitialRHSVariablesVensimWalker-199"><span class="linenos">199</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-200"><a href="#FindODEInitialRHSVariablesVensimWalker-200"><span class="linenos">200</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-201"><a href="#FindODEInitialRHSVariablesVensimWalker-201"><span class="linenos">201</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker-202"><a href="#FindODEInitialRHSVariablesVensimWalker-202"><span class="linenos">202</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-203"><a href="#FindODEInitialRHSVariablesVensimWalker-203"><span class="linenos">203</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">initial</span><span class="p">)</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-204"><a href="#FindODEInitialRHSVariablesVensimWalker-204"><span class="linenos">204</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker-205"><a href="#FindODEInitialRHSVariablesVensimWalker-205"><span class="linenos">205</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">InlineLookupsStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker-206"><a href="#FindODEInitialRHSVariablesVensimWalker-206"><span class="linenos">206</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">lookups</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Finds all the variables that are present on the RHS of a statement. This is useful for creating a dependency graph,
since you know the LHS variable name through <code>element.name</code>, and this walker provides a list of the dependant
variables. This looks through the initial values instead of the actual ODE equations.</p>
</div>


                            <div id="FindODEInitialRHSVariablesVensimWalker.walk" class="classattr">
                                        <input id="FindODEInitialRHSVariablesVensimWalker.walk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">AbstractSyntax</span></span><span class="return-annotation">) -> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="FindODEInitialRHSVariablesVensimWalker.walk-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#FindODEInitialRHSVariablesVensimWalker.walk"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="FindODEInitialRHSVariablesVensimWalker.walk-176"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-176"><span class="linenos">176</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-177"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-177"><span class="linenos">177</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-178"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-178"><span class="linenos">178</span></a><span class="sd">        Find and return the RHS variable names of a given statement AST.</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-179"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-179"><span class="linenos">179</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-180"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-180"><span class="linenos">180</span></a><span class="sd">        Parameters</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-181"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-181"><span class="linenos">181</span></a><span class="sd">        ----------</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-182"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-182"><span class="linenos">182</span></a><span class="sd">        component_ast : AbstractSyntax</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-183"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-183"><span class="linenos">183</span></a><span class="sd">            AST entry point node</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-184"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-184"><span class="linenos">184</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-185"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-185"><span class="linenos">185</span></a><span class="sd">        Returns</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-186"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-186"><span class="linenos">186</span></a><span class="sd">        -------</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-187"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-187"><span class="linenos">187</span></a><span class="sd">        a list of strings of the variables</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-188"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-188"><span class="linenos">188</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-189"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-189"><span class="linenos">189</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-190"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-190"><span class="linenos">190</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-191"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-191"><span class="linenos">191</span></a>                <span class="k">return</span> <span class="p">[]</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-192"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-192"><span class="linenos">192</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-193"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-193"><span class="linenos">193</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-194"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-194"><span class="linenos">194</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-195"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-195"><span class="linenos">195</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-196"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-196"><span class="linenos">196</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-197"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-197"><span class="linenos">197</span></a>                <span class="k">return</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span><span class="p">]</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-198"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-198"><span class="linenos">198</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-199"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-199"><span class="linenos">199</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-200"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-200"><span class="linenos">200</span></a>                <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">]))</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-201"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-201"><span class="linenos">201</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-202"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-202"><span class="linenos">202</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-203"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-203"><span class="linenos">203</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">initial</span><span class="p">)</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-204"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-204"><span class="linenos">204</span></a>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-205"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-205"><span class="linenos">205</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">InlineLookupsStructure</span><span class="p">():</span>
</span><span id="FindODEInitialRHSVariablesVensimWalker.walk-206"><a href="#FindODEInitialRHSVariablesVensimWalker.walk-206"><span class="linenos">206</span></a>                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">lookups</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Find and return the RHS variable names of a given statement AST.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component_ast</strong> (AbstractSyntax):
AST entry point node</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>a list of strings of the variables</strong></li>
</ul>
</div>


                            </div>
                </section>
                <section id="GenericVensimStructureCallbackWalker">
                            <input id="GenericVensimStructureCallbackWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">GenericVensimStructureCallbackWalker</span><wbr>(<span class="base">abc.ABC</span>):

                <label class="view-source-button" for="GenericVensimStructureCallbackWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GenericVensimStructureCallbackWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GenericVensimStructureCallbackWalker-209"><a href="#GenericVensimStructureCallbackWalker-209"><span class="linenos">209</span></a><span class="nd">@dataclass</span>
</span><span id="GenericVensimStructureCallbackWalker-210"><a href="#GenericVensimStructureCallbackWalker-210"><span class="linenos">210</span></a><span class="k">class</span> <span class="nc">GenericVensimStructureCallbackWalker</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
</span><span id="GenericVensimStructureCallbackWalker-211"><a href="#GenericVensimStructureCallbackWalker-211"><span class="linenos">211</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GenericVensimStructureCallbackWalker-212"><a href="#GenericVensimStructureCallbackWalker-212"><span class="linenos">212</span></a><span class="sd">    This Vensim walker is a bit different from `BaseVensimWalker`. This family of callable classes implement the</span>
</span><span id="GenericVensimStructureCallbackWalker-213"><a href="#GenericVensimStructureCallbackWalker-213"><span class="linenos">213</span></a><span class="sd">    base behavior for walking and generating code for various components. Each subclass implements a single walk</span>
</span><span id="GenericVensimStructureCallbackWalker-214"><a href="#GenericVensimStructureCallbackWalker-214"><span class="linenos">214</span></a><span class="sd">    method for a single type of Vensim AST node. Instead of writing all the logic for handling different types of AST</span>
</span><span id="GenericVensimStructureCallbackWalker-215"><a href="#GenericVensimStructureCallbackWalker-215"><span class="linenos">215</span></a><span class="sd">    nodes in a single function/class which would then pose problems when you subclass walkers, you can you these</span>
</span><span id="GenericVensimStructureCallbackWalker-216"><a href="#GenericVensimStructureCallbackWalker-216"><span class="linenos">216</span></a><span class="sd">    modularized classes to reduce duplicate code.</span>
</span><span id="GenericVensimStructureCallbackWalker-217"><a href="#GenericVensimStructureCallbackWalker-217"><span class="linenos">217</span></a>
</span><span id="GenericVensimStructureCallbackWalker-218"><a href="#GenericVensimStructureCallbackWalker-218"><span class="linenos">218</span></a><span class="sd">    If the walker runs into one of the different AST node types, it will insteall call the `walk_callback` callable,</span>
</span><span id="GenericVensimStructureCallbackWalker-219"><a href="#GenericVensimStructureCallbackWalker-219"><span class="linenos">219</span></a><span class="sd">    which can implement or call another walker that can process it.</span>
</span><span id="GenericVensimStructureCallbackWalker-220"><a href="#GenericVensimStructureCallbackWalker-220"><span class="linenos">220</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="GenericVensimStructureCallbackWalker-221"><a href="#GenericVensimStructureCallbackWalker-221"><span class="linenos">221</span></a>    <span class="n">v2s_code_handler</span><span class="p">:</span> <span class="n">Vensim2StanCodeHandler</span>
</span><span id="GenericVensimStructureCallbackWalker-222"><a href="#GenericVensimStructureCallbackWalker-222"><span class="linenos">222</span></a>    <span class="n">vensim_model_context</span><span class="p">:</span> <span class="n">VensimModelContext</span>
</span><span id="GenericVensimStructureCallbackWalker-223"><a href="#GenericVensimStructureCallbackWalker-223"><span class="linenos">223</span></a>    <span class="n">stan_model_context</span><span class="p">:</span> <span class="n">StanModelContext</span>
</span><span id="GenericVensimStructureCallbackWalker-224"><a href="#GenericVensimStructureCallbackWalker-224"><span class="linenos">224</span></a>
</span><span id="GenericVensimStructureCallbackWalker-225"><a href="#GenericVensimStructureCallbackWalker-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="GenericVensimStructureCallbackWalker-226"><a href="#GenericVensimStructureCallbackWalker-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GenericVensimStructureCallbackWalker-227"><a href="#GenericVensimStructureCallbackWalker-227"><span class="linenos">227</span></a><span class="sd">        The family of `walk_X` functions, where `X` is a Vensim AST class, is intended to be used in Vensim AST walkers. Instead of</span>
</span><span id="GenericVensimStructureCallbackWalker-228"><a href="#GenericVensimStructureCallbackWalker-228"><span class="linenos">228</span></a><span class="sd">        writing all the logic for handling different types of AST nodes in a single function which would then pose</span>
</span><span id="GenericVensimStructureCallbackWalker-229"><a href="#GenericVensimStructureCallbackWalker-229"><span class="linenos">229</span></a><span class="sd">        problems when you subclass walkers, you can you these functions to reduce duplicate code.</span>
</span><span id="GenericVensimStructureCallbackWalker-230"><a href="#GenericVensimStructureCallbackWalker-230"><span class="linenos">230</span></a>
</span><span id="GenericVensimStructureCallbackWalker-231"><a href="#GenericVensimStructureCallbackWalker-231"><span class="linenos">231</span></a><span class="sd">        Parameters</span>
</span><span id="GenericVensimStructureCallbackWalker-232"><a href="#GenericVensimStructureCallbackWalker-232"><span class="linenos">232</span></a><span class="sd">        ----------</span>
</span><span id="GenericVensimStructureCallbackWalker-233"><a href="#GenericVensimStructureCallbackWalker-233"><span class="linenos">233</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="GenericVensimStructureCallbackWalker-234"><a href="#GenericVensimStructureCallbackWalker-234"><span class="linenos">234</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="GenericVensimStructureCallbackWalker-235"><a href="#GenericVensimStructureCallbackWalker-235"><span class="linenos">235</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="GenericVensimStructureCallbackWalker-236"><a href="#GenericVensimStructureCallbackWalker-236"><span class="linenos">236</span></a><span class="sd">            resume running its own code.</span>
</span><span id="GenericVensimStructureCallbackWalker-237"><a href="#GenericVensimStructureCallbackWalker-237"><span class="linenos">237</span></a><span class="sd">        component_ast : ArithmeticStructure</span>
</span><span id="GenericVensimStructureCallbackWalker-238"><a href="#GenericVensimStructureCallbackWalker-238"><span class="linenos">238</span></a><span class="sd">            An `ArithmeticStructure` object. The arguments are exactly the same as `BaseVensimWalker.walk()`</span>
</span><span id="GenericVensimStructureCallbackWalker-239"><a href="#GenericVensimStructureCallbackWalker-239"><span class="linenos">239</span></a><span class="sd">        node_name : str</span>
</span><span id="GenericVensimStructureCallbackWalker-240"><a href="#GenericVensimStructureCallbackWalker-240"><span class="linenos">240</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="GenericVensimStructureCallbackWalker-241"><a href="#GenericVensimStructureCallbackWalker-241"><span class="linenos">241</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="GenericVensimStructureCallbackWalker-242"><a href="#GenericVensimStructureCallbackWalker-242"><span class="linenos">242</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="GenericVensimStructureCallbackWalker-243"><a href="#GenericVensimStructureCallbackWalker-243"><span class="linenos">243</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="GenericVensimStructureCallbackWalker-244"><a href="#GenericVensimStructureCallbackWalker-244"><span class="linenos">244</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="GenericVensimStructureCallbackWalker-245"><a href="#GenericVensimStructureCallbackWalker-245"><span class="linenos">245</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="GenericVensimStructureCallbackWalker-246"><a href="#GenericVensimStructureCallbackWalker-246"><span class="linenos">246</span></a><span class="sd">        current_precedence : int</span>
</span><span id="GenericVensimStructureCallbackWalker-247"><a href="#GenericVensimStructureCallbackWalker-247"><span class="linenos">247</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="GenericVensimStructureCallbackWalker-248"><a href="#GenericVensimStructureCallbackWalker-248"><span class="linenos">248</span></a>
</span><span id="GenericVensimStructureCallbackWalker-249"><a href="#GenericVensimStructureCallbackWalker-249"><span class="linenos">249</span></a><span class="sd">        Returns</span>
</span><span id="GenericVensimStructureCallbackWalker-250"><a href="#GenericVensimStructureCallbackWalker-250"><span class="linenos">250</span></a><span class="sd">        -------</span>
</span><span id="GenericVensimStructureCallbackWalker-251"><a href="#GenericVensimStructureCallbackWalker-251"><span class="linenos">251</span></a><span class="sd">        A string of the generated code</span>
</span><span id="GenericVensimStructureCallbackWalker-252"><a href="#GenericVensimStructureCallbackWalker-252"><span class="linenos">252</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GenericVensimStructureCallbackWalker-253"><a href="#GenericVensimStructureCallbackWalker-253"><span class="linenos">253</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>This Vensim walker is a bit different from <code><a href="#BaseVensimWalker">BaseVensimWalker</a></code>. This family of callable classes implement the
base behavior for walking and generating code for various components. Each subclass implements a single walk
method for a single type of Vensim AST node. Instead of writing all the logic for handling different types of AST
nodes in a single function/class which would then pose problems when you subclass walkers, you can you these
modularized classes to reduce duplicate code.</p>

<p>If the walker runs into one of the different AST node types, it will insteall call the <code>walk_callback</code> callable,
which can implement or call another walker that can process it.</p>
</div>


                            <div id="GenericVensimStructureCallbackWalker.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">GenericVensimStructureCallbackWalker</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">v2s_code_handler</span><span class="p">:</span> <span class="n"><a href="v2s_model.html#Vensim2StanCodeHandler">stanify.builders.v2s_model.Vensim2StanCodeHandler</a></span>,</span><span class="param">	<span class="n">vensim_model_context</span><span class="p">:</span> <span class="n"><a href="vensim_model.html#VensimModelContext">stanify.builders.vensim_model.VensimModelContext</a></span>,</span><span class="param">	<span class="n">stan_model_context</span><span class="p">:</span> <span class="n"><a href="stan_model_context.html#StanModelContext">stanify.builders.stan_model_context.StanModelContext</a></span></span>)</span>

        
    </div>
    <a class="headerlink" href="#GenericVensimStructureCallbackWalker.__init__"></a>
    
    

                            </div>
                            <div id="GenericVensimStructureCallbackWalker.walk" class="classattr">
                                        <input id="GenericVensimStructureCallbackWalker.walk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">ArithmeticStructure</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="GenericVensimStructureCallbackWalker.walk-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#GenericVensimStructureCallbackWalker.walk"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="GenericVensimStructureCallbackWalker.walk-225"><a href="#GenericVensimStructureCallbackWalker.walk-225"><span class="linenos">225</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-226"><a href="#GenericVensimStructureCallbackWalker.walk-226"><span class="linenos">226</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-227"><a href="#GenericVensimStructureCallbackWalker.walk-227"><span class="linenos">227</span></a><span class="sd">        The family of `walk_X` functions, where `X` is a Vensim AST class, is intended to be used in Vensim AST walkers. Instead of</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-228"><a href="#GenericVensimStructureCallbackWalker.walk-228"><span class="linenos">228</span></a><span class="sd">        writing all the logic for handling different types of AST nodes in a single function which would then pose</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-229"><a href="#GenericVensimStructureCallbackWalker.walk-229"><span class="linenos">229</span></a><span class="sd">        problems when you subclass walkers, you can you these functions to reduce duplicate code.</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-230"><a href="#GenericVensimStructureCallbackWalker.walk-230"><span class="linenos">230</span></a>
</span><span id="GenericVensimStructureCallbackWalker.walk-231"><a href="#GenericVensimStructureCallbackWalker.walk-231"><span class="linenos">231</span></a><span class="sd">        Parameters</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-232"><a href="#GenericVensimStructureCallbackWalker.walk-232"><span class="linenos">232</span></a><span class="sd">        ----------</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-233"><a href="#GenericVensimStructureCallbackWalker.walk-233"><span class="linenos">233</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-234"><a href="#GenericVensimStructureCallbackWalker.walk-234"><span class="linenos">234</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-235"><a href="#GenericVensimStructureCallbackWalker.walk-235"><span class="linenos">235</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-236"><a href="#GenericVensimStructureCallbackWalker.walk-236"><span class="linenos">236</span></a><span class="sd">            resume running its own code.</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-237"><a href="#GenericVensimStructureCallbackWalker.walk-237"><span class="linenos">237</span></a><span class="sd">        component_ast : ArithmeticStructure</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-238"><a href="#GenericVensimStructureCallbackWalker.walk-238"><span class="linenos">238</span></a><span class="sd">            An `ArithmeticStructure` object. The arguments are exactly the same as `BaseVensimWalker.walk()`</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-239"><a href="#GenericVensimStructureCallbackWalker.walk-239"><span class="linenos">239</span></a><span class="sd">        node_name : str</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-240"><a href="#GenericVensimStructureCallbackWalker.walk-240"><span class="linenos">240</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-241"><a href="#GenericVensimStructureCallbackWalker.walk-241"><span class="linenos">241</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-242"><a href="#GenericVensimStructureCallbackWalker.walk-242"><span class="linenos">242</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-243"><a href="#GenericVensimStructureCallbackWalker.walk-243"><span class="linenos">243</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-244"><a href="#GenericVensimStructureCallbackWalker.walk-244"><span class="linenos">244</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-245"><a href="#GenericVensimStructureCallbackWalker.walk-245"><span class="linenos">245</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-246"><a href="#GenericVensimStructureCallbackWalker.walk-246"><span class="linenos">246</span></a><span class="sd">        current_precedence : int</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-247"><a href="#GenericVensimStructureCallbackWalker.walk-247"><span class="linenos">247</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-248"><a href="#GenericVensimStructureCallbackWalker.walk-248"><span class="linenos">248</span></a>
</span><span id="GenericVensimStructureCallbackWalker.walk-249"><a href="#GenericVensimStructureCallbackWalker.walk-249"><span class="linenos">249</span></a><span class="sd">        Returns</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-250"><a href="#GenericVensimStructureCallbackWalker.walk-250"><span class="linenos">250</span></a><span class="sd">        -------</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-251"><a href="#GenericVensimStructureCallbackWalker.walk-251"><span class="linenos">251</span></a><span class="sd">        A string of the generated code</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-252"><a href="#GenericVensimStructureCallbackWalker.walk-252"><span class="linenos">252</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="GenericVensimStructureCallbackWalker.walk-253"><a href="#GenericVensimStructureCallbackWalker.walk-253"><span class="linenos">253</span></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>The family of <code>walk_X</code> functions, where <code>X</code> is a Vensim AST class, is intended to be used in Vensim AST walkers. Instead of
writing all the logic for handling different types of AST nodes in a single function which would then pose
problems when you subclass walkers, you can you these functions to reduce duplicate code.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>walk_callback</strong> (Callable):
This is the function that will be called with a <code><a href="#GenericVensimStructureCallbackWalker.walk">walk()</a></code> function needs to be called. Normally this would be
the caller of this function. This way, the original caller retains the execution trace and is allowed to
resume running its own code.</li>
<li><strong>component_ast</strong> (ArithmeticStructure):
An <code>ArithmeticStructure</code> object. The arguments are exactly the same as <code><a href="#BaseVensimWalker.walk">BaseVensimWalker.walk()</a></code></li>
<li><strong>node_name</strong> (str):
Name of the Vensim element(variable name)</li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be
<code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Current precedence level of the AST. Only relevant for ArithmeticStructure.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>A string of the generated code</strong></li>
</ul>
</div>


                            </div>
                </section>
                <section id="VensimArithmeticStructureCallbackWalker">
                            <input id="VensimArithmeticStructureCallbackWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">VensimArithmeticStructureCallbackWalker</span><wbr>(<span class="base"><a href="#GenericVensimStructureCallbackWalker">GenericVensimStructureCallbackWalker</a></span>):

                <label class="view-source-button" for="VensimArithmeticStructureCallbackWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VensimArithmeticStructureCallbackWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VensimArithmeticStructureCallbackWalker-256"><a href="#VensimArithmeticStructureCallbackWalker-256"><span class="linenos">256</span></a><span class="k">class</span> <span class="nc">VensimArithmeticStructureCallbackWalker</span><span class="p">(</span><span class="n">GenericVensimStructureCallbackWalker</span><span class="p">):</span>
</span><span id="VensimArithmeticStructureCallbackWalker-257"><a href="#VensimArithmeticStructureCallbackWalker-257"><span class="linenos">257</span></a>    <span class="k">def</span> <span class="nf">walk_ArithmeticStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker-258"><a href="#VensimArithmeticStructureCallbackWalker-258"><span class="linenos">258</span></a>                                 <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-259"><a href="#VensimArithmeticStructureCallbackWalker-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker-260"><a href="#VensimArithmeticStructureCallbackWalker-260"><span class="linenos">260</span></a><span class="sd">        The family of `walk_X` functions, where `X` is a Vensim AST class, is intended to be used in Vensim AST walkers. Instead of</span>
</span><span id="VensimArithmeticStructureCallbackWalker-261"><a href="#VensimArithmeticStructureCallbackWalker-261"><span class="linenos">261</span></a><span class="sd">        writing all the logic for handling different types of AST nodes in a single function which would then pose</span>
</span><span id="VensimArithmeticStructureCallbackWalker-262"><a href="#VensimArithmeticStructureCallbackWalker-262"><span class="linenos">262</span></a><span class="sd">        problems when you subclass walkers, you can you these functions to reduce duplicate code.</span>
</span><span id="VensimArithmeticStructureCallbackWalker-263"><a href="#VensimArithmeticStructureCallbackWalker-263"><span class="linenos">263</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-264"><a href="#VensimArithmeticStructureCallbackWalker-264"><span class="linenos">264</span></a><span class="sd">        Parameters</span>
</span><span id="VensimArithmeticStructureCallbackWalker-265"><a href="#VensimArithmeticStructureCallbackWalker-265"><span class="linenos">265</span></a><span class="sd">        ----------</span>
</span><span id="VensimArithmeticStructureCallbackWalker-266"><a href="#VensimArithmeticStructureCallbackWalker-266"><span class="linenos">266</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="VensimArithmeticStructureCallbackWalker-267"><a href="#VensimArithmeticStructureCallbackWalker-267"><span class="linenos">267</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="VensimArithmeticStructureCallbackWalker-268"><a href="#VensimArithmeticStructureCallbackWalker-268"><span class="linenos">268</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="VensimArithmeticStructureCallbackWalker-269"><a href="#VensimArithmeticStructureCallbackWalker-269"><span class="linenos">269</span></a><span class="sd">            resume running its own code.</span>
</span><span id="VensimArithmeticStructureCallbackWalker-270"><a href="#VensimArithmeticStructureCallbackWalker-270"><span class="linenos">270</span></a><span class="sd">        component_ast : ArithmeticStructure</span>
</span><span id="VensimArithmeticStructureCallbackWalker-271"><a href="#VensimArithmeticStructureCallbackWalker-271"><span class="linenos">271</span></a><span class="sd">            An `ArithmeticStructure` object. The arguments are exactly the same as `BaseVensimWalker.walk()`</span>
</span><span id="VensimArithmeticStructureCallbackWalker-272"><a href="#VensimArithmeticStructureCallbackWalker-272"><span class="linenos">272</span></a><span class="sd">        node_name : str</span>
</span><span id="VensimArithmeticStructureCallbackWalker-273"><a href="#VensimArithmeticStructureCallbackWalker-273"><span class="linenos">273</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="VensimArithmeticStructureCallbackWalker-274"><a href="#VensimArithmeticStructureCallbackWalker-274"><span class="linenos">274</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="VensimArithmeticStructureCallbackWalker-275"><a href="#VensimArithmeticStructureCallbackWalker-275"><span class="linenos">275</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="VensimArithmeticStructureCallbackWalker-276"><a href="#VensimArithmeticStructureCallbackWalker-276"><span class="linenos">276</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="VensimArithmeticStructureCallbackWalker-277"><a href="#VensimArithmeticStructureCallbackWalker-277"><span class="linenos">277</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="VensimArithmeticStructureCallbackWalker-278"><a href="#VensimArithmeticStructureCallbackWalker-278"><span class="linenos">278</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="VensimArithmeticStructureCallbackWalker-279"><a href="#VensimArithmeticStructureCallbackWalker-279"><span class="linenos">279</span></a><span class="sd">        current_precedence : int</span>
</span><span id="VensimArithmeticStructureCallbackWalker-280"><a href="#VensimArithmeticStructureCallbackWalker-280"><span class="linenos">280</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="VensimArithmeticStructureCallbackWalker-281"><a href="#VensimArithmeticStructureCallbackWalker-281"><span class="linenos">281</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-282"><a href="#VensimArithmeticStructureCallbackWalker-282"><span class="linenos">282</span></a><span class="sd">        Returns</span>
</span><span id="VensimArithmeticStructureCallbackWalker-283"><a href="#VensimArithmeticStructureCallbackWalker-283"><span class="linenos">283</span></a><span class="sd">        -------</span>
</span><span id="VensimArithmeticStructureCallbackWalker-284"><a href="#VensimArithmeticStructureCallbackWalker-284"><span class="linenos">284</span></a><span class="sd">        A string of the generated code</span>
</span><span id="VensimArithmeticStructureCallbackWalker-285"><a href="#VensimArithmeticStructureCallbackWalker-285"><span class="linenos">285</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker-286"><a href="#VensimArithmeticStructureCallbackWalker-286"><span class="linenos">286</span></a>        <span class="n">operator_precedence</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># lower comes first</span>
</span><span id="VensimArithmeticStructureCallbackWalker-287"><a href="#VensimArithmeticStructureCallbackWalker-287"><span class="linenos">287</span></a>            <span class="s2">&quot;+&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker-288"><a href="#VensimArithmeticStructureCallbackWalker-288"><span class="linenos">288</span></a>            <span class="s2">&quot;-&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker-289"><a href="#VensimArithmeticStructureCallbackWalker-289"><span class="linenos">289</span></a>            <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker-290"><a href="#VensimArithmeticStructureCallbackWalker-290"><span class="linenos">290</span></a>            <span class="s2">&quot;/&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker-291"><a href="#VensimArithmeticStructureCallbackWalker-291"><span class="linenos">291</span></a>            <span class="s2">&quot;^&quot;</span><span class="p">:</span> <span class="mi">1</span>
</span><span id="VensimArithmeticStructureCallbackWalker-292"><a href="#VensimArithmeticStructureCallbackWalker-292"><span class="linenos">292</span></a>        <span class="p">}</span>
</span><span id="VensimArithmeticStructureCallbackWalker-293"><a href="#VensimArithmeticStructureCallbackWalker-293"><span class="linenos">293</span></a>        <span class="c1"># ArithmeticStructure consists of chained arithmetic expressions.</span>
</span><span id="VensimArithmeticStructureCallbackWalker-294"><a href="#VensimArithmeticStructureCallbackWalker-294"><span class="linenos">294</span></a>        <span class="c1"># We parse them one by one into a single expression</span>
</span><span id="VensimArithmeticStructureCallbackWalker-295"><a href="#VensimArithmeticStructureCallbackWalker-295"><span class="linenos">295</span></a>        <span class="c1"># Assume ArithmeticStructure.operators are in order of precedence(lower comes first)</span>
</span><span id="VensimArithmeticStructureCallbackWalker-296"><a href="#VensimArithmeticStructureCallbackWalker-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker-297"><a href="#VensimArithmeticStructureCallbackWalker-297"><span class="linenos">297</span></a><span class="sd">        Suppose we have:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-298"><a href="#VensimArithmeticStructureCallbackWalker-298"><span class="linenos">298</span></a><span class="sd">        A = 1 + 1; B = A * 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker-299"><a href="#VensimArithmeticStructureCallbackWalker-299"><span class="linenos">299</span></a><span class="sd">        Naively substituting in A will result in:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-300"><a href="#VensimArithmeticStructureCallbackWalker-300"><span class="linenos">300</span></a><span class="sd">        1 + 1 * 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker-301"><a href="#VensimArithmeticStructureCallbackWalker-301"><span class="linenos">301</span></a><span class="sd">        which is not correct, and instead should be:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-302"><a href="#VensimArithmeticStructureCallbackWalker-302"><span class="linenos">302</span></a><span class="sd">        (1 + 1) * 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker-303"><a href="#VensimArithmeticStructureCallbackWalker-303"><span class="linenos">303</span></a><span class="sd">        Assume we have the following AST:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-304"><a href="#VensimArithmeticStructureCallbackWalker-304"><span class="linenos">304</span></a><span class="sd">              *  # precedence level 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker-305"><a href="#VensimArithmeticStructureCallbackWalker-305"><span class="linenos">305</span></a><span class="sd">              /\</span>
</span><span id="VensimArithmeticStructureCallbackWalker-306"><a href="#VensimArithmeticStructureCallbackWalker-306"><span class="linenos">306</span></a><span class="sd">             /  2</span>
</span><span id="VensimArithmeticStructureCallbackWalker-307"><a href="#VensimArithmeticStructureCallbackWalker-307"><span class="linenos">307</span></a><span class="sd">            +  # precedence level 3</span>
</span><span id="VensimArithmeticStructureCallbackWalker-308"><a href="#VensimArithmeticStructureCallbackWalker-308"><span class="linenos">308</span></a><span class="sd">            /\</span>
</span><span id="VensimArithmeticStructureCallbackWalker-309"><a href="#VensimArithmeticStructureCallbackWalker-309"><span class="linenos">309</span></a><span class="sd">           1  1</span>
</span><span id="VensimArithmeticStructureCallbackWalker-310"><a href="#VensimArithmeticStructureCallbackWalker-310"><span class="linenos">310</span></a><span class="sd">        We check if the operators of the subtrees of &#39;*&#39; have a precedence level higher than its parent, and</span>
</span><span id="VensimArithmeticStructureCallbackWalker-311"><a href="#VensimArithmeticStructureCallbackWalker-311"><span class="linenos">311</span></a><span class="sd">        enclose them in parentheses if so.</span>
</span><span id="VensimArithmeticStructureCallbackWalker-312"><a href="#VensimArithmeticStructureCallbackWalker-312"><span class="linenos">312</span></a><span class="sd">               *  # precedence level 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker-313"><a href="#VensimArithmeticStructureCallbackWalker-313"><span class="linenos">313</span></a><span class="sd">              /\</span>
</span><span id="VensimArithmeticStructureCallbackWalker-314"><a href="#VensimArithmeticStructureCallbackWalker-314"><span class="linenos">314</span></a><span class="sd">             /  2</span>
</span><span id="VensimArithmeticStructureCallbackWalker-315"><a href="#VensimArithmeticStructureCallbackWalker-315"><span class="linenos">315</span></a><span class="sd">            +  # precedence level 3</span>
</span><span id="VensimArithmeticStructureCallbackWalker-316"><a href="#VensimArithmeticStructureCallbackWalker-316"><span class="linenos">316</span></a><span class="sd">            /\</span>
</span><span id="VensimArithmeticStructureCallbackWalker-317"><a href="#VensimArithmeticStructureCallbackWalker-317"><span class="linenos">317</span></a><span class="sd">           1  b (b is treated as reference structure)</span>
</span><span id="VensimArithmeticStructureCallbackWalker-318"><a href="#VensimArithmeticStructureCallbackWalker-318"><span class="linenos">318</span></a><span class="sd">    </span>
</span><span id="VensimArithmeticStructureCallbackWalker-319"><a href="#VensimArithmeticStructureCallbackWalker-319"><span class="linenos">319</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker-320"><a href="#VensimArithmeticStructureCallbackWalker-320"><span class="linenos">320</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-321"><a href="#VensimArithmeticStructureCallbackWalker-321"><span class="linenos">321</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker-322"><a href="#VensimArithmeticStructureCallbackWalker-322"><span class="linenos">322</span></a>        <span class="n">last_argument_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="VensimArithmeticStructureCallbackWalker-323"><a href="#VensimArithmeticStructureCallbackWalker-323"><span class="linenos">323</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-324"><a href="#VensimArithmeticStructureCallbackWalker-324"><span class="linenos">324</span></a>        <span class="c1"># Find the maximum precedence value of the operators</span>
</span><span id="VensimArithmeticStructureCallbackWalker-325"><a href="#VensimArithmeticStructureCallbackWalker-325"><span class="linenos">325</span></a>        <span class="n">max_precedence</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">operator_precedence</span><span class="p">[</span><span class="n">op</span><span class="p">]</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">])</span>
</span><span id="VensimArithmeticStructureCallbackWalker-326"><a href="#VensimArithmeticStructureCallbackWalker-326"><span class="linenos">326</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-327"><a href="#VensimArithmeticStructureCallbackWalker-327"><span class="linenos">327</span></a>        <span class="k">if</span> <span class="n">max_precedence</span> <span class="o">&gt;=</span> <span class="n">current_precedence</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-328"><a href="#VensimArithmeticStructureCallbackWalker-328"><span class="linenos">328</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot;(&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker-329"><a href="#VensimArithmeticStructureCallbackWalker-329"><span class="linenos">329</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-330"><a href="#VensimArithmeticStructureCallbackWalker-330"><span class="linenos">330</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">argument</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">):</span>
</span><span id="VensimArithmeticStructureCallbackWalker-331"><a href="#VensimArithmeticStructureCallbackWalker-331"><span class="linenos">331</span></a>            <span class="c1"># Find the operators which set the precedence level of its children</span>
</span><span id="VensimArithmeticStructureCallbackWalker-332"><a href="#VensimArithmeticStructureCallbackWalker-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-333"><a href="#VensimArithmeticStructureCallbackWalker-333"><span class="linenos">333</span></a>                <span class="n">operators_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="VensimArithmeticStructureCallbackWalker-334"><a href="#VensimArithmeticStructureCallbackWalker-334"><span class="linenos">334</span></a>            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="n">last_argument_index</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-335"><a href="#VensimArithmeticStructureCallbackWalker-335"><span class="linenos">335</span></a>                <span class="n">operators_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="VensimArithmeticStructureCallbackWalker-336"><a href="#VensimArithmeticStructureCallbackWalker-336"><span class="linenos">336</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-337"><a href="#VensimArithmeticStructureCallbackWalker-337"><span class="linenos">337</span></a>                <span class="n">operators_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span>
</span><span id="VensimArithmeticStructureCallbackWalker-338"><a href="#VensimArithmeticStructureCallbackWalker-338"><span class="linenos">338</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-339"><a href="#VensimArithmeticStructureCallbackWalker-339"><span class="linenos">339</span></a>            <span class="c1"># Pass the minimum precedence level</span>
</span><span id="VensimArithmeticStructureCallbackWalker-340"><a href="#VensimArithmeticStructureCallbackWalker-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">):</span>
</span><span id="VensimArithmeticStructureCallbackWalker-341"><a href="#VensimArithmeticStructureCallbackWalker-341"><span class="linenos">341</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscripts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="VensimArithmeticStructureCallbackWalker-342"><a href="#VensimArithmeticStructureCallbackWalker-342"><span class="linenos">342</span></a>                    <span class="n">arg_subscripts</span> <span class="o">=</span> <span class="n">get_subscripts_ReferenceStructure</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</span><span id="VensimArithmeticStructureCallbackWalker-343"><a href="#VensimArithmeticStructureCallbackWalker-343"><span class="linenos">343</span></a>                    <span class="n">subscripts</span> <span class="o">=</span> <span class="p">{</span><span class="n">subscript</span><span class="p">:</span> <span class="n">subscripts</span><span class="p">[</span><span class="n">subscript</span><span class="p">]</span> <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">arg_subscripts</span><span class="p">}</span>
</span><span id="VensimArithmeticStructureCallbackWalker-344"><a href="#VensimArithmeticStructureCallbackWalker-344"><span class="linenos">344</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-345"><a href="#VensimArithmeticStructureCallbackWalker-345"><span class="linenos">345</span></a>                    <span class="n">subscripts</span> <span class="o">=</span> <span class="n">get_subscripts_ReferenceStructure</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</span><span id="VensimArithmeticStructureCallbackWalker-346"><a href="#VensimArithmeticStructureCallbackWalker-346"><span class="linenos">346</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-347"><a href="#VensimArithmeticStructureCallbackWalker-347"><span class="linenos">347</span></a>            <span class="n">operand_text</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="nb">min</span><span class="p">([</span><span class="n">operator_precedence</span><span class="p">[</span><span class="n">op</span><span class="p">]</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">operators_to_check</span><span class="p">]))</span>
</span><span id="VensimArithmeticStructureCallbackWalker-348"><a href="#VensimArithmeticStructureCallbackWalker-348"><span class="linenos">348</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-349"><a href="#VensimArithmeticStructureCallbackWalker-349"><span class="linenos">349</span></a>            <span class="c1"># If one of the operators is division, and the operand is an integer, convert the integer to a float string representation</span>
</span><span id="VensimArithmeticStructureCallbackWalker-350"><a href="#VensimArithmeticStructureCallbackWalker-350"><span class="linenos">350</span></a>            <span class="k">if</span> <span class="n">operand_text</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
</span><span id="VensimArithmeticStructureCallbackWalker-351"><a href="#VensimArithmeticStructureCallbackWalker-351"><span class="linenos">351</span></a>                <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">operators_to_check</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-352"><a href="#VensimArithmeticStructureCallbackWalker-352"><span class="linenos">352</span></a>                    <span class="n">operand_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">operand_text</span><span class="p">))</span>
</span><span id="VensimArithmeticStructureCallbackWalker-353"><a href="#VensimArithmeticStructureCallbackWalker-353"><span class="linenos">353</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-354"><a href="#VensimArithmeticStructureCallbackWalker-354"><span class="linenos">354</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="n">operand_text</span>
</span><span id="VensimArithmeticStructureCallbackWalker-355"><a href="#VensimArithmeticStructureCallbackWalker-355"><span class="linenos">355</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-356"><a href="#VensimArithmeticStructureCallbackWalker-356"><span class="linenos">356</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">last_argument_index</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-357"><a href="#VensimArithmeticStructureCallbackWalker-357"><span class="linenos">357</span></a>                <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker-358"><a href="#VensimArithmeticStructureCallbackWalker-358"><span class="linenos">358</span></a>                <span class="n">output_string</span> <span class="o">+=</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="VensimArithmeticStructureCallbackWalker-359"><a href="#VensimArithmeticStructureCallbackWalker-359"><span class="linenos">359</span></a>                <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker-360"><a href="#VensimArithmeticStructureCallbackWalker-360"><span class="linenos">360</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker-361"><a href="#VensimArithmeticStructureCallbackWalker-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="n">max_precedence</span> <span class="o">&gt;=</span> <span class="n">current_precedence</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker-362"><a href="#VensimArithmeticStructureCallbackWalker-362"><span class="linenos">362</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker-363"><a href="#VensimArithmeticStructureCallbackWalker-363"><span class="linenos">363</span></a>        <span class="k">return</span> <span class="n">output_string</span>
</span></pre></div>


            <div class="docstring"><p>This Vensim walker is a bit different from <code><a href="#BaseVensimWalker">BaseVensimWalker</a></code>. This family of callable classes implement the
base behavior for walking and generating code for various components. Each subclass implements a single walk
method for a single type of Vensim AST node. Instead of writing all the logic for handling different types of AST
nodes in a single function/class which would then pose problems when you subclass walkers, you can you these
modularized classes to reduce duplicate code.</p>

<p>If the walker runs into one of the different AST node types, it will insteall call the <code>walk_callback</code> callable,
which can implement or call another walker that can process it.</p>
</div>


                            <div id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure" class="classattr">
                                        <input id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk_ArithmeticStructure</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">ArithmeticStructure</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-257"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-257"><span class="linenos">257</span></a>    <span class="k">def</span> <span class="nf">walk_ArithmeticStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-258"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-258"><span class="linenos">258</span></a>                                 <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-259"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-259"><span class="linenos">259</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-260"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-260"><span class="linenos">260</span></a><span class="sd">        The family of `walk_X` functions, where `X` is a Vensim AST class, is intended to be used in Vensim AST walkers. Instead of</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-261"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-261"><span class="linenos">261</span></a><span class="sd">        writing all the logic for handling different types of AST nodes in a single function which would then pose</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-262"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-262"><span class="linenos">262</span></a><span class="sd">        problems when you subclass walkers, you can you these functions to reduce duplicate code.</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-263"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-263"><span class="linenos">263</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-264"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-264"><span class="linenos">264</span></a><span class="sd">        Parameters</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-265"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-265"><span class="linenos">265</span></a><span class="sd">        ----------</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-266"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-266"><span class="linenos">266</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-267"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-267"><span class="linenos">267</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-268"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-268"><span class="linenos">268</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-269"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-269"><span class="linenos">269</span></a><span class="sd">            resume running its own code.</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-270"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-270"><span class="linenos">270</span></a><span class="sd">        component_ast : ArithmeticStructure</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-271"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-271"><span class="linenos">271</span></a><span class="sd">            An `ArithmeticStructure` object. The arguments are exactly the same as `BaseVensimWalker.walk()`</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-272"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-272"><span class="linenos">272</span></a><span class="sd">        node_name : str</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-273"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-273"><span class="linenos">273</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-274"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-274"><span class="linenos">274</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-275"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-275"><span class="linenos">275</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-276"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-276"><span class="linenos">276</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-277"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-277"><span class="linenos">277</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-278"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-278"><span class="linenos">278</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-279"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-279"><span class="linenos">279</span></a><span class="sd">        current_precedence : int</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-280"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-280"><span class="linenos">280</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-281"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-281"><span class="linenos">281</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-282"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-282"><span class="linenos">282</span></a><span class="sd">        Returns</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-283"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-283"><span class="linenos">283</span></a><span class="sd">        -------</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-284"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-284"><span class="linenos">284</span></a><span class="sd">        A string of the generated code</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-285"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-285"><span class="linenos">285</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-286"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-286"><span class="linenos">286</span></a>        <span class="n">operator_precedence</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1"># lower comes first</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-287"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-287"><span class="linenos">287</span></a>            <span class="s2">&quot;+&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-288"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-288"><span class="linenos">288</span></a>            <span class="s2">&quot;-&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-289"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-289"><span class="linenos">289</span></a>            <span class="s2">&quot;*&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-290"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-290"><span class="linenos">290</span></a>            <span class="s2">&quot;/&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-291"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-291"><span class="linenos">291</span></a>            <span class="s2">&quot;^&quot;</span><span class="p">:</span> <span class="mi">1</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-292"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-292"><span class="linenos">292</span></a>        <span class="p">}</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-293"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-293"><span class="linenos">293</span></a>        <span class="c1"># ArithmeticStructure consists of chained arithmetic expressions.</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-294"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-294"><span class="linenos">294</span></a>        <span class="c1"># We parse them one by one into a single expression</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-295"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-295"><span class="linenos">295</span></a>        <span class="c1"># Assume ArithmeticStructure.operators are in order of precedence(lower comes first)</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-296"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-296"><span class="linenos">296</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-297"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-297"><span class="linenos">297</span></a><span class="sd">        Suppose we have:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-298"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-298"><span class="linenos">298</span></a><span class="sd">        A = 1 + 1; B = A * 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-299"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-299"><span class="linenos">299</span></a><span class="sd">        Naively substituting in A will result in:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-300"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-300"><span class="linenos">300</span></a><span class="sd">        1 + 1 * 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-301"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-301"><span class="linenos">301</span></a><span class="sd">        which is not correct, and instead should be:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-302"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-302"><span class="linenos">302</span></a><span class="sd">        (1 + 1) * 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-303"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-303"><span class="linenos">303</span></a><span class="sd">        Assume we have the following AST:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-304"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-304"><span class="linenos">304</span></a><span class="sd">              *  # precedence level 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-305"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-305"><span class="linenos">305</span></a><span class="sd">              /\</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-306"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-306"><span class="linenos">306</span></a><span class="sd">             /  2</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-307"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-307"><span class="linenos">307</span></a><span class="sd">            +  # precedence level 3</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-308"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-308"><span class="linenos">308</span></a><span class="sd">            /\</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-309"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-309"><span class="linenos">309</span></a><span class="sd">           1  1</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-310"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-310"><span class="linenos">310</span></a><span class="sd">        We check if the operators of the subtrees of &#39;*&#39; have a precedence level higher than its parent, and</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-311"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-311"><span class="linenos">311</span></a><span class="sd">        enclose them in parentheses if so.</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-312"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-312"><span class="linenos">312</span></a><span class="sd">               *  # precedence level 2</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-313"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-313"><span class="linenos">313</span></a><span class="sd">              /\</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-314"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-314"><span class="linenos">314</span></a><span class="sd">             /  2</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-315"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-315"><span class="linenos">315</span></a><span class="sd">            +  # precedence level 3</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-316"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-316"><span class="linenos">316</span></a><span class="sd">            /\</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-317"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-317"><span class="linenos">317</span></a><span class="sd">           1  b (b is treated as reference structure)</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-318"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-318"><span class="linenos">318</span></a><span class="sd">    </span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-319"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-319"><span class="linenos">319</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-320"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-320"><span class="linenos">320</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-321"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-321"><span class="linenos">321</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-322"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-322"><span class="linenos">322</span></a>        <span class="n">last_argument_index</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-323"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-323"><span class="linenos">323</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-324"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-324"><span class="linenos">324</span></a>        <span class="c1"># Find the maximum precedence value of the operators</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-325"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-325"><span class="linenos">325</span></a>        <span class="n">max_precedence</span> <span class="o">=</span> <span class="nb">max</span><span class="p">([</span><span class="n">operator_precedence</span><span class="p">[</span><span class="n">op</span><span class="p">]</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">])</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-326"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-326"><span class="linenos">326</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-327"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-327"><span class="linenos">327</span></a>        <span class="k">if</span> <span class="n">max_precedence</span> <span class="o">&gt;=</span> <span class="n">current_precedence</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-328"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-328"><span class="linenos">328</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot;(&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-329"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-329"><span class="linenos">329</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-330"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-330"><span class="linenos">330</span></a>        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">argument</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">):</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-331"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-331"><span class="linenos">331</span></a>            <span class="c1"># Find the operators which set the precedence level of its children</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-332"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-332"><span class="linenos">332</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-333"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-333"><span class="linenos">333</span></a>                <span class="n">operators_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-334"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-334"><span class="linenos">334</span></a>            <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="n">last_argument_index</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-335"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-335"><span class="linenos">335</span></a>                <span class="n">operators_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-336"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-336"><span class="linenos">336</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-337"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-337"><span class="linenos">337</span></a>                <span class="n">operators_to_check</span> <span class="o">=</span> <span class="p">[</span><span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">],</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="n">index</span><span class="p">]]</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-338"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-338"><span class="linenos">338</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-339"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-339"><span class="linenos">339</span></a>            <span class="c1"># Pass the minimum precedence level</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-340"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-340"><span class="linenos">340</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">):</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-341"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-341"><span class="linenos">341</span></a>                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscripts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-342"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-342"><span class="linenos">342</span></a>                    <span class="n">arg_subscripts</span> <span class="o">=</span> <span class="n">get_subscripts_ReferenceStructure</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-343"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-343"><span class="linenos">343</span></a>                    <span class="n">subscripts</span> <span class="o">=</span> <span class="p">{</span><span class="n">subscript</span><span class="p">:</span> <span class="n">subscripts</span><span class="p">[</span><span class="n">subscript</span><span class="p">]</span> <span class="k">for</span> <span class="n">subscript</span> <span class="ow">in</span> <span class="n">arg_subscripts</span><span class="p">}</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-344"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-344"><span class="linenos">344</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-345"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-345"><span class="linenos">345</span></a>                    <span class="n">subscripts</span> <span class="o">=</span> <span class="n">get_subscripts_ReferenceStructure</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-346"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-346"><span class="linenos">346</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-347"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-347"><span class="linenos">347</span></a>            <span class="n">operand_text</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="nb">min</span><span class="p">([</span><span class="n">operator_precedence</span><span class="p">[</span><span class="n">op</span><span class="p">]</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">operators_to_check</span><span class="p">]))</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-348"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-348"><span class="linenos">348</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-349"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-349"><span class="linenos">349</span></a>            <span class="c1"># If one of the operators is division, and the operand is an integer, convert the integer to a float string representation</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-350"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-350"><span class="linenos">350</span></a>            <span class="k">if</span> <span class="n">operand_text</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-351"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-351"><span class="linenos">351</span></a>                <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">operators_to_check</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-352"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-352"><span class="linenos">352</span></a>                    <span class="n">operand_text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">operand_text</span><span class="p">))</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-353"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-353"><span class="linenos">353</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-354"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-354"><span class="linenos">354</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="n">operand_text</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-355"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-355"><span class="linenos">355</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-356"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-356"><span class="linenos">356</span></a>            <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="n">last_argument_index</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-357"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-357"><span class="linenos">357</span></a>                <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-358"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-358"><span class="linenos">358</span></a>                <span class="n">output_string</span> <span class="o">+=</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">operators</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-359"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-359"><span class="linenos">359</span></a>                <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot; &quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-360"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-360"><span class="linenos">360</span></a>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-361"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-361"><span class="linenos">361</span></a>        <span class="k">if</span> <span class="n">max_precedence</span> <span class="o">&gt;=</span> <span class="n">current_precedence</span><span class="p">:</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-362"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-362"><span class="linenos">362</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot;)&quot;</span>
</span><span id="VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-363"><a href="#VensimArithmeticStructureCallbackWalker.walk_ArithmeticStructure-363"><span class="linenos">363</span></a>        <span class="k">return</span> <span class="n">output_string</span>
</span></pre></div>


            <div class="docstring"><p>The family of <code>walk_X</code> functions, where <code>X</code> is a Vensim AST class, is intended to be used in Vensim AST walkers. Instead of
writing all the logic for handling different types of AST nodes in a single function which would then pose
problems when you subclass walkers, you can you these functions to reduce duplicate code.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>walk_callback</strong> (Callable):
This is the function that will be called with a <code><a href="#VensimArithmeticStructureCallbackWalker.walk">walk()</a></code> function needs to be called. Normally this would be
the caller of this function. This way, the original caller retains the execution trace and is allowed to
resume running its own code.</li>
<li><strong>component_ast</strong> (ArithmeticStructure):
An <code>ArithmeticStructure</code> object. The arguments are exactly the same as <code><a href="#BaseVensimWalker.walk">BaseVensimWalker.walk()</a></code></li>
<li><strong>node_name</strong> (str):
Name of the Vensim element(variable name)</li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be
<code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Current precedence level of the AST. Only relevant for ArithmeticStructure.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>A string of the generated code</strong></li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#GenericVensimStructureCallbackWalker">GenericVensimStructureCallbackWalker</a></dt>
                                <dd id="VensimArithmeticStructureCallbackWalker.__init__" class="function"><a href="#GenericVensimStructureCallbackWalker.__init__">GenericVensimStructureCallbackWalker</a></dd>
                <dd id="VensimArithmeticStructureCallbackWalker.walk" class="function"><a href="#GenericVensimStructureCallbackWalker.walk">walk</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="VensimReferenceStructureCallbackWalker">
                            <input id="VensimReferenceStructureCallbackWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">VensimReferenceStructureCallbackWalker</span><wbr>(<span class="base"><a href="#GenericVensimStructureCallbackWalker">GenericVensimStructureCallbackWalker</a></span>):

                <label class="view-source-button" for="VensimReferenceStructureCallbackWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VensimReferenceStructureCallbackWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VensimReferenceStructureCallbackWalker-366"><a href="#VensimReferenceStructureCallbackWalker-366"><span class="linenos">366</span></a><span class="k">class</span> <span class="nc">VensimReferenceStructureCallbackWalker</span><span class="p">(</span><span class="n">GenericVensimStructureCallbackWalker</span><span class="p">):</span>
</span><span id="VensimReferenceStructureCallbackWalker-367"><a href="#VensimReferenceStructureCallbackWalker-367"><span class="linenos">367</span></a>    <span class="k">def</span> <span class="nf">walk_ReferenceStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">,</span>
</span><span id="VensimReferenceStructureCallbackWalker-368"><a href="#VensimReferenceStructureCallbackWalker-368"><span class="linenos">368</span></a>                                <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="VensimReferenceStructureCallbackWalker-369"><a href="#VensimReferenceStructureCallbackWalker-369"><span class="linenos">369</span></a>                                <span class="n">time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">initial</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker-370"><a href="#VensimReferenceStructureCallbackWalker-370"><span class="linenos">370</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker-371"><a href="#VensimReferenceStructureCallbackWalker-371"><span class="linenos">371</span></a>
</span><span id="VensimReferenceStructureCallbackWalker-372"><a href="#VensimReferenceStructureCallbackWalker-372"><span class="linenos">372</span></a><span class="sd">        Parameters</span>
</span><span id="VensimReferenceStructureCallbackWalker-373"><a href="#VensimReferenceStructureCallbackWalker-373"><span class="linenos">373</span></a><span class="sd">        ----------</span>
</span><span id="VensimReferenceStructureCallbackWalker-374"><a href="#VensimReferenceStructureCallbackWalker-374"><span class="linenos">374</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="VensimReferenceStructureCallbackWalker-375"><a href="#VensimReferenceStructureCallbackWalker-375"><span class="linenos">375</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="VensimReferenceStructureCallbackWalker-376"><a href="#VensimReferenceStructureCallbackWalker-376"><span class="linenos">376</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="VensimReferenceStructureCallbackWalker-377"><a href="#VensimReferenceStructureCallbackWalker-377"><span class="linenos">377</span></a><span class="sd">            resume running its own code.</span>
</span><span id="VensimReferenceStructureCallbackWalker-378"><a href="#VensimReferenceStructureCallbackWalker-378"><span class="linenos">378</span></a><span class="sd">        component_ast : ReferenceStructure</span>
</span><span id="VensimReferenceStructureCallbackWalker-379"><a href="#VensimReferenceStructureCallbackWalker-379"><span class="linenos">379</span></a><span class="sd">            A `ReferenceStructure` object. The arguments for this function onwards are exactly the same as</span>
</span><span id="VensimReferenceStructureCallbackWalker-380"><a href="#VensimReferenceStructureCallbackWalker-380"><span class="linenos">380</span></a><span class="sd">            `BaseVensimWalker.walk()`</span>
</span><span id="VensimReferenceStructureCallbackWalker-381"><a href="#VensimReferenceStructureCallbackWalker-381"><span class="linenos">381</span></a><span class="sd">        node_name : str</span>
</span><span id="VensimReferenceStructureCallbackWalker-382"><a href="#VensimReferenceStructureCallbackWalker-382"><span class="linenos">382</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="VensimReferenceStructureCallbackWalker-383"><a href="#VensimReferenceStructureCallbackWalker-383"><span class="linenos">383</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="VensimReferenceStructureCallbackWalker-384"><a href="#VensimReferenceStructureCallbackWalker-384"><span class="linenos">384</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="VensimReferenceStructureCallbackWalker-385"><a href="#VensimReferenceStructureCallbackWalker-385"><span class="linenos">385</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="VensimReferenceStructureCallbackWalker-386"><a href="#VensimReferenceStructureCallbackWalker-386"><span class="linenos">386</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="VensimReferenceStructureCallbackWalker-387"><a href="#VensimReferenceStructureCallbackWalker-387"><span class="linenos">387</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="VensimReferenceStructureCallbackWalker-388"><a href="#VensimReferenceStructureCallbackWalker-388"><span class="linenos">388</span></a><span class="sd">        current_precedence : int</span>
</span><span id="VensimReferenceStructureCallbackWalker-389"><a href="#VensimReferenceStructureCallbackWalker-389"><span class="linenos">389</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="VensimReferenceStructureCallbackWalker-390"><a href="#VensimReferenceStructureCallbackWalker-390"><span class="linenos">390</span></a><span class="sd">        time : str</span>
</span><span id="VensimReferenceStructureCallbackWalker-391"><a href="#VensimReferenceStructureCallbackWalker-391"><span class="linenos">391</span></a><span class="sd">            String to use for the `time` argument for data functions. should be left to default when within the ODE,</span>
</span><span id="VensimReferenceStructureCallbackWalker-392"><a href="#VensimReferenceStructureCallbackWalker-392"><span class="linenos">392</span></a><span class="sd">            else set to `initial_time` for anytime else.</span>
</span><span id="VensimReferenceStructureCallbackWalker-393"><a href="#VensimReferenceStructureCallbackWalker-393"><span class="linenos">393</span></a><span class="sd">        initial : bool</span>
</span><span id="VensimReferenceStructureCallbackWalker-394"><a href="#VensimReferenceStructureCallbackWalker-394"><span class="linenos">394</span></a><span class="sd">            Boolean on whether the code generation is generating initial values. If true, suffixes all stock variable</span>
</span><span id="VensimReferenceStructureCallbackWalker-395"><a href="#VensimReferenceStructureCallbackWalker-395"><span class="linenos">395</span></a><span class="sd">            usage with &quot;_initial&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker-396"><a href="#VensimReferenceStructureCallbackWalker-396"><span class="linenos">396</span></a>
</span><span id="VensimReferenceStructureCallbackWalker-397"><a href="#VensimReferenceStructureCallbackWalker-397"><span class="linenos">397</span></a><span class="sd">        Returns</span>
</span><span id="VensimReferenceStructureCallbackWalker-398"><a href="#VensimReferenceStructureCallbackWalker-398"><span class="linenos">398</span></a><span class="sd">        -------</span>
</span><span id="VensimReferenceStructureCallbackWalker-399"><a href="#VensimReferenceStructureCallbackWalker-399"><span class="linenos">399</span></a><span class="sd">        A string of the generated code</span>
</span><span id="VensimReferenceStructureCallbackWalker-400"><a href="#VensimReferenceStructureCallbackWalker-400"><span class="linenos">400</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker-401"><a href="#VensimReferenceStructureCallbackWalker-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscripts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="VensimReferenceStructureCallbackWalker-402"><a href="#VensimReferenceStructureCallbackWalker-402"><span class="linenos">402</span></a>            <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="VensimReferenceStructureCallbackWalker-403"><a href="#VensimReferenceStructureCallbackWalker-403"><span class="linenos">403</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker-404"><a href="#VensimReferenceStructureCallbackWalker-404"><span class="linenos">404</span></a>            <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="VensimReferenceStructureCallbackWalker-405"><a href="#VensimReferenceStructureCallbackWalker-405"><span class="linenos">405</span></a>
</span><span id="VensimReferenceStructureCallbackWalker-406"><a href="#VensimReferenceStructureCallbackWalker-406"><span class="linenos">406</span></a>        <span class="n">variable_name</span> <span class="o">=</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span>
</span><span id="VensimReferenceStructureCallbackWalker-407"><a href="#VensimReferenceStructureCallbackWalker-407"><span class="linenos">407</span></a>
</span><span id="VensimReferenceStructureCallbackWalker-408"><a href="#VensimReferenceStructureCallbackWalker-408"><span class="linenos">408</span></a>        <span class="c1"># Sometimes PySD passes function names into ReferenceStructure.</span>
</span><span id="VensimReferenceStructureCallbackWalker-409"><a href="#VensimReferenceStructureCallbackWalker-409"><span class="linenos">409</span></a>        <span class="k">if</span> <span class="n">variable_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker-410"><a href="#VensimReferenceStructureCallbackWalker-410"><span class="linenos">410</span></a>            <span class="k">return</span> <span class="n">variable_name</span>
</span><span id="VensimReferenceStructureCallbackWalker-411"><a href="#VensimReferenceStructureCallbackWalker-411"><span class="linenos">411</span></a>
</span><span id="VensimReferenceStructureCallbackWalker-412"><a href="#VensimReferenceStructureCallbackWalker-412"><span class="linenos">412</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">variable_name</span><span class="p">]</span><span class="o">.</span><span class="n">is_vensim_datastructure</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker-413"><a href="#VensimReferenceStructureCallbackWalker-413"><span class="linenos">413</span></a>            <span class="c1"># datastructure are a function</span>
</span><span id="VensimReferenceStructureCallbackWalker-414"><a href="#VensimReferenceStructureCallbackWalker-414"><span class="linenos">414</span></a>            <span class="k">if</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker-415"><a href="#VensimReferenceStructureCallbackWalker-415"><span class="linenos">415</span></a>                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">subscript_args</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker-416"><a href="#VensimReferenceStructureCallbackWalker-416"><span class="linenos">416</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker-417"><a href="#VensimReferenceStructureCallbackWalker-417"><span class="linenos">417</span></a>                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker-418"><a href="#VensimReferenceStructureCallbackWalker-418"><span class="linenos">418</span></a>
</span><span id="VensimReferenceStructureCallbackWalker-419"><a href="#VensimReferenceStructureCallbackWalker-419"><span class="linenos">419</span></a>        <span class="k">if</span> <span class="n">initial</span> <span class="ow">and</span> <span class="n">variable_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">integ_outcome_variables</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker-420"><a href="#VensimReferenceStructureCallbackWalker-420"><span class="linenos">420</span></a>            <span class="n">variable_name</span> <span class="o">=</span> <span class="n">variable_name</span> <span class="o">+</span> <span class="s2">&quot;_initial&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker-421"><a href="#VensimReferenceStructureCallbackWalker-421"><span class="linenos">421</span></a>
</span><span id="VensimReferenceStructureCallbackWalker-422"><a href="#VensimReferenceStructureCallbackWalker-422"><span class="linenos">422</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker-423"><a href="#VensimReferenceStructureCallbackWalker-423"><span class="linenos">423</span></a>            <span class="k">return</span> <span class="n">variable_name</span>
</span><span id="VensimReferenceStructureCallbackWalker-424"><a href="#VensimReferenceStructureCallbackWalker-424"><span class="linenos">424</span></a>
</span><span id="VensimReferenceStructureCallbackWalker-425"><a href="#VensimReferenceStructureCallbackWalker-425"><span class="linenos">425</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">subscript_args</span><span class="si">}</span><span class="s2">]&quot;</span>
</span></pre></div>


            <div class="docstring"><p>This Vensim walker is a bit different from <code><a href="#BaseVensimWalker">BaseVensimWalker</a></code>. This family of callable classes implement the
base behavior for walking and generating code for various components. Each subclass implements a single walk
method for a single type of Vensim AST node. Instead of writing all the logic for handling different types of AST
nodes in a single function/class which would then pose problems when you subclass walkers, you can you these
modularized classes to reduce duplicate code.</p>

<p>If the walker runs into one of the different AST node types, it will insteall call the <code>walk_callback</code> callable,
which can implement or call another walker that can process it.</p>
</div>


                            <div id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure" class="classattr">
                                        <input id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk_ReferenceStructure</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">ReferenceStructure</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span>,</span><span class="param">	<span class="n">time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;time&#39;</span>,</span><span class="param">	<span class="n">initial</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-367"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-367"><span class="linenos">367</span></a>    <span class="k">def</span> <span class="nf">walk_ReferenceStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">,</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-368"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-368"><span class="linenos">368</span></a>                                <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-369"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-369"><span class="linenos">369</span></a>                                <span class="n">time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">initial</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-370"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-370"><span class="linenos">370</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-371"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-371"><span class="linenos">371</span></a>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-372"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-372"><span class="linenos">372</span></a><span class="sd">        Parameters</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-373"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-373"><span class="linenos">373</span></a><span class="sd">        ----------</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-374"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-374"><span class="linenos">374</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-375"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-375"><span class="linenos">375</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-376"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-376"><span class="linenos">376</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-377"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-377"><span class="linenos">377</span></a><span class="sd">            resume running its own code.</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-378"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-378"><span class="linenos">378</span></a><span class="sd">        component_ast : ReferenceStructure</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-379"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-379"><span class="linenos">379</span></a><span class="sd">            A `ReferenceStructure` object. The arguments for this function onwards are exactly the same as</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-380"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-380"><span class="linenos">380</span></a><span class="sd">            `BaseVensimWalker.walk()`</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-381"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-381"><span class="linenos">381</span></a><span class="sd">        node_name : str</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-382"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-382"><span class="linenos">382</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-383"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-383"><span class="linenos">383</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-384"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-384"><span class="linenos">384</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-385"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-385"><span class="linenos">385</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-386"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-386"><span class="linenos">386</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-387"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-387"><span class="linenos">387</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-388"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-388"><span class="linenos">388</span></a><span class="sd">        current_precedence : int</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-389"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-389"><span class="linenos">389</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-390"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-390"><span class="linenos">390</span></a><span class="sd">        time : str</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-391"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-391"><span class="linenos">391</span></a><span class="sd">            String to use for the `time` argument for data functions. should be left to default when within the ODE,</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-392"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-392"><span class="linenos">392</span></a><span class="sd">            else set to `initial_time` for anytime else.</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-393"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-393"><span class="linenos">393</span></a><span class="sd">        initial : bool</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-394"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-394"><span class="linenos">394</span></a><span class="sd">            Boolean on whether the code generation is generating initial values. If true, suffixes all stock variable</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-395"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-395"><span class="linenos">395</span></a><span class="sd">            usage with &quot;_initial&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-396"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-396"><span class="linenos">396</span></a>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-397"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-397"><span class="linenos">397</span></a><span class="sd">        Returns</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-398"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-398"><span class="linenos">398</span></a><span class="sd">        -------</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-399"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-399"><span class="linenos">399</span></a><span class="sd">        A string of the generated code</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-400"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-400"><span class="linenos">400</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-401"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-401"><span class="linenos">401</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscripts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-402"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-402"><span class="linenos">402</span></a>            <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-403"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-403"><span class="linenos">403</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-404"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-404"><span class="linenos">404</span></a>            <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-405"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-405"><span class="linenos">405</span></a>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-406"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-406"><span class="linenos">406</span></a>        <span class="n">variable_name</span> <span class="o">=</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-407"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-407"><span class="linenos">407</span></a>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-408"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-408"><span class="linenos">408</span></a>        <span class="c1"># Sometimes PySD passes function names into ReferenceStructure.</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-409"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-409"><span class="linenos">409</span></a>        <span class="k">if</span> <span class="n">variable_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">variables</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-410"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-410"><span class="linenos">410</span></a>            <span class="k">return</span> <span class="n">variable_name</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-411"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-411"><span class="linenos">411</span></a>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-412"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-412"><span class="linenos">412</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="n">variable_name</span><span class="p">]</span><span class="o">.</span><span class="n">is_vensim_datastructure</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-413"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-413"><span class="linenos">413</span></a>            <span class="c1"># datastructure are a function</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-414"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-414"><span class="linenos">414</span></a>            <span class="k">if</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-415"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-415"><span class="linenos">415</span></a>                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">subscript_args</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-416"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-416"><span class="linenos">416</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-417"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-417"><span class="linenos">417</span></a>                <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">variable_name</span><span class="si">}</span><span class="s2">(</span><span class="si">{</span><span class="n">time</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-418"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-418"><span class="linenos">418</span></a>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-419"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-419"><span class="linenos">419</span></a>        <span class="k">if</span> <span class="n">initial</span> <span class="ow">and</span> <span class="n">variable_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="o">.</span><span class="n">integ_outcome_variables</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-420"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-420"><span class="linenos">420</span></a>            <span class="n">variable_name</span> <span class="o">=</span> <span class="n">variable_name</span> <span class="o">+</span> <span class="s2">&quot;_initial&quot;</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-421"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-421"><span class="linenos">421</span></a>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-422"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-422"><span class="linenos">422</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-423"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-423"><span class="linenos">423</span></a>            <span class="k">return</span> <span class="n">variable_name</span>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-424"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-424"><span class="linenos">424</span></a>
</span><span id="VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-425"><a href="#VensimReferenceStructureCallbackWalker.walk_ReferenceStructure-425"><span class="linenos">425</span></a>        <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">component_ast</span><span class="o">.</span><span class="n">reference</span><span class="si">}</span><span class="s2">[</span><span class="si">{</span><span class="n">subscript_args</span><span class="si">}</span><span class="s2">]&quot;</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>walk_callback</strong> (Callable):
This is the function that will be called with a <code><a href="#VensimReferenceStructureCallbackWalker.walk">walk()</a></code> function needs to be called. Normally this would be
the caller of this function. This way, the original caller retains the execution trace and is allowed to
resume running its own code.</li>
<li><strong>component_ast</strong> (ReferenceStructure):
A <code>ReferenceStructure</code> object. The arguments for this function onwards are exactly the same as
<code><a href="#BaseVensimWalker.walk">BaseVensimWalker.walk()</a></code></li>
<li><strong>node_name</strong> (str):
Name of the Vensim element(variable name)</li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be
<code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Current precedence level of the AST. Only relevant for ArithmeticStructure.</li>
<li><strong>time</strong> (str):
String to use for the <code>time</code> argument for data functions. should be left to default when within the ODE,
else set to <code>initial_time</code> for anytime else.</li>
<li><strong>initial</strong> (bool):
Boolean on whether the code generation is generating initial values. If true, suffixes all stock variable
usage with "_initial"</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>A string of the generated code</strong></li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#GenericVensimStructureCallbackWalker">GenericVensimStructureCallbackWalker</a></dt>
                                <dd id="VensimReferenceStructureCallbackWalker.__init__" class="function"><a href="#GenericVensimStructureCallbackWalker.__init__">GenericVensimStructureCallbackWalker</a></dd>
                <dd id="VensimReferenceStructureCallbackWalker.walk" class="function"><a href="#GenericVensimStructureCallbackWalker.walk">walk</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="VensimCallStructureCallbackWalker">
                            <input id="VensimCallStructureCallbackWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">VensimCallStructureCallbackWalker</span><wbr>(<span class="base"><a href="#GenericVensimStructureCallbackWalker">GenericVensimStructureCallbackWalker</a></span>):

                <label class="view-source-button" for="VensimCallStructureCallbackWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VensimCallStructureCallbackWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VensimCallStructureCallbackWalker-428"><a href="#VensimCallStructureCallbackWalker-428"><span class="linenos">428</span></a><span class="k">class</span> <span class="nc">VensimCallStructureCallbackWalker</span><span class="p">(</span><span class="n">GenericVensimStructureCallbackWalker</span><span class="p">):</span>
</span><span id="VensimCallStructureCallbackWalker-429"><a href="#VensimCallStructureCallbackWalker-429"><span class="linenos">429</span></a>    <span class="k">def</span> <span class="nf">walk_CallStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="VensimCallStructureCallbackWalker-430"><a href="#VensimCallStructureCallbackWalker-430"><span class="linenos">430</span></a>                           <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker-431"><a href="#VensimCallStructureCallbackWalker-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-432"><a href="#VensimCallStructureCallbackWalker-432"><span class="linenos">432</span></a>
</span><span id="VensimCallStructureCallbackWalker-433"><a href="#VensimCallStructureCallbackWalker-433"><span class="linenos">433</span></a><span class="sd">        Parameters</span>
</span><span id="VensimCallStructureCallbackWalker-434"><a href="#VensimCallStructureCallbackWalker-434"><span class="linenos">434</span></a><span class="sd">        ----------</span>
</span><span id="VensimCallStructureCallbackWalker-435"><a href="#VensimCallStructureCallbackWalker-435"><span class="linenos">435</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="VensimCallStructureCallbackWalker-436"><a href="#VensimCallStructureCallbackWalker-436"><span class="linenos">436</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="VensimCallStructureCallbackWalker-437"><a href="#VensimCallStructureCallbackWalker-437"><span class="linenos">437</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="VensimCallStructureCallbackWalker-438"><a href="#VensimCallStructureCallbackWalker-438"><span class="linenos">438</span></a><span class="sd">            resume running its own code.</span>
</span><span id="VensimCallStructureCallbackWalker-439"><a href="#VensimCallStructureCallbackWalker-439"><span class="linenos">439</span></a><span class="sd">        component_ast : CallStructure</span>
</span><span id="VensimCallStructureCallbackWalker-440"><a href="#VensimCallStructureCallbackWalker-440"><span class="linenos">440</span></a><span class="sd">            A `CallStructure` object. The arguments for this function onwards are exactly the same as</span>
</span><span id="VensimCallStructureCallbackWalker-441"><a href="#VensimCallStructureCallbackWalker-441"><span class="linenos">441</span></a><span class="sd">            `BaseVensimWalker.walk()`</span>
</span><span id="VensimCallStructureCallbackWalker-442"><a href="#VensimCallStructureCallbackWalker-442"><span class="linenos">442</span></a><span class="sd">        node_name : str</span>
</span><span id="VensimCallStructureCallbackWalker-443"><a href="#VensimCallStructureCallbackWalker-443"><span class="linenos">443</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="VensimCallStructureCallbackWalker-444"><a href="#VensimCallStructureCallbackWalker-444"><span class="linenos">444</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="VensimCallStructureCallbackWalker-445"><a href="#VensimCallStructureCallbackWalker-445"><span class="linenos">445</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="VensimCallStructureCallbackWalker-446"><a href="#VensimCallStructureCallbackWalker-446"><span class="linenos">446</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="VensimCallStructureCallbackWalker-447"><a href="#VensimCallStructureCallbackWalker-447"><span class="linenos">447</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="VensimCallStructureCallbackWalker-448"><a href="#VensimCallStructureCallbackWalker-448"><span class="linenos">448</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="VensimCallStructureCallbackWalker-449"><a href="#VensimCallStructureCallbackWalker-449"><span class="linenos">449</span></a><span class="sd">        current_precedence : int</span>
</span><span id="VensimCallStructureCallbackWalker-450"><a href="#VensimCallStructureCallbackWalker-450"><span class="linenos">450</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="VensimCallStructureCallbackWalker-451"><a href="#VensimCallStructureCallbackWalker-451"><span class="linenos">451</span></a>
</span><span id="VensimCallStructureCallbackWalker-452"><a href="#VensimCallStructureCallbackWalker-452"><span class="linenos">452</span></a><span class="sd">        Returns</span>
</span><span id="VensimCallStructureCallbackWalker-453"><a href="#VensimCallStructureCallbackWalker-453"><span class="linenos">453</span></a><span class="sd">        -------</span>
</span><span id="VensimCallStructureCallbackWalker-454"><a href="#VensimCallStructureCallbackWalker-454"><span class="linenos">454</span></a><span class="sd">        A string of the generated code</span>
</span><span id="VensimCallStructureCallbackWalker-455"><a href="#VensimCallStructureCallbackWalker-455"><span class="linenos">455</span></a>
</span><span id="VensimCallStructureCallbackWalker-456"><a href="#VensimCallStructureCallbackWalker-456"><span class="linenos">456</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-457"><a href="#VensimCallStructureCallbackWalker-457"><span class="linenos">457</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-458"><a href="#VensimCallStructureCallbackWalker-458"><span class="linenos">458</span></a>        <span class="n">function_name</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker-459"><a href="#VensimCallStructureCallbackWalker-459"><span class="linenos">459</span></a>
</span><span id="VensimCallStructureCallbackWalker-460"><a href="#VensimCallStructureCallbackWalker-460"><span class="linenos">460</span></a>        <span class="c1"># Some special vensim functions correspond to special stan functions or syntax.</span>
</span><span id="VensimCallStructureCallbackWalker-461"><a href="#VensimCallStructureCallbackWalker-461"><span class="linenos">461</span></a>        <span class="k">if</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker-462"><a href="#VensimCallStructureCallbackWalker-462"><span class="linenos">462</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="s2">&quot;fmin&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-463"><a href="#VensimCallStructureCallbackWalker-463"><span class="linenos">463</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker-464"><a href="#VensimCallStructureCallbackWalker-464"><span class="linenos">464</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="s2">&quot;fmax&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-465"><a href="#VensimCallStructureCallbackWalker-465"><span class="linenos">465</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;xidz&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker-466"><a href="#VensimCallStructureCallbackWalker-466"><span class="linenos">466</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;number of arguments for xidz must be 3&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-467"><a href="#VensimCallStructureCallbackWalker-467"><span class="linenos">467</span></a>            <span class="n">arg1</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker-468"><a href="#VensimCallStructureCallbackWalker-468"><span class="linenos">468</span></a>            <span class="n">arg2</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker-469"><a href="#VensimCallStructureCallbackWalker-469"><span class="linenos">469</span></a>            <span class="n">arg3</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker-470"><a href="#VensimCallStructureCallbackWalker-470"><span class="linenos">470</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (abs(</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">) &lt;= 1e-6) ? </span><span class="si">{</span><span class="n">arg3</span><span class="si">}</span><span class="s2"> : (</span><span class="si">{</span><span class="n">arg1</span><span class="si">}</span><span class="s2">) / (</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-471"><a href="#VensimCallStructureCallbackWalker-471"><span class="linenos">471</span></a>            <span class="k">return</span> <span class="n">output_string</span>
</span><span id="VensimCallStructureCallbackWalker-472"><a href="#VensimCallStructureCallbackWalker-472"><span class="linenos">472</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;zidz&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker-473"><a href="#VensimCallStructureCallbackWalker-473"><span class="linenos">473</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;number of arguments for zidz must be 2&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-474"><a href="#VensimCallStructureCallbackWalker-474"><span class="linenos">474</span></a>            <span class="n">arg1</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker-475"><a href="#VensimCallStructureCallbackWalker-475"><span class="linenos">475</span></a>            <span class="n">arg2</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker-476"><a href="#VensimCallStructureCallbackWalker-476"><span class="linenos">476</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (abs(</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">) &lt;= 1e-6) ? 0 : (</span><span class="si">{</span><span class="n">arg1</span><span class="si">}</span><span class="s2">) / (</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-477"><a href="#VensimCallStructureCallbackWalker-477"><span class="linenos">477</span></a>            <span class="k">return</span> <span class="n">output_string</span>
</span><span id="VensimCallStructureCallbackWalker-478"><a href="#VensimCallStructureCallbackWalker-478"><span class="linenos">478</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;ln&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker-479"><a href="#VensimCallStructureCallbackWalker-479"><span class="linenos">479</span></a>            <span class="c1"># natural log in stan is just log</span>
</span><span id="VensimCallStructureCallbackWalker-480"><a href="#VensimCallStructureCallbackWalker-480"><span class="linenos">480</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="s2">&quot;log&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-481"><a href="#VensimCallStructureCallbackWalker-481"><span class="linenos">481</span></a>
</span><span id="VensimCallStructureCallbackWalker-482"><a href="#VensimCallStructureCallbackWalker-482"><span class="linenos">482</span></a>        <span class="n">output_string</span> <span class="o">+=</span> <span class="n">function_name</span>
</span><span id="VensimCallStructureCallbackWalker-483"><a href="#VensimCallStructureCallbackWalker-483"><span class="linenos">483</span></a>        <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">walk_callback</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="VensimCallStructureCallbackWalker-484"><a href="#VensimCallStructureCallbackWalker-484"><span class="linenos">484</span></a>
</span><span id="VensimCallStructureCallbackWalker-485"><a href="#VensimCallStructureCallbackWalker-485"><span class="linenos">485</span></a>        <span class="k">return</span> <span class="n">output_string</span>
</span></pre></div>


            <div class="docstring"><p>This Vensim walker is a bit different from <code><a href="#BaseVensimWalker">BaseVensimWalker</a></code>. This family of callable classes implement the
base behavior for walking and generating code for various components. Each subclass implements a single walk
method for a single type of Vensim AST node. Instead of writing all the logic for handling different types of AST
nodes in a single function/class which would then pose problems when you subclass walkers, you can you these
modularized classes to reduce duplicate code.</p>

<p>If the walker runs into one of the different AST node types, it will insteall call the <code>walk_callback</code> callable,
which can implement or call another walker that can process it.</p>
</div>


                            <div id="VensimCallStructureCallbackWalker.walk_CallStructure" class="classattr">
                                        <input id="VensimCallStructureCallbackWalker.walk_CallStructure-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk_CallStructure</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">CallStructure</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="VensimCallStructureCallbackWalker.walk_CallStructure-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VensimCallStructureCallbackWalker.walk_CallStructure"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-429"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-429"><span class="linenos">429</span></a>    <span class="k">def</span> <span class="nf">walk_CallStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-430"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-430"><span class="linenos">430</span></a>                           <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-431"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-432"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-432"><span class="linenos">432</span></a>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-433"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-433"><span class="linenos">433</span></a><span class="sd">        Parameters</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-434"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-434"><span class="linenos">434</span></a><span class="sd">        ----------</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-435"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-435"><span class="linenos">435</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-436"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-436"><span class="linenos">436</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-437"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-437"><span class="linenos">437</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-438"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-438"><span class="linenos">438</span></a><span class="sd">            resume running its own code.</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-439"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-439"><span class="linenos">439</span></a><span class="sd">        component_ast : CallStructure</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-440"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-440"><span class="linenos">440</span></a><span class="sd">            A `CallStructure` object. The arguments for this function onwards are exactly the same as</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-441"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-441"><span class="linenos">441</span></a><span class="sd">            `BaseVensimWalker.walk()`</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-442"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-442"><span class="linenos">442</span></a><span class="sd">        node_name : str</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-443"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-443"><span class="linenos">443</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-444"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-444"><span class="linenos">444</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-445"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-445"><span class="linenos">445</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-446"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-446"><span class="linenos">446</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-447"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-447"><span class="linenos">447</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-448"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-448"><span class="linenos">448</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-449"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-449"><span class="linenos">449</span></a><span class="sd">        current_precedence : int</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-450"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-450"><span class="linenos">450</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-451"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-451"><span class="linenos">451</span></a>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-452"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-452"><span class="linenos">452</span></a><span class="sd">        Returns</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-453"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-453"><span class="linenos">453</span></a><span class="sd">        -------</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-454"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-454"><span class="linenos">454</span></a><span class="sd">        A string of the generated code</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-455"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-455"><span class="linenos">455</span></a>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-456"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-456"><span class="linenos">456</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-457"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-457"><span class="linenos">457</span></a>        <span class="n">output_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-458"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-458"><span class="linenos">458</span></a>        <span class="n">function_name</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">function</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-459"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-459"><span class="linenos">459</span></a>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-460"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-460"><span class="linenos">460</span></a>        <span class="c1"># Some special vensim functions correspond to special stan functions or syntax.</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-461"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-461"><span class="linenos">461</span></a>        <span class="k">if</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;min&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-462"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-462"><span class="linenos">462</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="s2">&quot;fmin&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-463"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-463"><span class="linenos">463</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-464"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-464"><span class="linenos">464</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="s2">&quot;fmax&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-465"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-465"><span class="linenos">465</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;xidz&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-466"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-466"><span class="linenos">466</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;number of arguments for xidz must be 3&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-467"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-467"><span class="linenos">467</span></a>            <span class="n">arg1</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-468"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-468"><span class="linenos">468</span></a>            <span class="n">arg2</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-469"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-469"><span class="linenos">469</span></a>            <span class="n">arg3</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-470"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-470"><span class="linenos">470</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (abs(</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">) &lt;= 1e-6) ? </span><span class="si">{</span><span class="n">arg3</span><span class="si">}</span><span class="s2"> : (</span><span class="si">{</span><span class="n">arg1</span><span class="si">}</span><span class="s2">) / (</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-471"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-471"><span class="linenos">471</span></a>            <span class="k">return</span> <span class="n">output_string</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-472"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-472"><span class="linenos">472</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;zidz&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-473"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-473"><span class="linenos">473</span></a>            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;number of arguments for zidz must be 2&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-474"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-474"><span class="linenos">474</span></a>            <span class="n">arg1</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-475"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-475"><span class="linenos">475</span></a>            <span class="n">arg2</span> <span class="o">=</span> <span class="n">walk_callback</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-476"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-476"><span class="linenos">476</span></a>            <span class="n">output_string</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot; (abs(</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">) &lt;= 1e-6) ? 0 : (</span><span class="si">{</span><span class="n">arg1</span><span class="si">}</span><span class="s2">) / (</span><span class="si">{</span><span class="n">arg2</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-477"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-477"><span class="linenos">477</span></a>            <span class="k">return</span> <span class="n">output_string</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-478"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-478"><span class="linenos">478</span></a>        <span class="k">elif</span> <span class="n">function_name</span> <span class="o">==</span> <span class="s2">&quot;ln&quot;</span><span class="p">:</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-479"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-479"><span class="linenos">479</span></a>            <span class="c1"># natural log in stan is just log</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-480"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-480"><span class="linenos">480</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="s2">&quot;log&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-481"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-481"><span class="linenos">481</span></a>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-482"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-482"><span class="linenos">482</span></a>        <span class="n">output_string</span> <span class="o">+=</span> <span class="n">function_name</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-483"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-483"><span class="linenos">483</span></a>        <span class="n">output_string</span> <span class="o">+=</span> <span class="s2">&quot;(&quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">walk_callback</span><span class="p">(</span><span class="n">argument</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">)</span> <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">arguments</span><span class="p">])</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-484"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-484"><span class="linenos">484</span></a>
</span><span id="VensimCallStructureCallbackWalker.walk_CallStructure-485"><a href="#VensimCallStructureCallbackWalker.walk_CallStructure-485"><span class="linenos">485</span></a>        <span class="k">return</span> <span class="n">output_string</span>
</span></pre></div>


            <div class="docstring"><h6 id="parameters">Parameters</h6>

<ul>
<li><strong>walk_callback</strong> (Callable):
This is the function that will be called with a <code><a href="#VensimCallStructureCallbackWalker.walk">walk()</a></code> function needs to be called. Normally this would be
the caller of this function. This way, the original caller retains the execution trace and is allowed to
resume running its own code.</li>
<li><strong>component_ast</strong> (CallStructure):
A <code>CallStructure</code> object. The arguments for this function onwards are exactly the same as
<code><a href="#BaseVensimWalker.walk">BaseVensimWalker.walk()</a></code></li>
<li><strong>node_name</strong> (str):
Name of the Vensim element(variable name)</li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be
<code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Current precedence level of the AST. Only relevant for ArithmeticStructure.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>A string of the generated code</strong></li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#GenericVensimStructureCallbackWalker">GenericVensimStructureCallbackWalker</a></dt>
                                <dd id="VensimCallStructureCallbackWalker.__init__" class="function"><a href="#GenericVensimStructureCallbackWalker.__init__">GenericVensimStructureCallbackWalker</a></dd>
                <dd id="VensimCallStructureCallbackWalker.walk" class="function"><a href="#GenericVensimStructureCallbackWalker.walk">walk</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="VensimNumericLiteralCallbackWalker">
                            <input id="VensimNumericLiteralCallbackWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">VensimNumericLiteralCallbackWalker</span><wbr>(<span class="base"><a href="#GenericVensimStructureCallbackWalker">GenericVensimStructureCallbackWalker</a></span>):

                <label class="view-source-button" for="VensimNumericLiteralCallbackWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VensimNumericLiteralCallbackWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VensimNumericLiteralCallbackWalker-488"><a href="#VensimNumericLiteralCallbackWalker-488"><span class="linenos">488</span></a><span class="k">class</span> <span class="nc">VensimNumericLiteralCallbackWalker</span><span class="p">(</span><span class="n">GenericVensimStructureCallbackWalker</span><span class="p">):</span>
</span><span id="VensimNumericLiteralCallbackWalker-489"><a href="#VensimNumericLiteralCallbackWalker-489"><span class="linenos">489</span></a>    <span class="k">def</span> <span class="nf">walk_NumericLiteral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">Number</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="VensimNumericLiteralCallbackWalker-490"><a href="#VensimNumericLiteralCallbackWalker-490"><span class="linenos">490</span></a>                            <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="VensimNumericLiteralCallbackWalker-491"><a href="#VensimNumericLiteralCallbackWalker-491"><span class="linenos">491</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimNumericLiteralCallbackWalker-492"><a href="#VensimNumericLiteralCallbackWalker-492"><span class="linenos">492</span></a><span class="sd">        Base handler for numeric constants.</span>
</span><span id="VensimNumericLiteralCallbackWalker-493"><a href="#VensimNumericLiteralCallbackWalker-493"><span class="linenos">493</span></a>
</span><span id="VensimNumericLiteralCallbackWalker-494"><a href="#VensimNumericLiteralCallbackWalker-494"><span class="linenos">494</span></a><span class="sd">        Parameters</span>
</span><span id="VensimNumericLiteralCallbackWalker-495"><a href="#VensimNumericLiteralCallbackWalker-495"><span class="linenos">495</span></a><span class="sd">        ----------</span>
</span><span id="VensimNumericLiteralCallbackWalker-496"><a href="#VensimNumericLiteralCallbackWalker-496"><span class="linenos">496</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="VensimNumericLiteralCallbackWalker-497"><a href="#VensimNumericLiteralCallbackWalker-497"><span class="linenos">497</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="VensimNumericLiteralCallbackWalker-498"><a href="#VensimNumericLiteralCallbackWalker-498"><span class="linenos">498</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="VensimNumericLiteralCallbackWalker-499"><a href="#VensimNumericLiteralCallbackWalker-499"><span class="linenos">499</span></a><span class="sd">            resume running its own code.</span>
</span><span id="VensimNumericLiteralCallbackWalker-500"><a href="#VensimNumericLiteralCallbackWalker-500"><span class="linenos">500</span></a><span class="sd">        component_ast : Number</span>
</span><span id="VensimNumericLiteralCallbackWalker-501"><a href="#VensimNumericLiteralCallbackWalker-501"><span class="linenos">501</span></a><span class="sd">            A Python number. The arguments for this function onwards are exactly the same as</span>
</span><span id="VensimNumericLiteralCallbackWalker-502"><a href="#VensimNumericLiteralCallbackWalker-502"><span class="linenos">502</span></a><span class="sd">            `BaseVensimWalker.walk()`</span>
</span><span id="VensimNumericLiteralCallbackWalker-503"><a href="#VensimNumericLiteralCallbackWalker-503"><span class="linenos">503</span></a><span class="sd">        node_name : str</span>
</span><span id="VensimNumericLiteralCallbackWalker-504"><a href="#VensimNumericLiteralCallbackWalker-504"><span class="linenos">504</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="VensimNumericLiteralCallbackWalker-505"><a href="#VensimNumericLiteralCallbackWalker-505"><span class="linenos">505</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="VensimNumericLiteralCallbackWalker-506"><a href="#VensimNumericLiteralCallbackWalker-506"><span class="linenos">506</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="VensimNumericLiteralCallbackWalker-507"><a href="#VensimNumericLiteralCallbackWalker-507"><span class="linenos">507</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="VensimNumericLiteralCallbackWalker-508"><a href="#VensimNumericLiteralCallbackWalker-508"><span class="linenos">508</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="VensimNumericLiteralCallbackWalker-509"><a href="#VensimNumericLiteralCallbackWalker-509"><span class="linenos">509</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="VensimNumericLiteralCallbackWalker-510"><a href="#VensimNumericLiteralCallbackWalker-510"><span class="linenos">510</span></a><span class="sd">        current_precedence : int</span>
</span><span id="VensimNumericLiteralCallbackWalker-511"><a href="#VensimNumericLiteralCallbackWalker-511"><span class="linenos">511</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="VensimNumericLiteralCallbackWalker-512"><a href="#VensimNumericLiteralCallbackWalker-512"><span class="linenos">512</span></a>
</span><span id="VensimNumericLiteralCallbackWalker-513"><a href="#VensimNumericLiteralCallbackWalker-513"><span class="linenos">513</span></a><span class="sd">        Returns</span>
</span><span id="VensimNumericLiteralCallbackWalker-514"><a href="#VensimNumericLiteralCallbackWalker-514"><span class="linenos">514</span></a><span class="sd">        -------</span>
</span><span id="VensimNumericLiteralCallbackWalker-515"><a href="#VensimNumericLiteralCallbackWalker-515"><span class="linenos">515</span></a><span class="sd">        A string of the generated code</span>
</span><span id="VensimNumericLiteralCallbackWalker-516"><a href="#VensimNumericLiteralCallbackWalker-516"><span class="linenos">516</span></a>
</span><span id="VensimNumericLiteralCallbackWalker-517"><a href="#VensimNumericLiteralCallbackWalker-517"><span class="linenos">517</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimNumericLiteralCallbackWalker-518"><a href="#VensimNumericLiteralCallbackWalker-518"><span class="linenos">518</span></a>        <span class="n">code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">component_ast</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="VensimNumericLiteralCallbackWalker-519"><a href="#VensimNumericLiteralCallbackWalker-519"><span class="linenos">519</span></a>        <span class="k">if</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="VensimNumericLiteralCallbackWalker-520"><a href="#VensimNumericLiteralCallbackWalker-520"><span class="linenos">520</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscripts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="VensimNumericLiteralCallbackWalker-521"><a href="#VensimNumericLiteralCallbackWalker-521"><span class="linenos">521</span></a>                <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="VensimNumericLiteralCallbackWalker-522"><a href="#VensimNumericLiteralCallbackWalker-522"><span class="linenos">522</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="VensimNumericLiteralCallbackWalker-523"><a href="#VensimNumericLiteralCallbackWalker-523"><span class="linenos">523</span></a>                <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="VensimNumericLiteralCallbackWalker-524"><a href="#VensimNumericLiteralCallbackWalker-524"><span class="linenos">524</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rep_array(</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">subscript_args</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimNumericLiteralCallbackWalker-525"><a href="#VensimNumericLiteralCallbackWalker-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="n">code</span>
</span></pre></div>


            <div class="docstring"><p>This Vensim walker is a bit different from <code><a href="#BaseVensimWalker">BaseVensimWalker</a></code>. This family of callable classes implement the
base behavior for walking and generating code for various components. Each subclass implements a single walk
method for a single type of Vensim AST node. Instead of writing all the logic for handling different types of AST
nodes in a single function/class which would then pose problems when you subclass walkers, you can you these
modularized classes to reduce duplicate code.</p>

<p>If the walker runs into one of the different AST node types, it will insteall call the <code>walk_callback</code> callable,
which can implement or call another walker that can process it.</p>
</div>


                            <div id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral" class="classattr">
                                        <input id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk_NumericLiteral</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-489"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-489"><span class="linenos">489</span></a>    <span class="k">def</span> <span class="nf">walk_NumericLiteral</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">walk_callback</span><span class="p">:</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">Number</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-490"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-490"><span class="linenos">490</span></a>                            <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-491"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-491"><span class="linenos">491</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-492"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-492"><span class="linenos">492</span></a><span class="sd">        Base handler for numeric constants.</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-493"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-493"><span class="linenos">493</span></a>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-494"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-494"><span class="linenos">494</span></a><span class="sd">        Parameters</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-495"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-495"><span class="linenos">495</span></a><span class="sd">        ----------</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-496"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-496"><span class="linenos">496</span></a><span class="sd">        walk_callback : Callable</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-497"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-497"><span class="linenos">497</span></a><span class="sd">            This is the function that will be called with a `walk()` function needs to be called. Normally this would be</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-498"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-498"><span class="linenos">498</span></a><span class="sd">            the caller of this function. This way, the original caller retains the execution trace and is allowed to</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-499"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-499"><span class="linenos">499</span></a><span class="sd">            resume running its own code.</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-500"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-500"><span class="linenos">500</span></a><span class="sd">        component_ast : Number</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-501"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-501"><span class="linenos">501</span></a><span class="sd">            A Python number. The arguments for this function onwards are exactly the same as</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-502"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-502"><span class="linenos">502</span></a><span class="sd">            `BaseVensimWalker.walk()`</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-503"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-503"><span class="linenos">503</span></a><span class="sd">        node_name : str</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-504"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-504"><span class="linenos">504</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-505"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-505"><span class="linenos">505</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-506"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-506"><span class="linenos">506</span></a><span class="sd">                Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-507"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-507"><span class="linenos">507</span></a><span class="sd">                `component.subscripts`.</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-508"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-508"><span class="linenos">508</span></a><span class="sd">                However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-509"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-509"><span class="linenos">509</span></a><span class="sd">                in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-510"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-510"><span class="linenos">510</span></a><span class="sd">        current_precedence : int</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-511"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-511"><span class="linenos">511</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure.</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-512"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-512"><span class="linenos">512</span></a>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-513"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-513"><span class="linenos">513</span></a><span class="sd">        Returns</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-514"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-514"><span class="linenos">514</span></a><span class="sd">        -------</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-515"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-515"><span class="linenos">515</span></a><span class="sd">        A string of the generated code</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-516"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-516"><span class="linenos">516</span></a>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-517"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-517"><span class="linenos">517</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-518"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-518"><span class="linenos">518</span></a>        <span class="n">code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">component_ast</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-519"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-519"><span class="linenos">519</span></a>        <span class="k">if</span> <span class="n">subscripts</span><span class="p">:</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-520"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-520"><span class="linenos">520</span></a>            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">subscripts</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-521"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-521"><span class="linenos">521</span></a>                <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-522"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-522"><span class="linenos">522</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-523"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-523"><span class="linenos">523</span></a>                <span class="n">subscript_args</span> <span class="o">=</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">subscripts</span><span class="p">)</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-524"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-524"><span class="linenos">524</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;rep_array(</span><span class="si">{</span><span class="n">code</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">subscript_args</span><span class="si">}</span><span class="s2">)&quot;</span>
</span><span id="VensimNumericLiteralCallbackWalker.walk_NumericLiteral-525"><a href="#VensimNumericLiteralCallbackWalker.walk_NumericLiteral-525"><span class="linenos">525</span></a>        <span class="k">return</span> <span class="n">code</span>
</span></pre></div>


            <div class="docstring"><p>Base handler for numeric constants.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>walk_callback</strong> (Callable):
This is the function that will be called with a <code><a href="#VensimNumericLiteralCallbackWalker.walk">walk()</a></code> function needs to be called. Normally this would be
the caller of this function. This way, the original caller retains the execution trace and is allowed to
resume running its own code.</li>
<li><strong>component_ast</strong> (Number):
A Python number. The arguments for this function onwards are exactly the same as
<code><a href="#BaseVensimWalker.walk">BaseVensimWalker.walk()</a></code></li>
<li><strong>node_name</strong> (str):
Name of the Vensim element(variable name)</li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be
<code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Current precedence level of the AST. Only relevant for ArithmeticStructure.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>A string of the generated code</strong></li>
</ul>
</div>


                            </div>
                            <div class="inherited">
                                <h5>Inherited Members</h5>
                                <dl>
                                    <div><dt><a href="#GenericVensimStructureCallbackWalker">GenericVensimStructureCallbackWalker</a></dt>
                                <dd id="VensimNumericLiteralCallbackWalker.__init__" class="function"><a href="#GenericVensimStructureCallbackWalker.__init__">GenericVensimStructureCallbackWalker</a></dd>
                <dd id="VensimNumericLiteralCallbackWalker.walk" class="function"><a href="#GenericVensimStructureCallbackWalker.walk">walk</a></dd>

            </div>
                                </dl>
                            </div>
                </section>
                <section id="InitialValueCodegenVensimWalker">
                            <input id="InitialValueCodegenVensimWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">InitialValueCodegenVensimWalker</span><wbr>(<span class="base"><a href="#BaseVensimWalker">BaseVensimWalker</a></span>):

                <label class="view-source-button" for="InitialValueCodegenVensimWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#InitialValueCodegenVensimWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="InitialValueCodegenVensimWalker-528"><a href="#InitialValueCodegenVensimWalker-528"><span class="linenos">528</span></a><span class="nd">@dataclass</span>
</span><span id="InitialValueCodegenVensimWalker-529"><a href="#InitialValueCodegenVensimWalker-529"><span class="linenos">529</span></a><span class="k">class</span> <span class="nc">InitialValueCodegenVensimWalker</span><span class="p">(</span><span class="n">BaseVensimWalker</span><span class="p">):</span>
</span><span id="InitialValueCodegenVensimWalker-530"><a href="#InitialValueCodegenVensimWalker-530"><span class="linenos">530</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="InitialValueCodegenVensimWalker-531"><a href="#InitialValueCodegenVensimWalker-531"><span class="linenos">531</span></a><span class="sd">    Generates code for initial state variables. The resulting code goes into the &quot;transformed parameters&quot; block.</span>
</span><span id="InitialValueCodegenVensimWalker-532"><a href="#InitialValueCodegenVensimWalker-532"><span class="linenos">532</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="InitialValueCodegenVensimWalker-533"><a href="#InitialValueCodegenVensimWalker-533"><span class="linenos">533</span></a>
</span><span id="InitialValueCodegenVensimWalker-534"><a href="#InitialValueCodegenVensimWalker-534"><span class="linenos">534</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="InitialValueCodegenVensimWalker-535"><a href="#InitialValueCodegenVensimWalker-535"><span class="linenos">535</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="InitialValueCodegenVensimWalker-536"><a href="#InitialValueCodegenVensimWalker-536"><span class="linenos">536</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker-537"><a href="#InitialValueCodegenVensimWalker-537"><span class="linenos">537</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">initial</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-538"><a href="#InitialValueCodegenVensimWalker-538"><span class="linenos">538</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker-539"><a href="#InitialValueCodegenVensimWalker-539"><span class="linenos">539</span></a>
</span><span id="InitialValueCodegenVensimWalker-540"><a href="#InitialValueCodegenVensimWalker-540"><span class="linenos">540</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">SmoothStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker-541"><a href="#InitialValueCodegenVensimWalker-541"><span class="linenos">541</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">initial</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-542"><a href="#InitialValueCodegenVensimWalker-542"><span class="linenos">542</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker-543"><a href="#InitialValueCodegenVensimWalker-543"><span class="linenos">543</span></a>
</span><span id="InitialValueCodegenVensimWalker-544"><a href="#InitialValueCodegenVensimWalker-544"><span class="linenos">544</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker-545"><a href="#InitialValueCodegenVensimWalker-545"><span class="linenos">545</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimReferenceStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker-546"><a href="#InitialValueCodegenVensimWalker-546"><span class="linenos">546</span></a>                                                                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-547"><a href="#InitialValueCodegenVensimWalker-547"><span class="linenos">547</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ReferenceStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker-548"><a href="#InitialValueCodegenVensimWalker-548"><span class="linenos">548</span></a>                                                      <span class="n">time</span><span class="o">=</span><span class="s2">&quot;initial_time&quot;</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-549"><a href="#InitialValueCodegenVensimWalker-549"><span class="linenos">549</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker-550"><a href="#InitialValueCodegenVensimWalker-550"><span class="linenos">550</span></a>
</span><span id="InitialValueCodegenVensimWalker-551"><a href="#InitialValueCodegenVensimWalker-551"><span class="linenos">551</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker-552"><a href="#InitialValueCodegenVensimWalker-552"><span class="linenos">552</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimArithmeticStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker-553"><a href="#InitialValueCodegenVensimWalker-553"><span class="linenos">553</span></a>                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-554"><a href="#InitialValueCodegenVensimWalker-554"><span class="linenos">554</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ArithmeticStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-555"><a href="#InitialValueCodegenVensimWalker-555"><span class="linenos">555</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker-556"><a href="#InitialValueCodegenVensimWalker-556"><span class="linenos">556</span></a>
</span><span id="InitialValueCodegenVensimWalker-557"><a href="#InitialValueCodegenVensimWalker-557"><span class="linenos">557</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker-558"><a href="#InitialValueCodegenVensimWalker-558"><span class="linenos">558</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimCallStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker-559"><a href="#InitialValueCodegenVensimWalker-559"><span class="linenos">559</span></a>                                                           <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-560"><a href="#InitialValueCodegenVensimWalker-560"><span class="linenos">560</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_CallStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-561"><a href="#InitialValueCodegenVensimWalker-561"><span class="linenos">561</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker-562"><a href="#InitialValueCodegenVensimWalker-562"><span class="linenos">562</span></a>
</span><span id="InitialValueCodegenVensimWalker-563"><a href="#InitialValueCodegenVensimWalker-563"><span class="linenos">563</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker-564"><a href="#InitialValueCodegenVensimWalker-564"><span class="linenos">564</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimNumericLiteralCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker-565"><a href="#InitialValueCodegenVensimWalker-565"><span class="linenos">565</span></a>                                                            <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-566"><a href="#InitialValueCodegenVensimWalker-566"><span class="linenos">566</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_NumericLiteral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker-567"><a href="#InitialValueCodegenVensimWalker-567"><span class="linenos">567</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker-568"><a href="#InitialValueCodegenVensimWalker-568"><span class="linenos">568</span></a>
</span><span id="InitialValueCodegenVensimWalker-569"><a href="#InitialValueCodegenVensimWalker-569"><span class="linenos">569</span></a>            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker-570"><a href="#InitialValueCodegenVensimWalker-570"><span class="linenos">570</span></a>                <span class="k">return</span> <span class="n">component_ast</span>
</span><span id="InitialValueCodegenVensimWalker-571"><a href="#InitialValueCodegenVensimWalker-571"><span class="linenos">571</span></a>
</span><span id="InitialValueCodegenVensimWalker-572"><a href="#InitialValueCodegenVensimWalker-572"><span class="linenos">572</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="InitialValueCodegenVensimWalker-573"><a href="#InitialValueCodegenVensimWalker-573"><span class="linenos">573</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;InitialValueCodegenWalker - got unknown node type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">component_ast</span><span class="p">)</span><span class="si">}</span><span class="s2"> for node </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generates code for initial state variables. The resulting code goes into the "transformed parameters" block.</p>
</div>


                            <div id="InitialValueCodegenVensimWalker.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">InitialValueCodegenVensimWalker</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">v2s_code_handler</span><span class="p">:</span> <span class="n"><a href="v2s_model.html#Vensim2StanCodeHandler">stanify.builders.v2s_model.Vensim2StanCodeHandler</a></span>,</span><span class="param">	<span class="n">vensim_model_context</span><span class="p">:</span> <span class="n"><a href="vensim_model.html#VensimModelContext">stanify.builders.vensim_model.VensimModelContext</a></span>,</span><span class="param">	<span class="n">stan_model_context</span><span class="p">:</span> <span class="n"><a href="stan_model_context.html#StanModelContext">stanify.builders.stan_model_context.StanModelContext</a></span></span>)</span>

        
    </div>
    <a class="headerlink" href="#InitialValueCodegenVensimWalker.__init__"></a>
    
    

                            </div>
                            <div id="InitialValueCodegenVensimWalker.walk" class="classattr">
                                        <input id="InitialValueCodegenVensimWalker.walk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">AbstractSyntax</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="InitialValueCodegenVensimWalker.walk-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#InitialValueCodegenVensimWalker.walk"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="InitialValueCodegenVensimWalker.walk-534"><a href="#InitialValueCodegenVensimWalker.walk-534"><span class="linenos">534</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="InitialValueCodegenVensimWalker.walk-535"><a href="#InitialValueCodegenVensimWalker.walk-535"><span class="linenos">535</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="InitialValueCodegenVensimWalker.walk-536"><a href="#InitialValueCodegenVensimWalker.walk-536"><span class="linenos">536</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker.walk-537"><a href="#InitialValueCodegenVensimWalker.walk-537"><span class="linenos">537</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">initial</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-538"><a href="#InitialValueCodegenVensimWalker.walk-538"><span class="linenos">538</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker.walk-539"><a href="#InitialValueCodegenVensimWalker.walk-539"><span class="linenos">539</span></a>
</span><span id="InitialValueCodegenVensimWalker.walk-540"><a href="#InitialValueCodegenVensimWalker.walk-540"><span class="linenos">540</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">SmoothStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker.walk-541"><a href="#InitialValueCodegenVensimWalker.walk-541"><span class="linenos">541</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">initial</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-542"><a href="#InitialValueCodegenVensimWalker.walk-542"><span class="linenos">542</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker.walk-543"><a href="#InitialValueCodegenVensimWalker.walk-543"><span class="linenos">543</span></a>
</span><span id="InitialValueCodegenVensimWalker.walk-544"><a href="#InitialValueCodegenVensimWalker.walk-544"><span class="linenos">544</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker.walk-545"><a href="#InitialValueCodegenVensimWalker.walk-545"><span class="linenos">545</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimReferenceStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker.walk-546"><a href="#InitialValueCodegenVensimWalker.walk-546"><span class="linenos">546</span></a>                                                                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-547"><a href="#InitialValueCodegenVensimWalker.walk-547"><span class="linenos">547</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ReferenceStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker.walk-548"><a href="#InitialValueCodegenVensimWalker.walk-548"><span class="linenos">548</span></a>                                                      <span class="n">time</span><span class="o">=</span><span class="s2">&quot;initial_time&quot;</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-549"><a href="#InitialValueCodegenVensimWalker.walk-549"><span class="linenos">549</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker.walk-550"><a href="#InitialValueCodegenVensimWalker.walk-550"><span class="linenos">550</span></a>
</span><span id="InitialValueCodegenVensimWalker.walk-551"><a href="#InitialValueCodegenVensimWalker.walk-551"><span class="linenos">551</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker.walk-552"><a href="#InitialValueCodegenVensimWalker.walk-552"><span class="linenos">552</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimArithmeticStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker.walk-553"><a href="#InitialValueCodegenVensimWalker.walk-553"><span class="linenos">553</span></a>                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-554"><a href="#InitialValueCodegenVensimWalker.walk-554"><span class="linenos">554</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ArithmeticStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-555"><a href="#InitialValueCodegenVensimWalker.walk-555"><span class="linenos">555</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker.walk-556"><a href="#InitialValueCodegenVensimWalker.walk-556"><span class="linenos">556</span></a>
</span><span id="InitialValueCodegenVensimWalker.walk-557"><a href="#InitialValueCodegenVensimWalker.walk-557"><span class="linenos">557</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker.walk-558"><a href="#InitialValueCodegenVensimWalker.walk-558"><span class="linenos">558</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimCallStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker.walk-559"><a href="#InitialValueCodegenVensimWalker.walk-559"><span class="linenos">559</span></a>                                                           <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-560"><a href="#InitialValueCodegenVensimWalker.walk-560"><span class="linenos">560</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_CallStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-561"><a href="#InitialValueCodegenVensimWalker.walk-561"><span class="linenos">561</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker.walk-562"><a href="#InitialValueCodegenVensimWalker.walk-562"><span class="linenos">562</span></a>
</span><span id="InitialValueCodegenVensimWalker.walk-563"><a href="#InitialValueCodegenVensimWalker.walk-563"><span class="linenos">563</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker.walk-564"><a href="#InitialValueCodegenVensimWalker.walk-564"><span class="linenos">564</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimNumericLiteralCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="InitialValueCodegenVensimWalker.walk-565"><a href="#InitialValueCodegenVensimWalker.walk-565"><span class="linenos">565</span></a>                                                            <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-566"><a href="#InitialValueCodegenVensimWalker.walk-566"><span class="linenos">566</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_NumericLiteral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="InitialValueCodegenVensimWalker.walk-567"><a href="#InitialValueCodegenVensimWalker.walk-567"><span class="linenos">567</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="InitialValueCodegenVensimWalker.walk-568"><a href="#InitialValueCodegenVensimWalker.walk-568"><span class="linenos">568</span></a>
</span><span id="InitialValueCodegenVensimWalker.walk-569"><a href="#InitialValueCodegenVensimWalker.walk-569"><span class="linenos">569</span></a>            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
</span><span id="InitialValueCodegenVensimWalker.walk-570"><a href="#InitialValueCodegenVensimWalker.walk-570"><span class="linenos">570</span></a>                <span class="k">return</span> <span class="n">component_ast</span>
</span><span id="InitialValueCodegenVensimWalker.walk-571"><a href="#InitialValueCodegenVensimWalker.walk-571"><span class="linenos">571</span></a>
</span><span id="InitialValueCodegenVensimWalker.walk-572"><a href="#InitialValueCodegenVensimWalker.walk-572"><span class="linenos">572</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="InitialValueCodegenVensimWalker.walk-573"><a href="#InitialValueCodegenVensimWalker.walk-573"><span class="linenos">573</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;InitialValueCodegenWalker - got unknown node type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">component_ast</span><span class="p">)</span><span class="si">}</span><span class="s2"> for node </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This is the base format of the Vensim AST walkers. Although they're normally recursively called,
values shouldn't be returned directly, but instead use a class attribute to pass back values.</p>

<ul>
<li>pysd_element
<ul>
<li>name : str. This should be passed into <code>node_name</code></li>
<li>components : list
<ul>
<li>component : AbstractComponent
<ul>
<li>ast : Structure, AST Node. This should be passed into <code>ast_component</code></li>
<li>subscripts : tuple(list[Any], list[Any]). The <strong>first element of the tuple</strong> should be passed into <code>subscripts</code></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component_ast</strong> (AbstractSyntax):
The AST Node of the current AST. Its exact type should be
<code>pysd.translators.structures.abstract_expressions.AbstractSyntax</code> and any of its children. By the above
element hierarchy, should be <code>component.ast</code>.</li>
<li><strong>node_name</strong> (str):
String indicating the AST Node name. By the above element hierarchy, should be <code>element.name</code></li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be
<code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Integer indicating the current operator precedence level. Only relevant when parsing <code>ArithmeticStructure</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>If using any of the <code>walk_X</code> methods, must return a string of the generated code.</strong></li>
</ul>
</div>


                            </div>
                </section>
                <section id="ODEFunctionStatementCodegenVensimWalker">
                            <input id="ODEFunctionStatementCodegenVensimWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">ODEFunctionStatementCodegenVensimWalker</span><wbr>(<span class="base"><a href="#BaseVensimWalker">BaseVensimWalker</a></span>):

                <label class="view-source-button" for="ODEFunctionStatementCodegenVensimWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ODEFunctionStatementCodegenVensimWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ODEFunctionStatementCodegenVensimWalker-576"><a href="#ODEFunctionStatementCodegenVensimWalker-576"><span class="linenos">576</span></a><span class="nd">@dataclass</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-577"><a href="#ODEFunctionStatementCodegenVensimWalker-577"><span class="linenos">577</span></a><span class="k">class</span> <span class="nc">ODEFunctionStatementCodegenVensimWalker</span><span class="p">(</span><span class="n">BaseVensimWalker</span><span class="p">):</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-578"><a href="#ODEFunctionStatementCodegenVensimWalker-578"><span class="linenos">578</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-579"><a href="#ODEFunctionStatementCodegenVensimWalker-579"><span class="linenos">579</span></a><span class="sd">    Generates code for **assignment** statements which belong to the ODE stan function.</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-580"><a href="#ODEFunctionStatementCodegenVensimWalker-580"><span class="linenos">580</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-581"><a href="#ODEFunctionStatementCodegenVensimWalker-581"><span class="linenos">581</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker-582"><a href="#ODEFunctionStatementCodegenVensimWalker-582"><span class="linenos">582</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-583"><a href="#ODEFunctionStatementCodegenVensimWalker-583"><span class="linenos">583</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-584"><a href="#ODEFunctionStatementCodegenVensimWalker-584"><span class="linenos">584</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-585"><a href="#ODEFunctionStatementCodegenVensimWalker-585"><span class="linenos">585</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimReferenceStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-586"><a href="#ODEFunctionStatementCodegenVensimWalker-586"><span class="linenos">586</span></a>                                                                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-587"><a href="#ODEFunctionStatementCodegenVensimWalker-587"><span class="linenos">587</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ReferenceStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-588"><a href="#ODEFunctionStatementCodegenVensimWalker-588"><span class="linenos">588</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-589"><a href="#ODEFunctionStatementCodegenVensimWalker-589"><span class="linenos">589</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker-590"><a href="#ODEFunctionStatementCodegenVensimWalker-590"><span class="linenos">590</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-591"><a href="#ODEFunctionStatementCodegenVensimWalker-591"><span class="linenos">591</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimArithmeticStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-592"><a href="#ODEFunctionStatementCodegenVensimWalker-592"><span class="linenos">592</span></a>                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-593"><a href="#ODEFunctionStatementCodegenVensimWalker-593"><span class="linenos">593</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ArithmeticStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-594"><a href="#ODEFunctionStatementCodegenVensimWalker-594"><span class="linenos">594</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-595"><a href="#ODEFunctionStatementCodegenVensimWalker-595"><span class="linenos">595</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker-596"><a href="#ODEFunctionStatementCodegenVensimWalker-596"><span class="linenos">596</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-597"><a href="#ODEFunctionStatementCodegenVensimWalker-597"><span class="linenos">597</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">flow</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-598"><a href="#ODEFunctionStatementCodegenVensimWalker-598"><span class="linenos">598</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-599"><a href="#ODEFunctionStatementCodegenVensimWalker-599"><span class="linenos">599</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker-600"><a href="#ODEFunctionStatementCodegenVensimWalker-600"><span class="linenos">600</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-601"><a href="#ODEFunctionStatementCodegenVensimWalker-601"><span class="linenos">601</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimCallStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-602"><a href="#ODEFunctionStatementCodegenVensimWalker-602"><span class="linenos">602</span></a>                                                           <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-603"><a href="#ODEFunctionStatementCodegenVensimWalker-603"><span class="linenos">603</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_CallStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-604"><a href="#ODEFunctionStatementCodegenVensimWalker-604"><span class="linenos">604</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-605"><a href="#ODEFunctionStatementCodegenVensimWalker-605"><span class="linenos">605</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker-606"><a href="#ODEFunctionStatementCodegenVensimWalker-606"><span class="linenos">606</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-607"><a href="#ODEFunctionStatementCodegenVensimWalker-607"><span class="linenos">607</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimNumericLiteralCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-608"><a href="#ODEFunctionStatementCodegenVensimWalker-608"><span class="linenos">608</span></a>                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-609"><a href="#ODEFunctionStatementCodegenVensimWalker-609"><span class="linenos">609</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_NumericLiteral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-610"><a href="#ODEFunctionStatementCodegenVensimWalker-610"><span class="linenos">610</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-611"><a href="#ODEFunctionStatementCodegenVensimWalker-611"><span class="linenos">611</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker-612"><a href="#ODEFunctionStatementCodegenVensimWalker-612"><span class="linenos">612</span></a>            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-613"><a href="#ODEFunctionStatementCodegenVensimWalker-613"><span class="linenos">613</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">component_ast</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-614"><a href="#ODEFunctionStatementCodegenVensimWalker-614"><span class="linenos">614</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-615"><a href="#ODEFunctionStatementCodegenVensimWalker-615"><span class="linenos">615</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker-616"><a href="#ODEFunctionStatementCodegenVensimWalker-616"><span class="linenos">616</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker-617"><a href="#ODEFunctionStatementCodegenVensimWalker-617"><span class="linenos">617</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ODEFunctionStatementCodegenWalker - got unknown node type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">component_ast</span><span class="p">)</span><span class="si">}</span><span class="s2"> for node </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generates code for <strong>assignment</strong> statements which belong to the ODE stan function.</p>
</div>


                            <div id="ODEFunctionStatementCodegenVensimWalker.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">ODEFunctionStatementCodegenVensimWalker</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">v2s_code_handler</span><span class="p">:</span> <span class="n"><a href="v2s_model.html#Vensim2StanCodeHandler">stanify.builders.v2s_model.Vensim2StanCodeHandler</a></span>,</span><span class="param">	<span class="n">vensim_model_context</span><span class="p">:</span> <span class="n"><a href="vensim_model.html#VensimModelContext">stanify.builders.vensim_model.VensimModelContext</a></span>,</span><span class="param">	<span class="n">stan_model_context</span><span class="p">:</span> <span class="n"><a href="stan_model_context.html#StanModelContext">stanify.builders.stan_model_context.StanModelContext</a></span></span>)</span>

        
    </div>
    <a class="headerlink" href="#ODEFunctionStatementCodegenVensimWalker.__init__"></a>
    
    

                            </div>
                            <div id="ODEFunctionStatementCodegenVensimWalker.walk" class="classattr">
                                        <input id="ODEFunctionStatementCodegenVensimWalker.walk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">AbstractSyntax</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="ODEFunctionStatementCodegenVensimWalker.walk-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#ODEFunctionStatementCodegenVensimWalker.walk"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="ODEFunctionStatementCodegenVensimWalker.walk-582"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-582"><span class="linenos">582</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span> <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-583"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-583"><span class="linenos">583</span></a>        <span class="k">match</span> <span class="n">component_ast</span><span class="p">:</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-584"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-584"><span class="linenos">584</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ReferenceStructure</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-585"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-585"><span class="linenos">585</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimReferenceStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-586"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-586"><span class="linenos">586</span></a>                                                                <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-587"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-587"><span class="linenos">587</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ReferenceStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-588"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-588"><span class="linenos">588</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-589"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-589"><span class="linenos">589</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-590"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-590"><span class="linenos">590</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">ArithmeticStructure</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-591"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-591"><span class="linenos">591</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimArithmeticStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-592"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-592"><span class="linenos">592</span></a>                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-593"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-593"><span class="linenos">593</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_ArithmeticStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-594"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-594"><span class="linenos">594</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-595"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-595"><span class="linenos">595</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-596"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-596"><span class="linenos">596</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">IntegStructure</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-597"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-597"><span class="linenos">597</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">flow</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-598"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-598"><span class="linenos">598</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-599"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-599"><span class="linenos">599</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-600"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-600"><span class="linenos">600</span></a>            <span class="k">case</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">CallStructure</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-601"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-601"><span class="linenos">601</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimCallStructureCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-602"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-602"><span class="linenos">602</span></a>                                                           <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-603"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-603"><span class="linenos">603</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_CallStructure</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-604"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-604"><span class="linenos">604</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-605"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-605"><span class="linenos">605</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-606"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-606"><span class="linenos">606</span></a>            <span class="k">case</span> <span class="nb">int</span><span class="p">()</span> <span class="o">|</span> <span class="nb">float</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-607"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-607"><span class="linenos">607</span></a>                <span class="n">walker</span> <span class="o">=</span> <span class="n">VensimNumericLiteralCallbackWalker</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v2s_code_handler</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vensim_model_context</span><span class="p">,</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-608"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-608"><span class="linenos">608</span></a>                                                                 <span class="bp">self</span><span class="o">.</span><span class="n">stan_model_context</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-609"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-609"><span class="linenos">609</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">walker</span><span class="o">.</span><span class="n">walk_NumericLiteral</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">walk</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">,</span> <span class="n">node_name</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">)</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-610"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-610"><span class="linenos">610</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-611"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-611"><span class="linenos">611</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-612"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-612"><span class="linenos">612</span></a>            <span class="k">case</span> <span class="nb">str</span><span class="p">():</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-613"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-613"><span class="linenos">613</span></a>                <span class="n">code</span> <span class="o">=</span> <span class="n">component_ast</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-614"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-614"><span class="linenos">614</span></a>                <span class="k">return</span> <span class="n">code</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-615"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-615"><span class="linenos">615</span></a>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-616"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-616"><span class="linenos">616</span></a>            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
</span><span id="ODEFunctionStatementCodegenVensimWalker.walk-617"><a href="#ODEFunctionStatementCodegenVensimWalker.walk-617"><span class="linenos">617</span></a>                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ODEFunctionStatementCodegenWalker - got unknown node type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">component_ast</span><span class="p">)</span><span class="si">}</span><span class="s2"> for node </span><span class="si">{</span><span class="n">node_name</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>This is the base format of the Vensim AST walkers. Although they're normally recursively called,
values shouldn't be returned directly, but instead use a class attribute to pass back values.</p>

<ul>
<li>pysd_element
<ul>
<li>name : str. This should be passed into <code>node_name</code></li>
<li>components : list
<ul>
<li>component : AbstractComponent
<ul>
<li>ast : Structure, AST Node. This should be passed into <code>ast_component</code></li>
<li>subscripts : tuple(list[Any], list[Any]). The <strong>first element of the tuple</strong> should be passed into <code>subscripts</code></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component_ast</strong> (AbstractSyntax):
The AST Node of the current AST. Its exact type should be
<code>pysd.translators.structures.abstract_expressions.AbstractSyntax</code> and any of its children. By the above
element hierarchy, should be <code>component.ast</code>.</li>
<li><strong>node_name</strong> (str):
String indicating the AST Node name. By the above element hierarchy, should be <code>element.name</code></li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should be
<code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Integer indicating the current operator precedence level. Only relevant when parsing <code>ArithmeticStructure</code>.</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>If using any of the <code>walk_X</code> methods, must return a string of the generated code.</strong></li>
</ul>
</div>


                            </div>
                </section>
                <section id="LookupFunctionCodegenVensimWalker">
                            <input id="LookupFunctionCodegenVensimWalker-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
                    <div class="decorator">@dataclass</div>

    <span class="def">class</span>
    <span class="name">LookupFunctionCodegenVensimWalker</span><wbr>(<span class="base"><a href="#BaseVensimWalker">BaseVensimWalker</a></span>):

                <label class="view-source-button" for="LookupFunctionCodegenVensimWalker-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LookupFunctionCodegenVensimWalker"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LookupFunctionCodegenVensimWalker-619"><a href="#LookupFunctionCodegenVensimWalker-619"><span class="linenos">619</span></a><span class="nd">@dataclass</span>
</span><span id="LookupFunctionCodegenVensimWalker-620"><a href="#LookupFunctionCodegenVensimWalker-620"><span class="linenos">620</span></a><span class="k">class</span> <span class="nc">LookupFunctionCodegenVensimWalker</span><span class="p">(</span><span class="n">BaseVensimWalker</span><span class="p">):</span>
</span><span id="LookupFunctionCodegenVensimWalker-621"><a href="#LookupFunctionCodegenVensimWalker-621"><span class="linenos">621</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-622"><a href="#LookupFunctionCodegenVensimWalker-622"><span class="linenos">622</span></a><span class="sd">    Walks the Vensim AST for lookup structures, and generates a stan function for them.</span>
</span><span id="LookupFunctionCodegenVensimWalker-623"><a href="#LookupFunctionCodegenVensimWalker-623"><span class="linenos">623</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-624"><a href="#LookupFunctionCodegenVensimWalker-624"><span class="linenos">624</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-625"><a href="#LookupFunctionCodegenVensimWalker-625"><span class="linenos">625</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-626"><a href="#LookupFunctionCodegenVensimWalker-626"><span class="linenos">626</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
</span><span id="LookupFunctionCodegenVensimWalker-627"><a href="#LookupFunctionCodegenVensimWalker-627"><span class="linenos">627</span></a>             <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker-628"><a href="#LookupFunctionCodegenVensimWalker-628"><span class="linenos">628</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-629"><a href="#LookupFunctionCodegenVensimWalker-629"><span class="linenos">629</span></a><span class="sd">        Given a PySD Vensim component ast, generate and return code that corresponds to a single lookup variable.</span>
</span><span id="LookupFunctionCodegenVensimWalker-630"><a href="#LookupFunctionCodegenVensimWalker-630"><span class="linenos">630</span></a><span class="sd">        The code returned is a full stan function declaration.</span>
</span><span id="LookupFunctionCodegenVensimWalker-631"><a href="#LookupFunctionCodegenVensimWalker-631"><span class="linenos">631</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-632"><a href="#LookupFunctionCodegenVensimWalker-632"><span class="linenos">632</span></a><span class="sd">        Parameters</span>
</span><span id="LookupFunctionCodegenVensimWalker-633"><a href="#LookupFunctionCodegenVensimWalker-633"><span class="linenos">633</span></a><span class="sd">        ----------</span>
</span><span id="LookupFunctionCodegenVensimWalker-634"><a href="#LookupFunctionCodegenVensimWalker-634"><span class="linenos">634</span></a><span class="sd">        component_ast : LookupsStructure</span>
</span><span id="LookupFunctionCodegenVensimWalker-635"><a href="#LookupFunctionCodegenVensimWalker-635"><span class="linenos">635</span></a><span class="sd">            A `LookupsStructure` object. The arguments are exactly the same as `BaseVensimWalker.walk()`</span>
</span><span id="LookupFunctionCodegenVensimWalker-636"><a href="#LookupFunctionCodegenVensimWalker-636"><span class="linenos">636</span></a><span class="sd">        node_name : str</span>
</span><span id="LookupFunctionCodegenVensimWalker-637"><a href="#LookupFunctionCodegenVensimWalker-637"><span class="linenos">637</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="LookupFunctionCodegenVensimWalker-638"><a href="#LookupFunctionCodegenVensimWalker-638"><span class="linenos">638</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="LookupFunctionCodegenVensimWalker-639"><a href="#LookupFunctionCodegenVensimWalker-639"><span class="linenos">639</span></a><span class="sd">            Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should</span>
</span><span id="LookupFunctionCodegenVensimWalker-640"><a href="#LookupFunctionCodegenVensimWalker-640"><span class="linenos">640</span></a><span class="sd">            be `component.subscripts`.</span>
</span><span id="LookupFunctionCodegenVensimWalker-641"><a href="#LookupFunctionCodegenVensimWalker-641"><span class="linenos">641</span></a><span class="sd">            However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="LookupFunctionCodegenVensimWalker-642"><a href="#LookupFunctionCodegenVensimWalker-642"><span class="linenos">642</span></a><span class="sd">            in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="LookupFunctionCodegenVensimWalker-643"><a href="#LookupFunctionCodegenVensimWalker-643"><span class="linenos">643</span></a><span class="sd">        current_precedence : int</span>
</span><span id="LookupFunctionCodegenVensimWalker-644"><a href="#LookupFunctionCodegenVensimWalker-644"><span class="linenos">644</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure, and hence not used within</span>
</span><span id="LookupFunctionCodegenVensimWalker-645"><a href="#LookupFunctionCodegenVensimWalker-645"><span class="linenos">645</span></a><span class="sd">            this walker.</span>
</span><span id="LookupFunctionCodegenVensimWalker-646"><a href="#LookupFunctionCodegenVensimWalker-646"><span class="linenos">646</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-647"><a href="#LookupFunctionCodegenVensimWalker-647"><span class="linenos">647</span></a><span class="sd">        Returns</span>
</span><span id="LookupFunctionCodegenVensimWalker-648"><a href="#LookupFunctionCodegenVensimWalker-648"><span class="linenos">648</span></a><span class="sd">        -------</span>
</span><span id="LookupFunctionCodegenVensimWalker-649"><a href="#LookupFunctionCodegenVensimWalker-649"><span class="linenos">649</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-650"><a href="#LookupFunctionCodegenVensimWalker-650"><span class="linenos">650</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-651"><a href="#LookupFunctionCodegenVensimWalker-651"><span class="linenos">651</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">LookupsStructure</span><span class="p">):</span>
</span><span id="LookupFunctionCodegenVensimWalker-652"><a href="#LookupFunctionCodegenVensimWalker-652"><span class="linenos">652</span></a>            <span class="c1"># Two strategies for implementing the lookup efficiently: If there are 4 or less x values, then we</span>
</span><span id="LookupFunctionCodegenVensimWalker-653"><a href="#LookupFunctionCodegenVensimWalker-653"><span class="linenos">653</span></a>            <span class="c1"># just write 4(or less) comparison statements to calculate the correct slope and intercept.</span>
</span><span id="LookupFunctionCodegenVensimWalker-654"><a href="#LookupFunctionCodegenVensimWalker-654"><span class="linenos">654</span></a>            <span class="c1"># But if there are more than 4 values, we use a binary search.</span>
</span><span id="LookupFunctionCodegenVensimWalker-655"><a href="#LookupFunctionCodegenVensimWalker-655"><span class="linenos">655</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="n">node_name</span>
</span><span id="LookupFunctionCodegenVensimWalker-656"><a href="#LookupFunctionCodegenVensimWalker-656"><span class="linenos">656</span></a>            <span class="n">n_domains</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker-657"><a href="#LookupFunctionCodegenVensimWalker-657"><span class="linenos">657</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">IndentedString</span><span class="p">()</span>
</span><span id="LookupFunctionCodegenVensimWalker-658"><a href="#LookupFunctionCodegenVensimWalker-658"><span class="linenos">658</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;real </span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s2">(real x)</span><span class="se">{{\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-659"><a href="#LookupFunctionCodegenVensimWalker-659"><span class="linenos">659</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-660"><a href="#LookupFunctionCodegenVensimWalker-660"><span class="linenos">660</span></a>            <span class="c1"># Enter function body</span>
</span><span id="LookupFunctionCodegenVensimWalker-661"><a href="#LookupFunctionCodegenVensimWalker-661"><span class="linenos">661</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-662"><a href="#LookupFunctionCodegenVensimWalker-662"><span class="linenos">662</span></a>            <span class="k">if</span> <span class="n">n_domains</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker-663"><a href="#LookupFunctionCodegenVensimWalker-663"><span class="linenos">663</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">codgen_comparison_functionbody</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker-664"><a href="#LookupFunctionCodegenVensimWalker-664"><span class="linenos">664</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker-665"><a href="#LookupFunctionCodegenVensimWalker-665"><span class="linenos">665</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">codegen_binarysearch_functionbody</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker-666"><a href="#LookupFunctionCodegenVensimWalker-666"><span class="linenos">666</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-667"><a href="#LookupFunctionCodegenVensimWalker-667"><span class="linenos">667</span></a>            <span class="c1"># exit function body</span>
</span><span id="LookupFunctionCodegenVensimWalker-668"><a href="#LookupFunctionCodegenVensimWalker-668"><span class="linenos">668</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-669"><a href="#LookupFunctionCodegenVensimWalker-669"><span class="linenos">669</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-670"><a href="#LookupFunctionCodegenVensimWalker-670"><span class="linenos">670</span></a>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker-671"><a href="#LookupFunctionCodegenVensimWalker-671"><span class="linenos">671</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker-672"><a href="#LookupFunctionCodegenVensimWalker-672"><span class="linenos">672</span></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-673"><a href="#LookupFunctionCodegenVensimWalker-673"><span class="linenos">673</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-674"><a href="#LookupFunctionCodegenVensimWalker-674"><span class="linenos">674</span></a>    <span class="nd">@staticmethod</span>
</span><span id="LookupFunctionCodegenVensimWalker-675"><a href="#LookupFunctionCodegenVensimWalker-675"><span class="linenos">675</span></a>    <span class="k">def</span> <span class="nf">codgen_comparison_functionbody</span><span class="p">(</span><span class="n">x_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">y_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker-676"><a href="#LookupFunctionCodegenVensimWalker-676"><span class="linenos">676</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-677"><a href="#LookupFunctionCodegenVensimWalker-677"><span class="linenos">677</span></a><span class="sd">        Generate function body for a lookup stepwise linear function with chained if statements.</span>
</span><span id="LookupFunctionCodegenVensimWalker-678"><a href="#LookupFunctionCodegenVensimWalker-678"><span class="linenos">678</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-679"><a href="#LookupFunctionCodegenVensimWalker-679"><span class="linenos">679</span></a><span class="sd">        Parameters</span>
</span><span id="LookupFunctionCodegenVensimWalker-680"><a href="#LookupFunctionCodegenVensimWalker-680"><span class="linenos">680</span></a><span class="sd">        ----------</span>
</span><span id="LookupFunctionCodegenVensimWalker-681"><a href="#LookupFunctionCodegenVensimWalker-681"><span class="linenos">681</span></a><span class="sd">        x_values : tuple[float]</span>
</span><span id="LookupFunctionCodegenVensimWalker-682"><a href="#LookupFunctionCodegenVensimWalker-682"><span class="linenos">682</span></a><span class="sd">            Values of the steps for the domain of the function.</span>
</span><span id="LookupFunctionCodegenVensimWalker-683"><a href="#LookupFunctionCodegenVensimWalker-683"><span class="linenos">683</span></a><span class="sd">        y_values : tuple[float]</span>
</span><span id="LookupFunctionCodegenVensimWalker-684"><a href="#LookupFunctionCodegenVensimWalker-684"><span class="linenos">684</span></a><span class="sd">            Values of the steps for the range of the function</span>
</span><span id="LookupFunctionCodegenVensimWalker-685"><a href="#LookupFunctionCodegenVensimWalker-685"><span class="linenos">685</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-686"><a href="#LookupFunctionCodegenVensimWalker-686"><span class="linenos">686</span></a><span class="sd">        Returns</span>
</span><span id="LookupFunctionCodegenVensimWalker-687"><a href="#LookupFunctionCodegenVensimWalker-687"><span class="linenos">687</span></a><span class="sd">        -------</span>
</span><span id="LookupFunctionCodegenVensimWalker-688"><a href="#LookupFunctionCodegenVensimWalker-688"><span class="linenos">688</span></a><span class="sd">        String of the generated code</span>
</span><span id="LookupFunctionCodegenVensimWalker-689"><a href="#LookupFunctionCodegenVensimWalker-689"><span class="linenos">689</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-690"><a href="#LookupFunctionCodegenVensimWalker-690"><span class="linenos">690</span></a>        <span class="n">code</span> <span class="o">=</span> <span class="n">IndentedString</span><span class="p">()</span>
</span><span id="LookupFunctionCodegenVensimWalker-691"><a href="#LookupFunctionCodegenVensimWalker-691"><span class="linenos">691</span></a>        <span class="n">n_domains</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker-692"><a href="#LookupFunctionCodegenVensimWalker-692"><span class="linenos">692</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real slope;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-693"><a href="#LookupFunctionCodegenVensimWalker-693"><span class="linenos">693</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real intercept;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-694"><a href="#LookupFunctionCodegenVensimWalker-694"><span class="linenos">694</span></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_domains</span><span class="p">):</span>
</span><span id="LookupFunctionCodegenVensimWalker-695"><a href="#LookupFunctionCodegenVensimWalker-695"><span class="linenos">695</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker-696"><a href="#LookupFunctionCodegenVensimWalker-696"><span class="linenos">696</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;if(x &lt;= </span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}</span><span class="s2">) </span><span class="se">{{\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-697"><a href="#LookupFunctionCodegenVensimWalker-697"><span class="linenos">697</span></a>                <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-698"><a href="#LookupFunctionCodegenVensimWalker-698"><span class="linenos">698</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;return </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-699"><a href="#LookupFunctionCodegenVensimWalker-699"><span class="linenos">699</span></a>                <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-700"><a href="#LookupFunctionCodegenVensimWalker-700"><span class="linenos">700</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-701"><a href="#LookupFunctionCodegenVensimWalker-701"><span class="linenos">701</span></a>                <span class="k">continue</span>
</span><span id="LookupFunctionCodegenVensimWalker-702"><a href="#LookupFunctionCodegenVensimWalker-702"><span class="linenos">702</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-703"><a href="#LookupFunctionCodegenVensimWalker-703"><span class="linenos">703</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;else if(x &lt;= </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">) </span><span class="se">{{\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-704"><a href="#LookupFunctionCodegenVensimWalker-704"><span class="linenos">704</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-705"><a href="#LookupFunctionCodegenVensimWalker-705"><span class="linenos">705</span></a>            <span class="c1"># enter conditional body</span>
</span><span id="LookupFunctionCodegenVensimWalker-706"><a href="#LookupFunctionCodegenVensimWalker-706"><span class="linenos">706</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;intercept = </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-707"><a href="#LookupFunctionCodegenVensimWalker-707"><span class="linenos">707</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;slope = (</span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)/(</span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-708"><a href="#LookupFunctionCodegenVensimWalker-708"><span class="linenos">708</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;return intercept + slope * (x - </span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-709"><a href="#LookupFunctionCodegenVensimWalker-709"><span class="linenos">709</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-710"><a href="#LookupFunctionCodegenVensimWalker-710"><span class="linenos">710</span></a>            <span class="c1"># exit conditional body</span>
</span><span id="LookupFunctionCodegenVensimWalker-711"><a href="#LookupFunctionCodegenVensimWalker-711"><span class="linenos">711</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-712"><a href="#LookupFunctionCodegenVensimWalker-712"><span class="linenos">712</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-713"><a href="#LookupFunctionCodegenVensimWalker-713"><span class="linenos">713</span></a>        <span class="c1"># Handle out-of-bounds input</span>
</span><span id="LookupFunctionCodegenVensimWalker-714"><a href="#LookupFunctionCodegenVensimWalker-714"><span class="linenos">714</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;return </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-715"><a href="#LookupFunctionCodegenVensimWalker-715"><span class="linenos">715</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-716"><a href="#LookupFunctionCodegenVensimWalker-716"><span class="linenos">716</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker-717"><a href="#LookupFunctionCodegenVensimWalker-717"><span class="linenos">717</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-718"><a href="#LookupFunctionCodegenVensimWalker-718"><span class="linenos">718</span></a>    <span class="nd">@staticmethod</span>
</span><span id="LookupFunctionCodegenVensimWalker-719"><a href="#LookupFunctionCodegenVensimWalker-719"><span class="linenos">719</span></a>    <span class="k">def</span> <span class="nf">codegen_binarysearch_functionbody</span><span class="p">(</span><span class="n">x_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">y_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker-720"><a href="#LookupFunctionCodegenVensimWalker-720"><span class="linenos">720</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-721"><a href="#LookupFunctionCodegenVensimWalker-721"><span class="linenos">721</span></a><span class="sd">        Generate function body for a lookup stepwise linear function employing a binary search.</span>
</span><span id="LookupFunctionCodegenVensimWalker-722"><a href="#LookupFunctionCodegenVensimWalker-722"><span class="linenos">722</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-723"><a href="#LookupFunctionCodegenVensimWalker-723"><span class="linenos">723</span></a><span class="sd">        Parameters</span>
</span><span id="LookupFunctionCodegenVensimWalker-724"><a href="#LookupFunctionCodegenVensimWalker-724"><span class="linenos">724</span></a><span class="sd">        ----------</span>
</span><span id="LookupFunctionCodegenVensimWalker-725"><a href="#LookupFunctionCodegenVensimWalker-725"><span class="linenos">725</span></a><span class="sd">        x_values : tuple[float]</span>
</span><span id="LookupFunctionCodegenVensimWalker-726"><a href="#LookupFunctionCodegenVensimWalker-726"><span class="linenos">726</span></a><span class="sd">            Values of the steps for the domain of the function.</span>
</span><span id="LookupFunctionCodegenVensimWalker-727"><a href="#LookupFunctionCodegenVensimWalker-727"><span class="linenos">727</span></a><span class="sd">        y_values : tuple[float]</span>
</span><span id="LookupFunctionCodegenVensimWalker-728"><a href="#LookupFunctionCodegenVensimWalker-728"><span class="linenos">728</span></a><span class="sd">            Values of the steps for the range of the function</span>
</span><span id="LookupFunctionCodegenVensimWalker-729"><a href="#LookupFunctionCodegenVensimWalker-729"><span class="linenos">729</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-730"><a href="#LookupFunctionCodegenVensimWalker-730"><span class="linenos">730</span></a><span class="sd">        Returns</span>
</span><span id="LookupFunctionCodegenVensimWalker-731"><a href="#LookupFunctionCodegenVensimWalker-731"><span class="linenos">731</span></a><span class="sd">        -------</span>
</span><span id="LookupFunctionCodegenVensimWalker-732"><a href="#LookupFunctionCodegenVensimWalker-732"><span class="linenos">732</span></a><span class="sd">        String of the generated code</span>
</span><span id="LookupFunctionCodegenVensimWalker-733"><a href="#LookupFunctionCodegenVensimWalker-733"><span class="linenos">733</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-734"><a href="#LookupFunctionCodegenVensimWalker-734"><span class="linenos">734</span></a>        <span class="n">code</span> <span class="o">=</span> <span class="n">IndentedString</span><span class="p">()</span>
</span><span id="LookupFunctionCodegenVensimWalker-735"><a href="#LookupFunctionCodegenVensimWalker-735"><span class="linenos">735</span></a>        <span class="n">n_domains</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker-736"><a href="#LookupFunctionCodegenVensimWalker-736"><span class="linenos">736</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;array[</span><span class="si">{</span><span class="n">n_domains</span><span class="si">}</span><span class="s2">] real x_values = </span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">x_values</span><span class="p">])</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-737"><a href="#LookupFunctionCodegenVensimWalker-737"><span class="linenos">737</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;array[</span><span class="si">{</span><span class="n">n_domains</span><span class="si">}</span><span class="s2">] real y_values = </span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">y_values</span><span class="p">])</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-738"><a href="#LookupFunctionCodegenVensimWalker-738"><span class="linenos">738</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-739"><a href="#LookupFunctionCodegenVensimWalker-739"><span class="linenos">739</span></a>        <span class="c1"># define the search bound values. Stan integer division floors to the integer result</span>
</span><span id="LookupFunctionCodegenVensimWalker-740"><a href="#LookupFunctionCodegenVensimWalker-740"><span class="linenos">740</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;int lower_index = 1, upper_index = </span><span class="si">{</span><span class="n">n_domains</span><span class="si">}</span><span class="s2">, middle = (lower_index + upper_index) %/% 2;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-741"><a href="#LookupFunctionCodegenVensimWalker-741"><span class="linenos">741</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-742"><a href="#LookupFunctionCodegenVensimWalker-742"><span class="linenos">742</span></a>        <span class="c1"># Check that we&#39;re within bounds first</span>
</span><span id="LookupFunctionCodegenVensimWalker-743"><a href="#LookupFunctionCodegenVensimWalker-743"><span class="linenos">743</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;if (x &gt;= x_values[upper_index]) { return y_values[upper_index]; }</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-744"><a href="#LookupFunctionCodegenVensimWalker-744"><span class="linenos">744</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;if (x &lt;= x_values[lower_index]) { return y_values[lower_index]; }</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-745"><a href="#LookupFunctionCodegenVensimWalker-745"><span class="linenos">745</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-746"><a href="#LookupFunctionCodegenVensimWalker-746"><span class="linenos">746</span></a>        <span class="c1"># create the while loop</span>
</span><span id="LookupFunctionCodegenVensimWalker-747"><a href="#LookupFunctionCodegenVensimWalker-747"><span class="linenos">747</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;while(upper_index - lower_index &gt; 1){</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-748"><a href="#LookupFunctionCodegenVensimWalker-748"><span class="linenos">748</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-749"><a href="#LookupFunctionCodegenVensimWalker-749"><span class="linenos">749</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-750"><a href="#LookupFunctionCodegenVensimWalker-750"><span class="linenos">750</span></a>        <span class="c1"># calculate midpoint (stan integer division floors the result to integer)</span>
</span><span id="LookupFunctionCodegenVensimWalker-751"><a href="#LookupFunctionCodegenVensimWalker-751"><span class="linenos">751</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;middle = (lower_index + upper_index) %/% 2;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-752"><a href="#LookupFunctionCodegenVensimWalker-752"><span class="linenos">752</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-753"><a href="#LookupFunctionCodegenVensimWalker-753"><span class="linenos">753</span></a>        <span class="c1"># check if upper needs to be lowered</span>
</span><span id="LookupFunctionCodegenVensimWalker-754"><a href="#LookupFunctionCodegenVensimWalker-754"><span class="linenos">754</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;if (x &lt;= x_values[middle]){</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-755"><a href="#LookupFunctionCodegenVensimWalker-755"><span class="linenos">755</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-756"><a href="#LookupFunctionCodegenVensimWalker-756"><span class="linenos">756</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;upper_index = middle;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-757"><a href="#LookupFunctionCodegenVensimWalker-757"><span class="linenos">757</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-758"><a href="#LookupFunctionCodegenVensimWalker-758"><span class="linenos">758</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-759"><a href="#LookupFunctionCodegenVensimWalker-759"><span class="linenos">759</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-760"><a href="#LookupFunctionCodegenVensimWalker-760"><span class="linenos">760</span></a>        <span class="c1"># check if lower needs to be raised</span>
</span><span id="LookupFunctionCodegenVensimWalker-761"><a href="#LookupFunctionCodegenVensimWalker-761"><span class="linenos">761</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;else if(x &gt; x_values[middle]){</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-762"><a href="#LookupFunctionCodegenVensimWalker-762"><span class="linenos">762</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-763"><a href="#LookupFunctionCodegenVensimWalker-763"><span class="linenos">763</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;lower_index = middle;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-764"><a href="#LookupFunctionCodegenVensimWalker-764"><span class="linenos">764</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-765"><a href="#LookupFunctionCodegenVensimWalker-765"><span class="linenos">765</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-766"><a href="#LookupFunctionCodegenVensimWalker-766"><span class="linenos">766</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-767"><a href="#LookupFunctionCodegenVensimWalker-767"><span class="linenos">767</span></a>        <span class="c1"># exit while loop</span>
</span><span id="LookupFunctionCodegenVensimWalker-768"><a href="#LookupFunctionCodegenVensimWalker-768"><span class="linenos">768</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker-769"><a href="#LookupFunctionCodegenVensimWalker-769"><span class="linenos">769</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-770"><a href="#LookupFunctionCodegenVensimWalker-770"><span class="linenos">770</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-771"><a href="#LookupFunctionCodegenVensimWalker-771"><span class="linenos">771</span></a>        <span class="c1"># Now, lower is the index of the beginning of the step, and upper is the index of the end of it</span>
</span><span id="LookupFunctionCodegenVensimWalker-772"><a href="#LookupFunctionCodegenVensimWalker-772"><span class="linenos">772</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real intercept = y_values[lower_index];</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-773"><a href="#LookupFunctionCodegenVensimWalker-773"><span class="linenos">773</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real slope = (y_values[upper_index] - y_values[lower_index]) / (x_values[upper_index] - x_values[lower_index]);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-774"><a href="#LookupFunctionCodegenVensimWalker-774"><span class="linenos">774</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-775"><a href="#LookupFunctionCodegenVensimWalker-775"><span class="linenos">775</span></a>        <span class="c1"># calculate the function value</span>
</span><span id="LookupFunctionCodegenVensimWalker-776"><a href="#LookupFunctionCodegenVensimWalker-776"><span class="linenos">776</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;return intercept + slope * (x - y_values[lower_index]);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker-777"><a href="#LookupFunctionCodegenVensimWalker-777"><span class="linenos">777</span></a>
</span><span id="LookupFunctionCodegenVensimWalker-778"><a href="#LookupFunctionCodegenVensimWalker-778"><span class="linenos">778</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Walks the Vensim AST for lookup structures, and generates a stan function for them.</p>
</div>


                            <div id="LookupFunctionCodegenVensimWalker.__init__" class="classattr">
                                <div class="attr function">
            
        <span class="name">LookupFunctionCodegenVensimWalker</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">v2s_code_handler</span><span class="p">:</span> <span class="n"><a href="v2s_model.html#Vensim2StanCodeHandler">stanify.builders.v2s_model.Vensim2StanCodeHandler</a></span>,</span><span class="param">	<span class="n">vensim_model_context</span><span class="p">:</span> <span class="n"><a href="vensim_model.html#VensimModelContext">stanify.builders.vensim_model.VensimModelContext</a></span>,</span><span class="param">	<span class="n">stan_model_context</span><span class="p">:</span> <span class="n"><a href="stan_model_context.html#StanModelContext">stanify.builders.stan_model_context.StanModelContext</a></span></span>)</span>

        
    </div>
    <a class="headerlink" href="#LookupFunctionCodegenVensimWalker.__init__"></a>
    
    

                            </div>
                            <div id="LookupFunctionCodegenVensimWalker.walk" class="classattr">
                                        <input id="LookupFunctionCodegenVensimWalker.walk-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">walk</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd</span><span class="o">.</span><span class="n">translators</span><span class="o">.</span><span class="n">structures</span><span class="o">.</span><span class="n">abstract_expressions</span><span class="o">.</span><span class="n">AbstractSyntax</span>,</span><span class="param">	<span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span>,</span><span class="param">	<span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">()</span>,</span><span class="param">	<span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="LookupFunctionCodegenVensimWalker.walk-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LookupFunctionCodegenVensimWalker.walk"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LookupFunctionCodegenVensimWalker.walk-626"><a href="#LookupFunctionCodegenVensimWalker.walk-626"><span class="linenos">626</span></a>    <span class="k">def</span> <span class="nf">walk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">component_ast</span><span class="p">:</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">AbstractSyntax</span><span class="p">,</span> <span class="n">node_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">subscripts</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">(),</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-627"><a href="#LookupFunctionCodegenVensimWalker.walk-627"><span class="linenos">627</span></a>             <span class="n">current_precedence</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-628"><a href="#LookupFunctionCodegenVensimWalker.walk-628"><span class="linenos">628</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-629"><a href="#LookupFunctionCodegenVensimWalker.walk-629"><span class="linenos">629</span></a><span class="sd">        Given a PySD Vensim component ast, generate and return code that corresponds to a single lookup variable.</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-630"><a href="#LookupFunctionCodegenVensimWalker.walk-630"><span class="linenos">630</span></a><span class="sd">        The code returned is a full stan function declaration.</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-631"><a href="#LookupFunctionCodegenVensimWalker.walk-631"><span class="linenos">631</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.walk-632"><a href="#LookupFunctionCodegenVensimWalker.walk-632"><span class="linenos">632</span></a><span class="sd">        Parameters</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-633"><a href="#LookupFunctionCodegenVensimWalker.walk-633"><span class="linenos">633</span></a><span class="sd">        ----------</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-634"><a href="#LookupFunctionCodegenVensimWalker.walk-634"><span class="linenos">634</span></a><span class="sd">        component_ast : LookupsStructure</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-635"><a href="#LookupFunctionCodegenVensimWalker.walk-635"><span class="linenos">635</span></a><span class="sd">            A `LookupsStructure` object. The arguments are exactly the same as `BaseVensimWalker.walk()`</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-636"><a href="#LookupFunctionCodegenVensimWalker.walk-636"><span class="linenos">636</span></a><span class="sd">        node_name : str</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-637"><a href="#LookupFunctionCodegenVensimWalker.walk-637"><span class="linenos">637</span></a><span class="sd">            Name of the Vensim element(variable name)</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-638"><a href="#LookupFunctionCodegenVensimWalker.walk-638"><span class="linenos">638</span></a><span class="sd">        subscripts : tuple[str] or dict[str, str]</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-639"><a href="#LookupFunctionCodegenVensimWalker.walk-639"><span class="linenos">639</span></a><span class="sd">            Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-640"><a href="#LookupFunctionCodegenVensimWalker.walk-640"><span class="linenos">640</span></a><span class="sd">            be `component.subscripts`.</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-641"><a href="#LookupFunctionCodegenVensimWalker.walk-641"><span class="linenos">641</span></a><span class="sd">            However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-642"><a href="#LookupFunctionCodegenVensimWalker.walk-642"><span class="linenos">642</span></a><span class="sd">            in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-643"><a href="#LookupFunctionCodegenVensimWalker.walk-643"><span class="linenos">643</span></a><span class="sd">        current_precedence : int</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-644"><a href="#LookupFunctionCodegenVensimWalker.walk-644"><span class="linenos">644</span></a><span class="sd">            Current precedence level of the AST. Only relevant for ArithmeticStructure, and hence not used within</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-645"><a href="#LookupFunctionCodegenVensimWalker.walk-645"><span class="linenos">645</span></a><span class="sd">            this walker.</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-646"><a href="#LookupFunctionCodegenVensimWalker.walk-646"><span class="linenos">646</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.walk-647"><a href="#LookupFunctionCodegenVensimWalker.walk-647"><span class="linenos">647</span></a><span class="sd">        Returns</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-648"><a href="#LookupFunctionCodegenVensimWalker.walk-648"><span class="linenos">648</span></a><span class="sd">        -------</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-649"><a href="#LookupFunctionCodegenVensimWalker.walk-649"><span class="linenos">649</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.walk-650"><a href="#LookupFunctionCodegenVensimWalker.walk-650"><span class="linenos">650</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-651"><a href="#LookupFunctionCodegenVensimWalker.walk-651"><span class="linenos">651</span></a>        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">component_ast</span><span class="p">,</span> <span class="n">pysd_ast</span><span class="o">.</span><span class="n">LookupsStructure</span><span class="p">):</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-652"><a href="#LookupFunctionCodegenVensimWalker.walk-652"><span class="linenos">652</span></a>            <span class="c1"># Two strategies for implementing the lookup efficiently: If there are 4 or less x values, then we</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-653"><a href="#LookupFunctionCodegenVensimWalker.walk-653"><span class="linenos">653</span></a>            <span class="c1"># just write 4(or less) comparison statements to calculate the correct slope and intercept.</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-654"><a href="#LookupFunctionCodegenVensimWalker.walk-654"><span class="linenos">654</span></a>            <span class="c1"># But if there are more than 4 values, we use a binary search.</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-655"><a href="#LookupFunctionCodegenVensimWalker.walk-655"><span class="linenos">655</span></a>            <span class="n">function_name</span> <span class="o">=</span> <span class="n">node_name</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-656"><a href="#LookupFunctionCodegenVensimWalker.walk-656"><span class="linenos">656</span></a>            <span class="n">n_domains</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-657"><a href="#LookupFunctionCodegenVensimWalker.walk-657"><span class="linenos">657</span></a>            <span class="n">code</span> <span class="o">=</span> <span class="n">IndentedString</span><span class="p">()</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-658"><a href="#LookupFunctionCodegenVensimWalker.walk-658"><span class="linenos">658</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;real </span><span class="si">{</span><span class="n">function_name</span><span class="si">}</span><span class="s2">(real x)</span><span class="se">{{\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-659"><a href="#LookupFunctionCodegenVensimWalker.walk-659"><span class="linenos">659</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.walk-660"><a href="#LookupFunctionCodegenVensimWalker.walk-660"><span class="linenos">660</span></a>            <span class="c1"># Enter function body</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-661"><a href="#LookupFunctionCodegenVensimWalker.walk-661"><span class="linenos">661</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-662"><a href="#LookupFunctionCodegenVensimWalker.walk-662"><span class="linenos">662</span></a>            <span class="k">if</span> <span class="n">n_domains</span> <span class="o">&lt;=</span> <span class="mi">4</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-663"><a href="#LookupFunctionCodegenVensimWalker.walk-663"><span class="linenos">663</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">codgen_comparison_functionbody</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-664"><a href="#LookupFunctionCodegenVensimWalker.walk-664"><span class="linenos">664</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-665"><a href="#LookupFunctionCodegenVensimWalker.walk-665"><span class="linenos">665</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">codegen_binarysearch_functionbody</span><span class="p">(</span><span class="n">component_ast</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">component_ast</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-666"><a href="#LookupFunctionCodegenVensimWalker.walk-666"><span class="linenos">666</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.walk-667"><a href="#LookupFunctionCodegenVensimWalker.walk-667"><span class="linenos">667</span></a>            <span class="c1"># exit function body</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-668"><a href="#LookupFunctionCodegenVensimWalker.walk-668"><span class="linenos">668</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-669"><a href="#LookupFunctionCodegenVensimWalker.walk-669"><span class="linenos">669</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-670"><a href="#LookupFunctionCodegenVensimWalker.walk-670"><span class="linenos">670</span></a>            <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-671"><a href="#LookupFunctionCodegenVensimWalker.walk-671"><span class="linenos">671</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker.walk-672"><a href="#LookupFunctionCodegenVensimWalker.walk-672"><span class="linenos">672</span></a>            <span class="k">return</span> <span class="s2">&quot;&quot;</span>
</span></pre></div>


            <div class="docstring"><p>Given a PySD Vensim component ast, generate and return code that corresponds to a single lookup variable.
The code returned is a full stan function declaration.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>component_ast</strong> (LookupsStructure):
A <code>LookupsStructure</code> object. The arguments are exactly the same as <code><a href="#BaseVensimWalker.walk">BaseVensimWalker.walk()</a></code></li>
<li><strong>node_name</strong> (str):
Name of the Vensim element(variable name)</li>
<li><strong>subscripts</strong> (tuple[str] or dict[str, str]):
Normally a Tuple indicating subscripts the AST possesses, if any. By the above element hierarchy, should
be <code>component.subscripts</code>.
However, for codegen walkers, if a dictionary is given with the format dict[original_subscript, alias],
in any places the subscript is to be used(i.e., for indexing), instead the alis will  be used.</li>
<li><strong>current_precedence</strong> (int):
Current precedence level of the AST. Only relevant for ArithmeticStructure, and hence not used within
this walker.</li>
<li><strong>Returns</strong></li>
<li><strong>-------</strong></li>
</ul>
</div>


                            </div>
                            <div id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody" class="classattr">
                                        <input id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">codgen_comparison_functionbody</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">y_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-674"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-674"><span class="linenos">674</span></a>    <span class="nd">@staticmethod</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-675"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-675"><span class="linenos">675</span></a>    <span class="k">def</span> <span class="nf">codgen_comparison_functionbody</span><span class="p">(</span><span class="n">x_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">y_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-676"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-676"><span class="linenos">676</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-677"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-677"><span class="linenos">677</span></a><span class="sd">        Generate function body for a lookup stepwise linear function with chained if statements.</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-678"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-678"><span class="linenos">678</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-679"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-679"><span class="linenos">679</span></a><span class="sd">        Parameters</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-680"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-680"><span class="linenos">680</span></a><span class="sd">        ----------</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-681"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-681"><span class="linenos">681</span></a><span class="sd">        x_values : tuple[float]</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-682"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-682"><span class="linenos">682</span></a><span class="sd">            Values of the steps for the domain of the function.</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-683"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-683"><span class="linenos">683</span></a><span class="sd">        y_values : tuple[float]</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-684"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-684"><span class="linenos">684</span></a><span class="sd">            Values of the steps for the range of the function</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-685"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-685"><span class="linenos">685</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-686"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-686"><span class="linenos">686</span></a><span class="sd">        Returns</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-687"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-687"><span class="linenos">687</span></a><span class="sd">        -------</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-688"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-688"><span class="linenos">688</span></a><span class="sd">        String of the generated code</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-689"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-689"><span class="linenos">689</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-690"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-690"><span class="linenos">690</span></a>        <span class="n">code</span> <span class="o">=</span> <span class="n">IndentedString</span><span class="p">()</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-691"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-691"><span class="linenos">691</span></a>        <span class="n">n_domains</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-692"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-692"><span class="linenos">692</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real slope;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-693"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-693"><span class="linenos">693</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real intercept;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-694"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-694"><span class="linenos">694</span></a>        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_domains</span><span class="p">):</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-695"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-695"><span class="linenos">695</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-696"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-696"><span class="linenos">696</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;if(x &lt;= </span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}</span><span class="s2">) </span><span class="se">{{\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-697"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-697"><span class="linenos">697</span></a>                <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-698"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-698"><span class="linenos">698</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;return </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-699"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-699"><span class="linenos">699</span></a>                <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-700"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-700"><span class="linenos">700</span></a>                <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-701"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-701"><span class="linenos">701</span></a>                <span class="k">continue</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-702"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-702"><span class="linenos">702</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-703"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-703"><span class="linenos">703</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;else if(x &lt;= </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s2">) </span><span class="se">{{\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-704"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-704"><span class="linenos">704</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-705"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-705"><span class="linenos">705</span></a>            <span class="c1"># enter conditional body</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-706"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-706"><span class="linenos">706</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;intercept = </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-707"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-707"><span class="linenos">707</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;slope = (</span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)/(</span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-708"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-708"><span class="linenos">708</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;return intercept + slope * (x - </span><span class="si">{</span><span class="n">x_values</span><span class="p">[</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-709"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-709"><span class="linenos">709</span></a>            <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-710"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-710"><span class="linenos">710</span></a>            <span class="c1"># exit conditional body</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-711"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-711"><span class="linenos">711</span></a>            <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-712"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-712"><span class="linenos">712</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-713"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-713"><span class="linenos">713</span></a>        <span class="c1"># Handle out-of-bounds input</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-714"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-714"><span class="linenos">714</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;return </span><span class="si">{</span><span class="n">y_values</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-715"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-715"><span class="linenos">715</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-716"><a href="#LookupFunctionCodegenVensimWalker.codgen_comparison_functionbody-716"><span class="linenos">716</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate function body for a lookup stepwise linear function with chained if statements.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>x_values</strong> (tuple[float]):
Values of the steps for the domain of the function.</li>
<li><strong>y_values</strong> (tuple[float]):
Values of the steps for the range of the function</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>String of the generated code</strong></li>
</ul>
</div>


                            </div>
                            <div id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody" class="classattr">
                                        <input id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
                    <div class="decorator">@staticmethod</div>

        <span class="def">def</span>
        <span class="name">codegen_binarysearch_functionbody</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">x_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span>, </span><span class="param"><span class="n">y_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span></span><span class="return-annotation">) -> <span class="nb">str</span>:</span></span>

                <label class="view-source-button" for="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-718"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-718"><span class="linenos">718</span></a>    <span class="nd">@staticmethod</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-719"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-719"><span class="linenos">719</span></a>    <span class="k">def</span> <span class="nf">codegen_binarysearch_functionbody</span><span class="p">(</span><span class="n">x_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">],</span> <span class="n">y_values</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-720"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-720"><span class="linenos">720</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-721"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-721"><span class="linenos">721</span></a><span class="sd">        Generate function body for a lookup stepwise linear function employing a binary search.</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-722"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-722"><span class="linenos">722</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-723"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-723"><span class="linenos">723</span></a><span class="sd">        Parameters</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-724"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-724"><span class="linenos">724</span></a><span class="sd">        ----------</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-725"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-725"><span class="linenos">725</span></a><span class="sd">        x_values : tuple[float]</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-726"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-726"><span class="linenos">726</span></a><span class="sd">            Values of the steps for the domain of the function.</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-727"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-727"><span class="linenos">727</span></a><span class="sd">        y_values : tuple[float]</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-728"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-728"><span class="linenos">728</span></a><span class="sd">            Values of the steps for the range of the function</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-729"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-729"><span class="linenos">729</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-730"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-730"><span class="linenos">730</span></a><span class="sd">        Returns</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-731"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-731"><span class="linenos">731</span></a><span class="sd">        -------</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-732"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-732"><span class="linenos">732</span></a><span class="sd">        String of the generated code</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-733"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-733"><span class="linenos">733</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-734"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-734"><span class="linenos">734</span></a>        <span class="n">code</span> <span class="o">=</span> <span class="n">IndentedString</span><span class="p">()</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-735"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-735"><span class="linenos">735</span></a>        <span class="n">n_domains</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x_values</span><span class="p">)</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-736"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-736"><span class="linenos">736</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;array[</span><span class="si">{</span><span class="n">n_domains</span><span class="si">}</span><span class="s2">] real x_values = </span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">x_values</span><span class="p">])</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-737"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-737"><span class="linenos">737</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;array[</span><span class="si">{</span><span class="n">n_domains</span><span class="si">}</span><span class="s2">] real y_values = </span><span class="se">{{</span><span class="s2"> </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">str</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">y_values</span><span class="p">])</span><span class="si">}</span><span class="s2"> </span><span class="se">}}</span><span class="s2">;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-738"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-738"><span class="linenos">738</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-739"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-739"><span class="linenos">739</span></a>        <span class="c1"># define the search bound values. Stan integer division floors to the integer result</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-740"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-740"><span class="linenos">740</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;int lower_index = 1, upper_index = </span><span class="si">{</span><span class="n">n_domains</span><span class="si">}</span><span class="s2">, middle = (lower_index + upper_index) %/% 2;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-741"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-741"><span class="linenos">741</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-742"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-742"><span class="linenos">742</span></a>        <span class="c1"># Check that we&#39;re within bounds first</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-743"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-743"><span class="linenos">743</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;if (x &gt;= x_values[upper_index]) { return y_values[upper_index]; }</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-744"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-744"><span class="linenos">744</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;if (x &lt;= x_values[lower_index]) { return y_values[lower_index]; }</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-745"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-745"><span class="linenos">745</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-746"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-746"><span class="linenos">746</span></a>        <span class="c1"># create the while loop</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-747"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-747"><span class="linenos">747</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;while(upper_index - lower_index &gt; 1){</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-748"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-748"><span class="linenos">748</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-749"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-749"><span class="linenos">749</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-750"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-750"><span class="linenos">750</span></a>        <span class="c1"># calculate midpoint (stan integer division floors the result to integer)</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-751"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-751"><span class="linenos">751</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;middle = (lower_index + upper_index) %/% 2;</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-752"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-752"><span class="linenos">752</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-753"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-753"><span class="linenos">753</span></a>        <span class="c1"># check if upper needs to be lowered</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-754"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-754"><span class="linenos">754</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;if (x &lt;= x_values[middle]){</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-755"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-755"><span class="linenos">755</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-756"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-756"><span class="linenos">756</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;upper_index = middle;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-757"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-757"><span class="linenos">757</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-758"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-758"><span class="linenos">758</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-759"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-759"><span class="linenos">759</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-760"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-760"><span class="linenos">760</span></a>        <span class="c1"># check if lower needs to be raised</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-761"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-761"><span class="linenos">761</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;else if(x &gt; x_values[middle]){</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-762"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-762"><span class="linenos">762</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-763"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-763"><span class="linenos">763</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;lower_index = middle;</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-764"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-764"><span class="linenos">764</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-765"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-765"><span class="linenos">765</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-766"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-766"><span class="linenos">766</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-767"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-767"><span class="linenos">767</span></a>        <span class="c1"># exit while loop</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-768"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-768"><span class="linenos">768</span></a>        <span class="n">code</span><span class="o">.</span><span class="n">indent_level</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-769"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-769"><span class="linenos">769</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;}</span><span class="se">\n\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-770"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-770"><span class="linenos">770</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-771"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-771"><span class="linenos">771</span></a>        <span class="c1"># Now, lower is the index of the beginning of the step, and upper is the index of the end of it</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-772"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-772"><span class="linenos">772</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real intercept = y_values[lower_index];</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-773"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-773"><span class="linenos">773</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;real slope = (y_values[upper_index] - y_values[lower_index]) / (x_values[upper_index] - x_values[lower_index]);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-774"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-774"><span class="linenos">774</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-775"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-775"><span class="linenos">775</span></a>        <span class="c1"># calculate the function value</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-776"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-776"><span class="linenos">776</span></a>        <span class="n">code</span> <span class="o">+=</span> <span class="s2">&quot;return intercept + slope * (x - y_values[lower_index]);</span><span class="se">\n</span><span class="s2">&quot;</span>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-777"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-777"><span class="linenos">777</span></a>
</span><span id="LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-778"><a href="#LookupFunctionCodegenVensimWalker.codegen_binarysearch_functionbody-778"><span class="linenos">778</span></a>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Generate function body for a lookup stepwise linear function employing a binary search.</p>

<h6 id="parameters">Parameters</h6>

<ul>
<li><strong>x_values</strong> (tuple[float]):
Values of the steps for the domain of the function.</li>
<li><strong>y_values</strong> (tuple[float]):
Values of the steps for the range of the function</li>
</ul>

<h6 id="returns">Returns</h6>

<ul>
<li><strong>String of the generated code</strong></li>
</ul>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>